[
  {
    "problem_id": "2026-01-05_comm_sql_001_set0",
    "difficulty": "easy",
    "topic": "revenue",
    "requester": "경영진",
    "question": "안녕하세요. 2025년 11월 한 달 동안 발생한 총 GMV(Gross Merchandise Value)와 평균 주문 금액(AOV)을 알고 싶습니다. 결과는 기간별 일별로 확인할 수 있도록 'order_date'와 'daily_gmv', 'daily_aov' 컬럼으로 제공 부탁드립니다.",
    "context": "월별 매출 현황을 파악하고, 전반적인 비즈니스 성과를 점검하기 위해 11월 한 달간의 핵심 매출 지표를 분석하고자 합니다.",
    "submission_requirements": "결과는 'order_date' 기준 오름차순으로 정렬해주세요. 'daily_gmv'는 정수, 'daily_aov'는 소수점 둘째 자리까지 반올림하여 표시해주세요.",
    "answer_sql": "SELECT\n    DATE(order_time) AS order_date,\n    SUM(amount) AS daily_gmv,\n    AVG(amount) AS daily_aov\nFROM\n    pa_orders\nWHERE\n    order_time >= '2025-11-01 00:00:00'\n    AND order_time < '2025-12-01 00:00:00'\nGROUP BY\n    DATE(order_time)\nORDER BY\n    order_date ASC;",
    "expected_description": "각 날짜별 총 매출액(GMV)과 해당 날짜의 평균 주문 금액(AOV)을 보여줍니다.",
    "expected_columns": [
      "order_date",
      "daily_gmv",
      "daily_aov"
    ],
    "sort_keys": [
      "order_date"
    ],
    "hint": "pa_orders 테이블에서 order_time 컬럼을 활용하여 날짜별로 그룹화하고, amount 컬럼의 합계와 평균을 계산합니다.",
    "date": "2026-01-05",
    "set_index": 0,
    "xp_value": 3,
    "expected_result": [
      {
        "order_date": "2025-11-02",
        "daily_gmv": 23895,
        "daily_aov": 11947.5
      },
      {
        "order_date": "2025-11-06",
        "daily_gmv": 29312,
        "daily_aov": 29312.0
      },
      {
        "order_date": "2025-11-07",
        "daily_gmv": 4801,
        "daily_aov": 4801.0
      },
      {
        "order_date": "2025-11-08",
        "daily_gmv": 23180,
        "daily_aov": 23180.0
      },
      {
        "order_date": "2025-11-09",
        "daily_gmv": 46953,
        "daily_aov": 46953.0
      },
      {
        "order_date": "2025-11-10",
        "daily_gmv": 36151,
        "daily_aov": 9037.75
      },
      {
        "order_date": "2025-11-11",
        "daily_gmv": 131380,
        "daily_aov": 32845.0
      },
      {
        "order_date": "2025-11-12",
        "daily_gmv": 38796,
        "daily_aov": 19398.0
      },
      {
        "order_date": "2025-11-14",
        "daily_gmv": 98388,
        "daily_aov": 32796.0
      },
      {
        "order_date": "2025-11-15",
        "daily_gmv": 97416,
        "daily_aov": 24354.0
      },
      {
        "order_date": "2025-11-16",
        "daily_gmv": 112573,
        "daily_aov": 28143.25
      },
      {
        "order_date": "2025-11-17",
        "daily_gmv": 120816,
        "daily_aov": 30204.0
      },
      {
        "order_date": "2025-11-18",
        "daily_gmv": 118209,
        "daily_aov": 29552.25
      },
      {
        "order_date": "2025-11-19",
        "daily_gmv": 123498,
        "daily_aov": 17642.571428571428
      },
      {
        "order_date": "2025-11-20",
        "daily_gmv": 111377,
        "daily_aov": 18562.833333333332
      },
      {
        "order_date": "2025-11-21",
        "daily_gmv": 139618,
        "daily_aov": 34904.5
      },
      {
        "order_date": "2025-11-22",
        "daily_gmv": 29600,
        "daily_aov": 29600.0
      },
      {
        "order_date": "2025-11-23",
        "daily_gmv": 36652,
        "daily_aov": 36652.0
      },
      {
        "order_date": "2025-11-24",
        "daily_gmv": 24801,
        "daily_aov": 24801.0
      },
      {
        "order_date": "2025-11-25",
        "daily_gmv": 84431,
        "daily_aov": 16886.2
      },
      {
        "order_date": "2025-11-26",
        "daily_gmv": 70637,
        "daily_aov": 17659.25
      },
      {
        "order_date": "2025-11-27",
        "daily_gmv": 101513,
        "daily_aov": 25378.25
      },
      {
        "order_date": "2025-11-28",
        "daily_gmv": 165606,
        "daily_aov": 27601.0
      },
      {
        "order_date": "2025-11-29",
        "daily_gmv": 122930,
        "daily_aov": 20488.333333333332
      },
      {
        "order_date": "2025-11-30",
        "daily_gmv": 70829,
        "daily_aov": 23609.666666666668
      }
    ],
    "expected_row_count": 25
  },
  {
    "problem_id": "2026-01-05_comm_sql_002_set0",
    "difficulty": "easy",
    "topic": "activation",
    "requester": "PM팀",
    "question": "2025년 12월에 처음으로 구매(purchase)를 완료한 신규 고객의 수를 파악하고 싶습니다. 'user_id'와 'first_purchase_date'를 포함한 결과를 제공해주세요. 결과는 'first_purchase_date' 기준 오름차순으로 정렬해주세요.",
    "context": "신규 고객 확보 및 첫 구매 전환 현황을 파악하여 마케팅 캠페인 효과를 측정하고, 활성화 전략 수립에 필요한 데이터를 확보하고자 합니다.",
    "submission_requirements": "결과는 'first_purchase_date' 기준 오름차순으로 정렬해주세요. 'user_id'와 'first_purchase_date' 컬럼만 포함하여 제공해주세요.",
    "answer_sql": "WITH UserFirstPurchase AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_purchase_date,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY order_time) as rn\n    FROM\n        pa_orders\n    WHERE\n        order_time >= '2025-12-01 00:00:00'\n        AND order_time < '2026-01-01 00:00:00'\n    GROUP BY\n        user_id,\n        order_time\n)\nSELECT\n    user_id,\n    first_purchase_date\nFROM\n    UserFirstPurchase\nWHERE\n    rn = 1\nORDER BY\n    first_purchase_date ASC;",
    "expected_description": "2025년 12월에 처음으로 구매를 완료한 각 사용자(user_id)의 최초 구매일(first_purchase_date)을 보여줍니다.",
    "expected_columns": [
      "user_id",
      "first_purchase_date"
    ],
    "sort_keys": [
      "first_purchase_date"
    ],
    "hint": "pa_orders 테이블에서 각 user_id별 최초 order_time을 찾기 위해 MIN 함수와 ROW_NUMBER 윈도우 함수를 활용합니다. 2025년 12월 날짜 범위로 필터링합니다.",
    "date": "2026-01-05",
    "set_index": 0,
    "xp_value": 3,
    "expected_result": [
      {
        "user_id": "f273008e-71d0-4b01-baa5-20d61e81c866",
        "first_purchase_date": "2025-12-01T08:18:14.015642"
      },
      {
        "user_id": "e331cab1-fc74-4618-a924-5c3ad27bece4",
        "first_purchase_date": "2025-12-01T09:46:10.015642"
      },
      {
        "user_id": "a7028701-50fa-4bea-89fe-89149981f593",
        "first_purchase_date": "2025-12-01T12:03:39.015642"
      },
      {
        "user_id": "c3d184f6-7465-480e-bcd7-e0b49232d9f5",
        "first_purchase_date": "2025-12-01T13:37:25.015642"
      },
      {
        "user_id": "e9cc69c2-a06e-416d-b6af-d7c2f021be74",
        "first_purchase_date": "2025-12-01T16:26:16.015642"
      },
      {
        "user_id": "28505c33-baf4-420b-881e-db123801e95a",
        "first_purchase_date": "2025-12-02T10:11:08.015642"
      },
      {
        "user_id": "a80b28b9-0db1-4ce9-965d-3f6854b959c5",
        "first_purchase_date": "2025-12-02T14:39:30.015642"
      },
      {
        "user_id": "6a949bc9-f1b2-40ee-8763-62f9ddc2b316",
        "first_purchase_date": "2025-12-02T17:10:22.015642"
      },
      {
        "user_id": "5225b00e-da92-4cbf-8593-b81531d55a15",
        "first_purchase_date": "2025-12-02T22:15:25.015642"
      },
      {
        "user_id": "5315aa64-90c4-41ec-a011-d835fc8e1ee2",
        "first_purchase_date": "2025-12-03T00:02:59.015642"
      },
      {
        "user_id": "0196307e-2d34-4691-a69b-462c06740f42",
        "first_purchase_date": "2025-12-03T17:39:06.015642"
      },
      {
        "user_id": "640bac6a-c406-406d-9d41-e89766a9f573",
        "first_purchase_date": "2025-12-03T21:27:06.015642"
      },
      {
        "user_id": "11b1977f-006b-4fb3-a0d8-a54ab67b69c4",
        "first_purchase_date": "2025-12-03T22:49:09.015642"
      },
      {
        "user_id": "8369be9a-a172-4f77-ab4d-2d5c054330bb",
        "first_purchase_date": "2025-12-04T01:56:25.015642"
      },
      {
        "user_id": "d6333714-b5b5-4cae-8a22-1f5fdab5624b",
        "first_purchase_date": "2025-12-04T06:07:28.015642"
      },
      {
        "user_id": "f604aabe-916c-45da-8637-bcf248c06d1b",
        "first_purchase_date": "2025-12-04T08:04:01.015642"
      },
      {
        "user_id": "44cbfa9f-7d28-450c-8bb2-78d017294a7b",
        "first_purchase_date": "2025-12-04T09:20:01.015642"
      },
      {
        "user_id": "068d195a-d9ef-4a30-9a89-ea254a04c4e8",
        "first_purchase_date": "2025-12-04T16:34:31.015642"
      },
      {
        "user_id": "14bf5bda-09f2-46ad-bb97-65584976c637",
        "first_purchase_date": "2025-12-04T17:51:40.015642"
      },
      {
        "user_id": "bfc6b130-78c8-4101-9adf-70a16334baef",
        "first_purchase_date": "2025-12-04T17:53:43.015642"
      },
      {
        "user_id": "9fec4351-5e16-4019-a183-5beb39bd3be6",
        "first_purchase_date": "2025-12-05T02:58:05.015642"
      },
      {
        "user_id": "30f3ac2d-6b35-4595-8e1d-f1528089be0d",
        "first_purchase_date": "2025-12-05T09:28:26.015642"
      },
      {
        "user_id": "85533456-18aa-4356-bdaf-dd137022133f",
        "first_purchase_date": "2025-12-05T10:13:06.015642"
      },
      {
        "user_id": "8678bad3-6aa8-418b-9fbc-796edc336c30",
        "first_purchase_date": "2025-12-05T19:46:38.015642"
      },
      {
        "user_id": "5d8e52b2-0d91-4502-9356-c6c65cb00c87",
        "first_purchase_date": "2025-12-06T03:14:52.015642"
      },
      {
        "user_id": "e5c604cb-8429-4753-8dd2-84cf9dae4096",
        "first_purchase_date": "2025-12-06T03:57:29.015642"
      },
      {
        "user_id": "98679f2b-edf1-4062-81ca-84159a776ce8",
        "first_purchase_date": "2025-12-06T13:22:00.015642"
      },
      {
        "user_id": "438eee6e-5c35-4fd7-a892-9a3ca88ba2c2",
        "first_purchase_date": "2025-12-07T06:49:00.015642"
      },
      {
        "user_id": "7b623c0c-3eae-4791-b410-db11d5b21076",
        "first_purchase_date": "2025-12-07T15:16:49.015642"
      },
      {
        "user_id": "2e815159-7c54-4db3-9dbe-eb5d66a0db22",
        "first_purchase_date": "2025-12-07T23:42:05.015642"
      },
      {
        "user_id": "6f54cdaf-545d-4702-847f-91e5c2aef3a9",
        "first_purchase_date": "2025-12-08T12:33:44.015642"
      },
      {
        "user_id": "670fcb2c-46cf-49fd-a9d6-86f6684d7d92",
        "first_purchase_date": "2025-12-08T15:03:01.015642"
      },
      {
        "user_id": "10806d63-ca15-44f7-9f8c-3804b86e78d4",
        "first_purchase_date": "2025-12-08T22:56:29.015642"
      },
      {
        "user_id": "27a886c3-f68c-4db4-8712-eb29bfb89943",
        "first_purchase_date": "2025-12-09T07:02:28.015642"
      },
      {
        "user_id": "e0a30cd9-33fa-49bd-b7e4-23841ffc43ff",
        "first_purchase_date": "2025-12-09T14:56:58.015642"
      },
      {
        "user_id": "2ca7466d-df95-4228-bd69-fde423145f79",
        "first_purchase_date": "2025-12-10T00:15:36.015642"
      },
      {
        "user_id": "a2940375-0342-485e-9c52-c3aad0e8ec1b",
        "first_purchase_date": "2025-12-10T01:30:39.015642"
      },
      {
        "user_id": "62c642a2-3718-4ea1-b531-1302d0e3ba77",
        "first_purchase_date": "2025-12-10T02:07:23.015642"
      },
      {
        "user_id": "97d888dc-4494-415b-97bb-6513420caf2f",
        "first_purchase_date": "2025-12-11T04:31:53.015642"
      },
      {
        "user_id": "3dc9e904-4463-4c3c-8aa0-d5738acc3654",
        "first_purchase_date": "2025-12-11T16:51:52.015642"
      },
      {
        "user_id": "7d30b2b1-4eda-4ca6-9906-64d00ee04517",
        "first_purchase_date": "2025-12-11T19:47:19.015642"
      },
      {
        "user_id": "a24dc7ee-dfc6-4cd0-80a8-771f02d65b40",
        "first_purchase_date": "2025-12-12T00:31:50.015642"
      },
      {
        "user_id": "8878b67d-553f-4bfe-95c6-3d45cf4775da",
        "first_purchase_date": "2025-12-12T00:53:49.015642"
      },
      {
        "user_id": "d76a7058-2ed4-4fef-bb33-f38b63f3bfb8",
        "first_purchase_date": "2025-12-12T07:25:23.015642"
      },
      {
        "user_id": "832e7ed0-d324-4661-9649-76d41b8db9db",
        "first_purchase_date": "2025-12-12T09:34:17.015642"
      },
      {
        "user_id": "453052bc-a8f5-41d0-924c-918b580fb751",
        "first_purchase_date": "2025-12-12T14:42:43.015642"
      },
      {
        "user_id": "54707e14-a18a-472f-a7a1-94496d91587b",
        "first_purchase_date": "2025-12-12T19:29:54.015642"
      },
      {
        "user_id": "0f8b80d2-5584-49f1-9748-0bea80d49f0d",
        "first_purchase_date": "2025-12-13T00:27:04.015642"
      },
      {
        "user_id": "be28e712-f779-46bc-8b9e-92dc421c0edb",
        "first_purchase_date": "2025-12-13T01:08:10.015642"
      },
      {
        "user_id": "96f2f689-cd15-4554-bffb-6051af71f22a",
        "first_purchase_date": "2025-12-13T03:18:14.015642"
      },
      {
        "user_id": "d662d9fa-d8d2-4a45-b104-1b5b42716620",
        "first_purchase_date": "2025-12-13T04:13:37.015642"
      },
      {
        "user_id": "96505d67-ad7e-4536-a3e4-5e9055accd38",
        "first_purchase_date": "2025-12-13T21:57:49.015642"
      },
      {
        "user_id": "f752219b-82e6-45f4-9619-18f48e08c853",
        "first_purchase_date": "2025-12-14T00:01:10.015642"
      },
      {
        "user_id": "e4548879-884c-4a2b-913d-41d78f81d908",
        "first_purchase_date": "2025-12-14T13:14:12.015642"
      },
      {
        "user_id": "dfe64c11-6373-4dab-a1f8-d477ccc247f3",
        "first_purchase_date": "2025-12-14T15:39:14.015642"
      },
      {
        "user_id": "79f93a6a-09ff-43c8-a1d9-25b706f97621",
        "first_purchase_date": "2025-12-15T01:55:27.015642"
      },
      {
        "user_id": "37dd91eb-5e39-4868-b8dd-3e4424791320",
        "first_purchase_date": "2025-12-15T03:21:30.015642"
      },
      {
        "user_id": "9bbcca60-478d-4242-bca7-b9959a80d0ef",
        "first_purchase_date": "2025-12-15T11:16:18.015642"
      },
      {
        "user_id": "1f58f3b8-2f52-411a-bed6-7d6e9baf6dfd",
        "first_purchase_date": "2025-12-15T13:08:11.015642"
      },
      {
        "user_id": "7ad741a6-ab75-4a05-8757-5dac3265fe7e",
        "first_purchase_date": "2025-12-15T18:59:40.015642"
      },
      {
        "user_id": "354ac3f6-b00e-4408-a51f-016c178716fe",
        "first_purchase_date": "2025-12-15T20:04:11.015642"
      },
      {
        "user_id": "8286bb5f-4c14-4dc4-aa88-3b2079d36dce",
        "first_purchase_date": "2025-12-16T02:18:21.015642"
      },
      {
        "user_id": "5f898978-8f18-419b-88dd-363f13d287da",
        "first_purchase_date": "2025-12-16T05:35:56.015642"
      },
      {
        "user_id": "ff88d5ed-6cd4-4382-8787-de80f59b1d1c",
        "first_purchase_date": "2025-12-16T06:01:34.015642"
      },
      {
        "user_id": "7cba3d50-c1ee-4bd8-8e83-07bb6199126f",
        "first_purchase_date": "2025-12-16T10:19:35.015642"
      },
      {
        "user_id": "b0a4a0ef-c259-4c06-b56b-fb4eae3ede35",
        "first_purchase_date": "2025-12-16T10:37:27.015642"
      },
      {
        "user_id": "90b2ad9a-4ee3-45ed-988d-3de3f4a56fd4",
        "first_purchase_date": "2025-12-17T01:49:08.015642"
      },
      {
        "user_id": "ed6597e9-fea4-42b1-8fd6-9ec2ceb8308c",
        "first_purchase_date": "2025-12-17T03:00:30.015642"
      },
      {
        "user_id": "1effdfeb-514f-4ed6-bfd8-d6374c6f7bc3",
        "first_purchase_date": "2025-12-17T13:26:43.015642"
      },
      {
        "user_id": "7519e3b7-d9e9-4964-a700-888aa35180d3",
        "first_purchase_date": "2025-12-17T17:17:48.015642"
      },
      {
        "user_id": "9b6da4a4-adfc-4abd-8c7f-5814e8f0ef33",
        "first_purchase_date": "2025-12-17T18:31:37.015642"
      },
      {
        "user_id": "f407e8ef-1bf8-4e04-b270-0ad21f9599d6",
        "first_purchase_date": "2025-12-17T20:16:41.015642"
      },
      {
        "user_id": "52977e1c-525e-4640-851d-ec91e8446ba4",
        "first_purchase_date": "2025-12-17T22:06:10.015642"
      },
      {
        "user_id": "cecc2a22-fc50-4601-9b1c-167f022403d3",
        "first_purchase_date": "2025-12-18T06:34:03.015642"
      },
      {
        "user_id": "3a0b1c7d-bd5e-4ad2-849c-ea0b48349072",
        "first_purchase_date": "2025-12-18T09:00:20.015642"
      },
      {
        "user_id": "b121699a-8ea3-451d-b635-9c2a5418bf0a",
        "first_purchase_date": "2025-12-18T10:05:04.015642"
      },
      {
        "user_id": "f098b609-21de-4144-ad92-d1398a996be9",
        "first_purchase_date": "2025-12-18T11:50:38.015642"
      },
      {
        "user_id": "974c8620-aca5-44c6-88d1-d1c0be31980b",
        "first_purchase_date": "2025-12-19T05:21:37.015642"
      },
      {
        "user_id": "cb9ee949-0bab-4540-aaa1-8ebb3c7c70cb",
        "first_purchase_date": "2025-12-19T14:33:07.015642"
      },
      {
        "user_id": "d58afdc8-6992-4855-94a8-67ad5356bf90",
        "first_purchase_date": "2025-12-19T15:12:26.015642"
      },
      {
        "user_id": "d0eb3b21-a208-41a3-b5ce-6561358f7326",
        "first_purchase_date": "2025-12-19T23:00:18.015642"
      },
      {
        "user_id": "d2ac36af-0fb1-4b46-9a90-1a3381d98f14",
        "first_purchase_date": "2025-12-20T03:22:21.015642"
      },
      {
        "user_id": "23ef61a9-b8e8-4da0-a79e-2bad43c22bad",
        "first_purchase_date": "2025-12-20T03:49:19.015642"
      },
      {
        "user_id": "513f613d-883b-4354-850a-0c79983d1e14",
        "first_purchase_date": "2025-12-20T21:43:13.015642"
      },
      {
        "user_id": "69de2823-c810-46ea-810a-71109ec00485",
        "first_purchase_date": "2025-12-21T03:20:10.015642"
      },
      {
        "user_id": "cadf252d-8454-4983-a270-51d675e83301",
        "first_purchase_date": "2025-12-21T09:53:20.015642"
      },
      {
        "user_id": "ea64e08d-f8a3-4e5f-afa7-670ef60db2ee",
        "first_purchase_date": "2025-12-21T20:25:39.015642"
      },
      {
        "user_id": "e6611f18-b45a-4a1f-a012-d021dea57177",
        "first_purchase_date": "2025-12-22T01:31:38.015642"
      },
      {
        "user_id": "1096807b-b5c3-4237-9e99-d44fa463299b",
        "first_purchase_date": "2025-12-22T10:02:42.015642"
      },
      {
        "user_id": "965b9161-b1ad-444b-8dcd-304042f3ed85",
        "first_purchase_date": "2025-12-22T10:44:52.015642"
      },
      {
        "user_id": "cf599aea-19b6-461a-ba28-6a490db11ffc",
        "first_purchase_date": "2025-12-22T14:46:34.015642"
      },
      {
        "user_id": "07eb1013-663d-48f8-92a8-c110c1b30953",
        "first_purchase_date": "2025-12-22T23:22:57.015642"
      },
      {
        "user_id": "7370fc14-bd96-4991-8c11-32824cd87892",
        "first_purchase_date": "2025-12-23T14:37:00.015642"
      },
      {
        "user_id": "0479700b-369c-4b2b-acbe-15a4bd832104",
        "first_purchase_date": "2025-12-23T18:40:32.015642"
      },
      {
        "user_id": "e291e8a4-786d-4c6a-8427-c4ff4865d69f",
        "first_purchase_date": "2025-12-23T20:52:13.015642"
      },
      {
        "user_id": "fd6aaec6-9f11-4aae-bfcb-601b2893030d",
        "first_purchase_date": "2025-12-24T03:07:01.015642"
      },
      {
        "user_id": "2ae64955-2006-41a9-9c2f-52a7cc384779",
        "first_purchase_date": "2025-12-24T08:08:41.015642"
      },
      {
        "user_id": "182b35b4-5827-4962-89d7-6d742fdd258f",
        "first_purchase_date": "2025-12-24T08:43:38.015642"
      },
      {
        "user_id": "6db57c10-f963-45cd-8592-7ddb290c1ad8",
        "first_purchase_date": "2025-12-24T11:29:29.015642"
      },
      {
        "user_id": "a575da48-9bcf-4704-8c60-68a1e7dfd2e4",
        "first_purchase_date": "2025-12-24T18:56:57.015642"
      },
      {
        "user_id": "2eb02250-adfb-4118-b85f-c6fd7e639b23",
        "first_purchase_date": "2025-12-24T20:04:34.015642"
      },
      {
        "user_id": "81e19954-a4f9-40e2-a098-5a792318ff43",
        "first_purchase_date": "2025-12-24T21:22:47.015642"
      },
      {
        "user_id": "3d397169-ab40-4870-8a86-04aaf08589f0",
        "first_purchase_date": "2025-12-25T00:27:20.015642"
      },
      {
        "user_id": "722b712b-ecf1-4157-bbbc-8148b7937fed",
        "first_purchase_date": "2025-12-25T08:30:40.015642"
      },
      {
        "user_id": "4dc85b60-e519-4828-ac9d-618fa197ec20",
        "first_purchase_date": "2025-12-25T13:37:09.015642"
      },
      {
        "user_id": "d5e831b1-13f5-4a77-9f9f-4697e35cccec",
        "first_purchase_date": "2025-12-25T17:48:20.015642"
      },
      {
        "user_id": "9969f340-9ae4-4c37-a5fd-d52d2c026b1d",
        "first_purchase_date": "2025-12-25T19:53:33.015642"
      },
      {
        "user_id": "472c851c-5057-42bb-8048-3ed4b182e614",
        "first_purchase_date": "2025-12-26T00:35:06.015642"
      },
      {
        "user_id": "453f9df5-7b33-4d0d-8dde-d169f5544d12",
        "first_purchase_date": "2025-12-26T02:05:30.015642"
      },
      {
        "user_id": "e3009393-8bd9-4ac8-8471-8c98612dbd6f",
        "first_purchase_date": "2025-12-26T05:44:11.015642"
      },
      {
        "user_id": "b0c5dfe9-8f0a-4233-abf2-7a9b4d4be195",
        "first_purchase_date": "2025-12-26T06:05:35.015642"
      },
      {
        "user_id": "8187ab45-bb05-4c72-8309-3467a6315f46",
        "first_purchase_date": "2025-12-26T08:38:08.015642"
      },
      {
        "user_id": "3720aacb-220a-415f-b29d-f636d21fbf45",
        "first_purchase_date": "2025-12-26T10:21:56.015642"
      },
      {
        "user_id": "ad6898a4-0411-4dbc-a901-47cbea9e76f0",
        "first_purchase_date": "2025-12-26T21:02:34.015642"
      },
      {
        "user_id": "f774aba4-02a5-49db-b3f2-571f600fbf1b",
        "first_purchase_date": "2025-12-26T21:20:35.015642"
      },
      {
        "user_id": "273da467-e4b7-46d1-b571-810405dbc161",
        "first_purchase_date": "2025-12-26T21:21:25.015642"
      },
      {
        "user_id": "4e07ad25-3b6b-4fc7-94f4-4348c9b7d1d7",
        "first_purchase_date": "2025-12-26T21:32:10.015642"
      },
      {
        "user_id": "1f377ad0-5898-4c4b-add8-79eef9f5bb8c",
        "first_purchase_date": "2025-12-27T03:25:08.015642"
      },
      {
        "user_id": "3d489996-a453-4e67-bfec-3569bce6f683",
        "first_purchase_date": "2025-12-27T04:34:10.015642"
      },
      {
        "user_id": "9c52a0a3-8911-4819-9e06-512e55ff35d0",
        "first_purchase_date": "2025-12-27T10:02:57.015642"
      },
      {
        "user_id": "cb16c507-ca6e-42b3-bf82-a17495b51b81",
        "first_purchase_date": "2025-12-27T13:00:42.015642"
      },
      {
        "user_id": "d32bbfb3-e50b-49df-ab01-5cfef6f3783c",
        "first_purchase_date": "2025-12-27T14:28:13.015642"
      },
      {
        "user_id": "c5878766-d4c5-48e4-8c15-eacb75146f36",
        "first_purchase_date": "2025-12-28T06:01:52.015642"
      },
      {
        "user_id": "4c67d60d-0834-4695-9e55-5f613f0c1861",
        "first_purchase_date": "2025-12-28T07:04:43.015642"
      },
      {
        "user_id": "7ac43477-4a80-43bd-bd18-8b3a9e5bb870",
        "first_purchase_date": "2025-12-28T22:22:43.015642"
      },
      {
        "user_id": "471f1ec9-8fd4-49f0-8b9c-37c32375a956",
        "first_purchase_date": "2025-12-28T23:12:18.015642"
      },
      {
        "user_id": "347deffc-0112-4e90-a42a-d793ab95fe7a",
        "first_purchase_date": "2025-12-29T03:10:10.015642"
      },
      {
        "user_id": "4606cf74-c609-4b96-b65f-78665626966e",
        "first_purchase_date": "2025-12-29T07:53:52.015642"
      },
      {
        "user_id": "a553f9db-912c-402e-a1e8-e84fc3800d16",
        "first_purchase_date": "2025-12-29T11:22:29.015642"
      },
      {
        "user_id": "81b5f3b4-f376-4975-bd9e-fe31def29779",
        "first_purchase_date": "2025-12-29T13:53:16.015642"
      },
      {
        "user_id": "666954fd-a594-44f0-ae5d-184340728d5c",
        "first_purchase_date": "2025-12-29T20:12:41.015642"
      },
      {
        "user_id": "a3f901ce-e846-4f8f-8b0d-c48211524f51",
        "first_purchase_date": "2025-12-29T23:09:42.015642"
      },
      {
        "user_id": "ee3729f2-b6df-42f4-80a4-2e640a62d186",
        "first_purchase_date": "2025-12-30T03:00:27.015642"
      },
      {
        "user_id": "7f79dba6-6ac2-4f9e-b0c6-2318d14d88b4",
        "first_purchase_date": "2025-12-30T09:06:35.015642"
      },
      {
        "user_id": "b4bb75f4-9cd8-4e74-aadd-f680ee56c994",
        "first_purchase_date": "2025-12-30T14:28:05.015642"
      },
      {
        "user_id": "78d37c09-c033-4d84-b274-c5aec03c41d7",
        "first_purchase_date": "2025-12-30T14:37:41.015642"
      },
      {
        "user_id": "502d7d9e-268f-4262-b455-15015cce6f4d",
        "first_purchase_date": "2025-12-30T22:43:33.015642"
      },
      {
        "user_id": "cd373770-4168-4203-91f6-22324016bc10",
        "first_purchase_date": "2025-12-31T02:26:34.015642"
      },
      {
        "user_id": "43afa838-8bcd-4cf4-903d-db3c6a6cd56e",
        "first_purchase_date": "2025-12-31T12:21:07.015642"
      },
      {
        "user_id": "f948b323-e53f-4a9a-9b3a-4a099d24f670",
        "first_purchase_date": "2025-12-31T18:08:06.015642"
      }
    ],
    "expected_row_count": 140
  },
  {
    "problem_id": "2026-01-05_comm_sql_003_set0",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "그로스팀",
    "question": "2025년 11월 한 달 동안, 'view_product' 이벤트부터 'purchase' 이벤트까지 각 단계별 전환율과 이탈률을 분석하고 싶습니다. 주요 퍼널 단계(view_product → add_to_cart → begin_checkout → purchase)를 기준으로 사용자 수와 단계별 전환율(%)을 제공해주세요. 결과는 퍼널 단계 순서대로 정렬하고, 'event_name'과 'step_users', 'conversion_rate' 컬럼으로 표시해주세요.",
    "context": "고객 여정의 병목 구간을 파악하고, 각 단계별 개선 기회를 모색하기 위해 핵심 퍼널의 전환율을 상세 분석하고자 합니다. 특히 'add_to_cart'에서 'begin_checkout' 구간의 이탈에 집중하고 싶습니다.",
    "submission_requirements": "결과는 퍼널 단계 순서대로(view_product → add_to_cart → begin_checkout → purchase) 정렬해주세요. 'event_name'과 'step_users'(해당 단계에 도달한 고유 사용자 수), 'conversion_rate'(이전 단계 대비 전환율, %) 컬럼으로 제공해주세요. 소수점 넷째 자리에서 반올림하여 소수점 셋째 자리까지 표시해주세요.",
    "answer_sql": "WITH funnel_steps AS (\n    SELECT\n        CASE\n            WHEN event_name = 'view_product' THEN 'view_product'\n            WHEN event_name = 'add_to_cart' THEN 'add_to_cart'\n            WHEN event_name = 'begin_checkout' THEN 'begin_checkout'\n            WHEN event_name = 'purchase' THEN 'purchase'\n        END AS event_step,\n        COUNT(DISTINCT user_id) AS users\n    FROM\n        pa_events\n    WHERE\n        event_name IN ('view_product', 'add_to_cart', 'begin_checkout', 'purchase')\n        AND event_time >= '2025-11-01 00:00:00'\n        AND event_time < '2025-12-01 00:00:00'\n    GROUP BY\n        event_step\n),\nfunnel_conversion AS (\n    SELECT\n        event_step,\n        users,\n        LAG(users, 1, users) OVER (ORDER BY\n            CASE event_step\n                WHEN 'view_product' THEN 1\n                WHEN 'add_to_cart' THEN 2\n                WHEN 'begin_checkout' THEN 3\n                WHEN 'purchase' THEN 4\n            END\n        ) AS previous_step_users\n    FROM\n        funnel_steps\n)\nSELECT\n    event_step,\n    users AS step_users,\n    ROUND(CAST(users AS NUMERIC) / previous_step_users, 3) AS conversion_rate\nFROM\n    funnel_conversion\nORDER BY\n    CASE event_step\n        WHEN 'view_product' THEN 1\n        WHEN 'add_to_cart' THEN 2\n        WHEN 'begin_checkout' THEN 3\n        WHEN 'purchase' THEN 4\n    END ASC;",
    "expected_description": "2025년 11월, 'view_product'부터 'purchase'까지 각 단계별 도달한 고유 사용자 수와 이전 단계 대비 전환율을 보여줍니다.",
    "expected_columns": [
      "event_step",
      "step_users",
      "conversion_rate"
    ],
    "sort_keys": [
      "event_step"
    ],
    "hint": "pa_events 테이블에서 필요한 이벤트만 필터링하고, 각 이벤트별로 고유 user_id 수를 계산합니다. LAG 함수를 사용하여 이전 단계 사용자 수를 가져와 전환율을 계산합니다. CASE 문을 사용하여 단계별 순서를 정의합니다.",
    "date": "2026-01-05",
    "set_index": 0,
    "xp_value": 5,
    "expected_result": [
      {
        "event_step": "view_product",
        "step_users": 16879,
        "conversion_rate": 1.0
      },
      {
        "event_step": "add_to_cart",
        "step_users": 6773,
        "conversion_rate": 0.401
      },
      {
        "event_step": "begin_checkout",
        "step_users": 1405,
        "conversion_rate": 0.207
      },
      {
        "event_step": "purchase",
        "step_users": 127,
        "conversion_rate": 0.09
      }
    ],
    "expected_row_count": 4
  },
  {
    "problem_id": "2026-01-05_comm_sql_004_set0",
    "difficulty": "medium",
    "topic": "retention",
    "requester": "마케팅팀",
    "question": "2025년 11월에 첫 구매를 완료한 고객들이 12월에 재구매(reorder)를 한 비율을 알고 싶습니다. 'cohort_month', 'first_purchase_date', 'repeat_purchase_rate' 컬럼으로 결과를 제공해주세요. 결과는 'cohort_month' 기준 오름차순으로 정렬해주세요.",
    "context": "고객 유지율과 충성도를 파악하여 장기적인 고객 관계 구축 전략을 수립하는 데 필요한 데이터를 확보하고자 합니다. 특히 신규 고객의 첫 구매 이후 재구매 행동 분석이 중요합니다.",
    "submission_requirements": "결과는 'cohort_month' 기준 오름차순으로 정렬해주세요. 'cohort_month'(첫 구매가 발생한 월), 'total_first_purchasers'(11월 첫 구매자 수), 'repeat_purchasers'(12월 재구매자 수), 'repeat_purchase_rate'(재구매율, %) 컬럼으로 제공해주세요. 재구매율은 소수점 넷째 자리에서 반올림하여 소수점 셋째 자리까지 표시해주세요. NULLIF를 사용하여 division by zero를 방지하세요.",
    "answer_sql": "WITH UserFirstPurchase AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_purchase_date\n    FROM\n        pa_orders\n    WHERE\n        order_time >= '2025-11-01 00:00:00'\n        AND order_time < '2025-12-01 00:00:00'\n    GROUP BY\n        user_id\n),\nCohortUsers AS (\n    SELECT\n        user_id,\n        DATE_TRUNC('month', first_purchase_date)::TEXT AS cohort_month\n    FROM\n        UserFirstPurchase\n    WHERE\n        cohort_month = '2025-11-01'\n),\nSubsequentPurchases AS (\n    SELECT DISTINCT\n        po.user_id\n    FROM\n        pa_orders po\n    JOIN\n        CohortUsers cu ON po.user_id = cu.user_id\n    WHERE\n        po.order_time >= '2025-12-01 00:00:00'\n        AND po.order_time < '2026-01-01 00:00:00'\n)\nSELECT\n    cu.cohort_month,\n    COUNT(DISTINCT cu.user_id) AS total_first_purchasers,\n    COUNT(DISTINCT sp.user_id) AS repeat_purchasers,\n    ROUND(CAST(COUNT(DISTINCT sp.user_id) AS NUMERIC) * 100 / NULLIF(COUNT(DISTINCT cu.user_id), 0), 3) AS repeat_purchase_rate\nFROM\n    CohortUsers cu\nLEFT JOIN\n    SubsequentPurchases sp ON cu.user_id = sp.user_id\nGROUP BY\n    cu.cohort_month\nORDER BY\n    cu.cohort_month ASC;",
    "expected_description": "2025년 11월 첫 구매 고객을 코호트로 하여, 12월에 재구매한 고객 수와 재구매율을 보여줍니다.",
    "expected_columns": [
      "cohort_month",
      "total_first_purchasers",
      "repeat_purchasers",
      "repeat_purchase_rate"
    ],
    "sort_keys": [
      "cohort_month"
    ],
    "hint": "먼저 11월에 첫 구매한 고객들을 식별하고, 이들이 12월에 재구매했는지 여부를 파악합니다. NULLIF를 사용하여 0으로 나누는 것을 방지하고 재구매율을 계산합니다.",
    "date": "2026-01-05",
    "set_index": 0,
    "xp_value": 5,
    "expected_result": [],
    "expected_row_count": 0
  },
  {
    "problem_id": "2026-01-05_comm_sql_005_set0",
    "difficulty": "hard",
    "topic": "funnel",
    "requester": "CX팀",
    "question": "2025년 11월 한 달 동안 'add_to_cart' 이벤트 후 24시간 이내에 'purchase' 이벤트가 발생하지 않은 세션(장바구니 이탈 세션)을 분석하고 싶습니다. 각 세션별로 'session_id', 'user_id', 'add_to_cart_time', 'last_event_time'을 포함한 결과를 제공해주세요. 결과는 'last_event_time' 기준 내림차순으로 정렬해주세요.",
    "context": "장바구니 이탈의 원인을 파악하고 고객 이탈을 최소화하기 위한 전략을 수립하고자 합니다. 특히 장바구니에 상품을 담은 후 실제로 구매하지 않고 이탈한 고객들의 행동 패턴을 이해하는 것이 중요합니다.",
    "submission_requirements": "결과는 'last_event_time' 기준 내림차순으로 정렬해주세요. 'session_id', 'user_id', 'add_to_cart_time', 'last_event_time' 컬럼으로 제공해주세요. 'last_event_time'은 해당 세션의 가장 마지막 이벤트 시간을 의미합니다. 24시간 이내 구매 이탈 세션만을 대상으로 합니다.",
    "answer_sql": "WITH AddToCartSessions AS (\n    SELECT\n        session_id,\n        user_id,\n        event_time AS add_to_cart_time,\n        ROW_NUMBER() OVER (PARTITION BY session_id ORDER BY event_time) as rn\n    FROM\n        pa_events\n    WHERE\n        event_name = 'add_to_cart'\n        AND event_time >= '2025-11-01 00:00:00'\n        AND event_time < '2025-12-01 00:00:00'\n),\nSessionLastEvent AS (\n    SELECT\n        session_id,\n        MAX(event_time) AS last_event_time\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00'\n        AND event_time < '2025-12-01 00:00:00'\n    GROUP BY\n        session_id\n),\nSessionsWithPurchase AS (\n    SELECT DISTINCT\n        session_id\n    FROM\n        pa_events\n    WHERE\n        event_name = 'purchase'\n        AND event_time >= '2025-11-01 00:00:00'\n        AND event_time < '2025-12-01 00:00:00'\n)\nSELECT\n    ats.session_id,\n    ats.user_id,\n    ats.add_to_cart_time,\n    sle.last_event_time\nFROM\n    AddToCartSessions ats\nJOIN\n    SessionLastEvent sle ON ats.session_id = sle.session_id\nLEFT JOIN\n    SessionsWithPurchase swp ON ats.session_id = swp.session_id\nWHERE\n    ats.rn = 1\n    AND swp.session_id IS NULL  -- 'purchase' 이벤트가 없는 세션\n    AND (sle.last_event_time - ats.add_to_cart_time) >= INTERVAL '24 hours' -- add_to_cart 후 24시간 이상 경과\nORDER BY\n    sle.last_event_time DESC;",
    "expected_description": "2025년 11월, 장바구니에 상품을 담은 후 24시간 이내에 구매하지 않고 이탈한 세션들의 정보를 보여줍니다. 장바구니 담기 시간과 마지막 이벤트 시간을 포함합니다.",
    "expected_columns": [
      "session_id",
      "user_id",
      "add_to_cart_time",
      "last_event_time"
    ],
    "sort_keys": [
      "last_event_time"
    ],
    "hint": "먼저 'add_to_cart' 이벤트가 발생한 세션들을 식별하고, 각 세션의 마지막 이벤트 시간을 찾습니다. 'purchase' 이벤트가 발생하지 않은 세션들 중에서 'add_to_cart' 후 24시간 이상 지난 세션들을 필터링합니다.",
    "date": "2026-01-05",
    "set_index": 0,
    "xp_value": 8,
    "expected_result": [],
    "expected_row_count": 0
  },
  {
    "problem_id": "2026-01-05_comm_sql_006_set0",
    "difficulty": "hard",
    "topic": "segmentation",
    "requester": "마케팅팀",
    "question": "2025년 12월에 가입한 신규 고객 중, 'channel'별로 첫 구매 전환율(%)과 평균 주문 금액(AOV)을 분석하고 싶습니다. 'channel', 'new_users', 'conversion_rate', 'avg_order_value' 컬럼으로 결과를 제공해주세요. 결과는 'conversion_rate' 기준 내림차순으로 정렬해주세요.",
    "context": "각 채널별 신규 고객 유입 및 전환 성과를 비교 분석하여, 효율적인 채널 전략 수립 및 예산 배분을 최적화하고자 합니다. 특히 어떤 채널이 우수한 품질의 신규 고객을 데려오는지 파악하는 것이 중요합니다.",
    "submission_requirements": "결과는 'conversion_rate' 기준 내림차순으로 정렬해주세요. 'channel', 'new_users'(12월 가입 신규 사용자 수), 'conversion_rate'(첫 구매 전환율, %), 'avg_order_value'(해당 채널 신규 고객의 평균 주문 금액) 컬럼으로 제공해주세요. 전환율과 AOV는 소수점 셋째 자리까지 표시해주세요. NULLIF를 사용하여 division by zero를 방지하세요.",
    "answer_sql": "WITH NewUsers AS (\n    SELECT\n        user_id,\n        channel,\n        signup_at\n    FROM\n        pa_users\n    WHERE\n        signup_at >= '2025-12-01 00:00:00'\n        AND signup_at < '2026-01-01 00:00:00'\n),\nFirstPurchases AS (\n    SELECT\n        po.user_id,\n        MIN(po.order_time) AS first_purchase_time,\n        SUM(po.amount) AS total_amount\n    FROM\n        pa_orders po\n    JOIN\n        NewUsers nu ON po.user_id = nu.user_id\n    WHERE\n        po.order_time >= nu.signup_at -- 첫 구매는 가입 이후에 발생해야 함\n    GROUP BY\n        po.user_id\n),\nChannelFirstPurchase AS (\n    SELECT\n        nu.channel,\n        COUNT(DISTINCT nu.user_id) AS new_users,\n        COUNT(fp.user_id) AS first_purchasers,\n        SUM(fp.total_amount) AS total_purchase_amount\n    FROM\n        NewUsers nu\n    LEFT JOIN\n        FirstPurchases fp ON nu.user_id = fp.user_id\n    GROUP BY\n        nu.channel\n)\nSELECT\n    channel,\n    new_users,\n    ROUND(CAST(first_purchasers AS NUMERIC) * 100 / NULLIF(new_users, 0), 3) AS conversion_rate,\n    ROUND(CAST(total_purchase_amount AS NUMERIC) / NULLIF(first_purchasers, 0), 3) AS avg_order_value\nFROM\n    ChannelFirstPurchase\nORDER BY\n    conversion_rate DESC;",
    "expected_description": "2025년 12월 가입한 신규 고객의 채널별 첫 구매 전환율과 해당 채널 신규 고객의 평균 주문 금액을 보여줍니다.",
    "expected_columns": [
      "channel",
      "new_users",
      "conversion_rate",
      "avg_order_value"
    ],
    "sort_keys": [
      "conversion_rate"
    ],
    "hint": "먼저 12월에 가입한 신규 고객을 식별하고, 이들의 채널 정보를 연결합니다. 신규 고객 중 첫 구매를 한 고객과 총 주문 금액을 집계하여 채널별로 전환율과 AOV를 계산합니다. NULLIF 함수를 사용하여 0으로 나누는 경우를 방지합니다.",
    "date": "2026-01-05",
    "set_index": 0,
    "xp_value": 8,
    "expected_result": [
      {
        "channel": "referral",
        "new_users": 6014,
        "conversion_rate": 0.632,
        "avg_order_value": 26744.579
      },
      {
        "channel": "web",
        "new_users": 5945,
        "conversion_rate": 0.589,
        "avg_order_value": 27145.343
      },
      {
        "channel": "ad",
        "new_users": 6014,
        "conversion_rate": 0.582,
        "avg_order_value": 27310.971
      },
      {
        "channel": "organic",
        "new_users": 5921,
        "conversion_rate": 0.574,
        "avg_order_value": 22105.676
      }
    ],
    "expected_row_count": 4
  },
  {
    "problem_id": "2026-01-05_commerce_sql_001_set1",
    "difficulty": "easy",
    "topic": "revenue",
    "requester": "마케팅팀",
    "question": "지난달(2025년 11월) 채널별 총 매출(GMV)과 평균 주문 금액(AOV)을 알고 싶습니다. 결과는 GMV가 높은 순서대로 정렬해주세요.",
    "context": "이번 달 마케팅 캠페인 성과를 평가하고, 다음 달 예산 분배를 계획하기 위해 채널별 매출 기여도를 파악해야 합니다.",
    "submission_requirements": "결과는 channel, total_gmv, average_order_value 컬럼으로 구성하며, total_gmv 기준으로 내림차순 정렬합니다. total_gmv와 average_order_value는 소수점 둘째 자리까지 표시해주세요.",
    "answer_sql": "SELECT\n    pu.channel,\n    SUM(po.amount) AS total_gmv,\n    AVG(po.amount) AS average_order_value\nFROM\n    pa_orders po\nJOIN\n    pa_users pu ON po.user_id = pu.user_id\nWHERE\n    po.order_time >= '2025-11-01 00:00:00'\n    AND po.order_time < '2025-12-01 00:00:00'\nGROUP BY\n    pu.channel\nORDER BY\n    total_gmv DESC;",
    "expected_description": "각 마케팅 채널별 2025년 11월의 총 매출(GMV)과 해당 기간 동안 주문된 상품들의 평균 금액(AOV)을 보여줍니다.",
    "expected_columns": [
      "channel",
      "total_gmv",
      "average_order_value"
    ],
    "sort_keys": [
      "total_gmv"
    ],
    "hint": "pa_orders 테이블과 pa_users 테이블을 user_id로 조인합니다. order_time을 기준으로 기간을 필터링하고, channel별로 GROUP BY하여 SUM과 AVG 함수를 사용하세요.",
    "date": "2026-01-05",
    "set_index": 1,
    "xp_value": 3,
    "expected_result": [
      {
        "channel": "referral",
        "total_gmv": 764129,
        "average_order_value": 24649.322580645163
      },
      {
        "channel": "organic",
        "total_gmv": 445432,
        "average_order_value": 19366.608695652176
      },
      {
        "channel": "ad",
        "total_gmv": 436143,
        "average_order_value": 31153.071428571428
      },
      {
        "channel": "web",
        "total_gmv": 317658,
        "average_order_value": 21177.2
      }
    ],
    "expected_row_count": 4
  },
  {
    "problem_id": "2026-01-05_commerce_sql_002_set1",
    "difficulty": "easy",
    "topic": "funnel",
    "requester": "PM팀",
    "question": "신규 사용자(가입일 기준 2025-10-30 이후)의 'view_product' 이벤트 발생부터 'add_to_cart' 이벤트 발생까지의 전환율을 계산해주세요. 이 분석은 2025년 12월 15일에 완료된 세션을 기준으로 합니다.",
    "context": "신규 사용자가 상품을 발견하고 장바구니에 담는 과정에서의 문제점을 파악하고 개선하기 위해 해당 전환율을 확인해야 합니다.",
    "submission_requirements": "결과는 conversion_rate 컬럼으로 제공하며, 소수점 4자리까지 표시합니다. 'view_product' 이벤트와 'add_to_cart' 이벤트가 모두 존재하는 세션만을 대상으로 합니다.",
    "answer_sql": "WITH SessionEventCounts AS (\n    SELECT\n        pe.session_id,\n        COUNT(CASE WHEN pe.event_name = 'view_product' THEN 1 END) AS view_product_count,\n        COUNT(CASE WHEN pe.event_name = 'add_to_cart' THEN 1 END) AS add_to_cart_count\n    FROM\n        pa_events pe\n    JOIN\n        pa_users pu ON pe.user_id = pu.user_id\n    WHERE\n        pu.signup_at >= '2025-10-30 00:00:00'\n        AND pe.event_time >= '2025-12-01 00:00:00'\n        AND pe.event_time < '2025-12-16 00:00:00'\n    GROUP BY\n        pe.session_id\n)\nSELECT\n    CASE\n        WHEN SUM(view_product_count) = 0 THEN 0\n        ELSE CAST(SUM(CASE WHEN add_to_cart_count > 0 THEN 1 ELSE 0 END) AS DECIMAL) / SUM(CASE WHEN view_product_count > 0 THEN 1 ELSE 0 END)\n    END AS conversion_rate\nFROM\n    SessionEventCounts;",
    "expected_description": "2025년 12월 1일부터 12월 15일까지의 세션 중, 'view_product' 이벤트가 발생한 세션 대비 'add_to_cart' 이벤트까지 성공적으로 전환된 세션의 비율을 나타냅니다. 신규 사용자만을 대상으로 합니다.",
    "expected_columns": [
      "conversion_rate"
    ],
    "sort_keys": [],
    "hint": "먼저 세션별로 'view_product'와 'add_to_cart' 이벤트 발생 횟수를 집계하는 CTE를 만듭니다. 이후 'view_product' 이벤트가 발생한 세션 중 'add_to_cart' 이벤트가 발생한 세션의 비율을 계산합니다. NULLIF 또는 CASE 문을 사용하여 0으로 나누는 것을 방지하세요.",
    "date": "2026-01-05",
    "set_index": 1,
    "xp_value": 3,
    "expected_result": [
      {
        "conversion_rate": 0.24817105613194998
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_003_set1",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "CX팀",
    "question": "장바구니 이탈(add_to_cart 이후 purchase가 발생하지 않은 세션) 비율을 세션별로 계산하고, 특히 'begin_checkout' 단계를 거친 후 이탈하는 비율을 별도로 산출해주세요. 2025년 11월 전체 기간의 데이터를 사용하며, 결과는 이탈 비율이 높은 순서대로 정렬합니다.",
    "context": "사용자가 상품을 장바구니에 담은 후 구매를 완료하지 않는 패턴을 이해하는 것이 장바구니 이탈을 줄이는 데 중요합니다. 특히 결제 시작 후 이탈하는 지점을 파악하여 개선 기회를 찾고자 합니다.",
    "submission_requirements": "결과는 abandonment_stage, abandonment_rate 컬럼으로 구성하며, abandonment_rate 기준으로 내림차순 정렬합니다. abandonment_rate는 소수점 4자리까지 표시합니다.",
    "answer_sql": "WITH SessionStages AS (\n    SELECT\n        session_id,\n        MAX(CASE WHEN event_name = 'add_to_cart' THEN 1 ELSE 0 END) AS has_add_to_cart,\n        MAX(CASE WHEN event_name = 'begin_checkout' THEN 1 ELSE 0 END) AS has_begin_checkout,\n        MAX(CASE WHEN event_name = 'purchase' THEN 1 ELSE 0 END) AS has_purchase\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00'\n        AND event_time < '2025-12-01 00:00:00'\n    GROUP BY\n        session_id\n),\nAbandonment AS (\n    SELECT\n        CASE\n            WHEN has_add_to_cart = 1 AND has_begin_checkout = 0 AND has_purchase = 0 THEN 'Add to Cart Only'\n            WHEN has_add_to_cart = 1 AND has_begin_checkout = 1 AND has_purchase = 0 THEN 'Begin Checkout'\n            ELSE 'Other'\n        END AS abandonment_stage,\n        COUNT(session_id) AS session_count\n    FROM\n        SessionStages\n    WHERE\n        has_add_to_cart = 1 AND has_purchase = 0\n    GROUP BY\n        abandonment_stage\n),\nTotalAbandonableSessions AS (\n    SELECT COUNT(session_id) AS total_count\n    FROM SessionStages\n    WHERE has_add_to_cart = 1 AND has_purchase = 0\n)\nSELECT\n    a.abandonment_stage,\n    CASE\n        WHEN t.total_count = 0 THEN 0\n        ELSE CAST(a.session_count AS DECIMAL) / t.total_count\n    END AS abandonment_rate\nFROM\n    Abandonment a\nCROSS JOIN\n    TotalAbandonableSessions t\nWHERE a.abandonment_stage != 'Other'\nORDER BY\n    abandonment_rate DESC;",
    "expected_description": "2025년 11월에 장바구니에 상품을 담았으나 구매를 완료하지 않은 세션을 대상으로, 'add_to_cart'만 하고 이탈한 비율과 'begin_checkout' 단계를 거친 후 이탈한 비율을 보여줍니다. 가장 높은 이탈 비율을 가진 단계부터 정렬됩니다.",
    "expected_columns": [
      "abandonment_stage",
      "abandonment_rate"
    ],
    "sort_keys": [
      "abandonment_rate"
    ],
    "hint": "세션별로 'add_to_cart', 'begin_checkout', 'purchase' 이벤트 발생 여부를 집계하는 CTE를 만듭니다. 이후 장바구니에 담고 구매하지 않은 세션들을 대상으로 이탈 단계를 구분합니다. 총 장바구니 이탈 세션 수 대비 각 단계별 이탈 세션 수의 비율을 계산합니다.",
    "date": "2026-01-05",
    "set_index": 1,
    "xp_value": 5,
    "expected_result": [
      {
        "abandonment_stage": "Add to Cart Only",
        "abandonment_rate": 0.8348646635212317
      },
      {
        "abandonment_stage": "Begin Checkout",
        "abandonment_rate": 0.16513533647876832
      }
    ],
    "expected_row_count": 2
  },
  {
    "problem_id": "2026-01-05_commerce_sql_004_set1",
    "difficulty": "medium",
    "topic": "retention",
    "requester": "그로스팀",
    "question": "2025년 11월에 첫 구매를 완료한 사용자들이 12월에 재구매했는지 여부를 분석하고 싶습니다. 재구매율(Repeat Purchase Rate)과 해당 사용자들의 평균 재구매 횟수를 계산해주세요.",
    "context": "신규 고객 확보만큼 중요한 것은 기존 고객의 유지 및 재구매 유도입니다. 첫 구매자 대상의 재구매율을 파악하여 향후 고객 유지 전략 수립에 활용하고자 합니다.",
    "submission_requirements": "결과는 repeat_purchase_rate, average_repurchase_count 컬럼으로 구성합니다. repeat_purchase_rate는 소수점 4자리까지 표시하고, average_repurchase_count는 소수점 2자리까지 표시합니다.",
    "answer_sql": "WITH FirstPurchaseUsers AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_purchase_time\n    FROM\n        pa_orders\n    WHERE\n        order_time >= '2025-11-01 00:00:00'\n        AND order_time < '2025-12-01 00:00:00'\n    GROUP BY\n        user_id\n),\nRepurchasedUsers AS (\n    SELECT\n        po.user_id,\n        COUNT(DISTINCT po.order_id) AS repurchase_count\n    FROM\n        pa_orders po\n    JOIN\n        FirstPurchaseUsers fpu ON po.user_id = fpu.user_id\n    WHERE\n        po.order_time >= '2025-12-01 00:00:00'\n        AND po.order_time < '2026-01-01 00:00:00'\n        AND po.order_time > fpu.first_purchase_time -- Ensure it's a subsequent purchase\n    GROUP BY\n        po.user_id\n)\nSELECT\n    CASE\n        WHEN COUNT(DISTINCT fpu.user_id) = 0 THEN 0\n        ELSE CAST(COUNT(DISTINCT ru.user_id) AS DECIMAL) / COUNT(DISTINCT fpu.user_id)\n    END AS repeat_purchase_rate,\n    COALESCE(AVG(ru.repurchase_count), 0) AS average_repurchase_count\nFROM\n    FirstPurchaseUsers fpu\nLEFT JOIN\n    RepurchasedUsers ru ON fpu.user_id = ru.user_id;",
    "expected_description": "2025년 11월에 첫 구매를 한 사용자들을 대상으로, 2025년 12월에 재구매를 한 사용자의 비율(repeat_purchase_rate)과 재구매한 사용자들의 평균 재구매 횟수(average_repurchase_count)를 보여줍니다.",
    "expected_columns": [
      "repeat_purchase_rate",
      "average_repurchase_count"
    ],
    "sort_keys": [],
    "hint": "2025년 11월의 첫 구매 사용자 목록을 추출하는 CTE를 만듭니다. 그 후, 12월에 재구매한 사용자 목록과 재구매 횟수를 집계하는 CTE를 만듭니다. 첫 구매 사용자 전체 대비 재구매 사용자 비율과 재구매 횟수의 평균을 계산합니다. 첫 구매 시점보다 이후에 발생한 구매만 재구매로 간주해야 합니다.",
    "date": "2026-01-05",
    "set_index": 1,
    "xp_value": 5,
    "expected_result": [
      {
        "repeat_purchase_rate": 0.0,
        "average_repurchase_count": 0.0
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_005_set1",
    "difficulty": "hard",
    "topic": "activation",
    "requester": "마케팅팀",
    "question": "2025년 11월에 가입한 사용자들이 첫 구매까지 도달하는 퍼널 단계를 'page_view' -> 'view_product' -> 'add_to_cart' -> 'begin_checkout' -> 'purchase' 순서로 분석하고, 각 단계별 전환율 및 이탈율을 계산해주세요. 'search' 이벤트도 'page_view'와 'view_product' 사이에 포함될 수 있다고 가정합니다.",
    "context": "신규 가입자가 실제 구매로 이어지는 과정을 상세히 이해하여, 각 단계별 병목 현상을 파악하고 개선하기 위한 액션 아이템 도출에 활용하고자 합니다.",
    "submission_requirements": "결과는 event_sequence, conversion_rate, churn_rate 컬럼으로 구성합니다. event_sequence는 'page_view', 'search', 'view_product', 'add_to_cart', 'begin_checkout', 'purchase' 순서를 따릅니다. conversion_rate는 이전 단계 대비 전환율, churn_rate는 이전 단계 대비 이탈율을 의미하며, 둘 다 소수점 4자리까지 표시합니다. 첫 구매 사용자에 대해서만 분석합니다.",
    "answer_sql": "WITH FirstPurchasers AS (\n    SELECT\n        user_id\n    FROM (\n        SELECT\n            user_id,\n            MIN(order_time) AS first_order_time\n        FROM\n            pa_orders\n        WHERE\n            order_time >= '2025-11-01 00:00:00'\n            AND order_time < '2025-12-01 00:00:00'\n        GROUP BY\n            user_id\n    ) AS fp\n    WHERE\n        first_order_time >= (\n            SELECT MIN(started_at) FROM pa_sessions WHERE user_id IN (SELECT user_id FROM pa_users WHERE signup_at >= '2025-11-01 00:00:00' AND signup_at < '2025-12-01 00:00:00')\n        )\n),\nEventOrder AS (\n    SELECT\n        user_id,\n        event_time,\n        CASE\n            WHEN event_name = 'page_view' THEN 1\n            WHEN event_name = 'search' THEN 2\n            WHEN event_name = 'view_product' THEN 3\n            WHEN event_name = 'add_to_cart' THEN 4\n            WHEN event_name = 'begin_checkout' THEN 5\n            WHEN event_name = 'purchase' THEN 6\n            ELSE 99\n        END AS event_order\n    FROM\n        pa_events\n    WHERE\n        user_id IN (SELECT user_id FROM FirstPurchasers)\n        AND event_name IN ('page_view', 'search', 'view_product', 'add_to_cart', 'begin_checkout', 'purchase')\n),\nRankedEvents AS (\n    SELECT\n        user_id,\n        event_time,\n        event_order,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY event_time) as rn\n    FROM\n        EventOrder\n    WHERE event_order < 6 -- Consider only events up to begin_checkout for funnel steps before purchase\n),\nFunnelCounts AS (\n    SELECT\n        CASE\n            WHEN event_order = 1 THEN 'page_view'\n            WHEN event_order = 2 THEN 'search'\n            WHEN event_order = 3 THEN 'view_product'\n            WHEN event_order = 4 THEN 'add_to_cart'\n            WHEN event_order = 5 THEN 'begin_checkout'\n        END AS event_step,\n        COUNT(DISTINCT user_id) AS step_users\n    FROM\n        RankedEvents\n    WHERE rn = 1 -- First occurrence of each step for a user\n    GROUP BY\n        event_step, event_order\n),\nFinalFunnel AS (\n    SELECT\n        event_step,\n        step_users,\n        ROW_NUMBER() OVER (ORDER BY (SELECT NULL)) as step_rank -- Placeholder for ordering, actual order is in CASE statement\n    FROM FunnelCounts\n)\n-- Manually constructing the funnel sequence and calculating rates\nSELECT\n    CASE\n        WHEN sf.event_step = 'page_view' THEN 'page_view -> search'\n        WHEN sf.event_step = 'search' THEN 'search -> view_product'\n        WHEN sf.event_step = 'view_product' THEN 'view_product -> add_to_cart'\n        WHEN sf.event_step = 'add_to_cart' THEN 'add_to_cart -> begin_checkout'\n        WHEN sf.event_step = 'begin_checkout' THEN 'begin_checkout -> purchase'\n    END AS event_sequence,\n    COALESCE(CAST(sf.step_users AS DECIMAL) / LAG(total_users.total_users, 1, (SELECT COUNT(DISTINCT user_id) FROM FirstPurchasers)) OVER (ORDER BY CASE WHEN sf.event_step = 'page_view' THEN 1 WHEN sf.event_step = 'search' THEN 2 WHEN sf.event_step = 'view_product' THEN 3 WHEN sf.event_step = 'add_to_cart' THEN 4 WHEN sf.event_step = 'begin_checkout' THEN 5 END), 0) AS conversion_rate,\n    CASE\n        WHEN LAG(total_users.total_users, 1, (SELECT COUNT(DISTINCT user_id) FROM FirstPurchasers)) OVER (ORDER BY CASE WHEN sf.event_step = 'page_view' THEN 1 WHEN sf.event_step = 'search' THEN 2 WHEN sf.event_step = 'view_product' THEN 3 WHEN sf.event_step = 'add_to_cart' THEN 4 WHEN sf.event_step = 'begin_checkout' THEN 5 END) = 0 THEN 0\n        ELSE 1 - COALESCE(CAST(sf.step_users AS DECIMAL) / LAG(total_users.total_users, 1, (SELECT COUNT(DISTINCT user_id) FROM FirstPurchasers)) OVER (ORDER BY CASE WHEN sf.event_step = 'page_view' THEN 1 WHEN sf.event_step = 'search' THEN 2 WHEN sf.event_step = 'view_product' THEN 3 WHEN sf.event_step = 'add_to_cart' THEN 4 WHEN sf.event_step = 'begin_checkout' THEN 5 END), 0)\n    END AS churn_rate\nFROM\n    FinalFunnel sf\nCROSS JOIN\n    (SELECT COUNT(DISTINCT user_id) AS total_users FROM FirstPurchasers) AS total_users\nWHERE sf.event_step != 'purchase' -- Exclude the final purchase step for conversion to next stage\nORDER BY CASE WHEN sf.event_step = 'page_view' THEN 1 WHEN sf.event_step = 'search' THEN 2 WHEN sf.event_step = 'view_product' THEN 3 WHEN sf.event_step = 'add_to_cart' THEN 4 WHEN sf.event_step = 'begin_checkout' THEN 5 END;",
    "expected_description": "2025년 11월에 가입하고 첫 구매를 완료한 사용자를 대상으로, 주요 퍼널 단계별 전환율(이전 단계 대비 현재 단계 사용자 비율)과 이탈율(이전 단계 대비 이탈 사용자 비율)을 보여줍니다. 'page_view'부터 'begin_checkout'까지의 각 전환을 분석합니다.",
    "expected_columns": [
      "event_sequence",
      "conversion_rate",
      "churn_rate"
    ],
    "sort_keys": [
      "event_sequence"
    ],
    "hint": "2025년 11월에 가입하고 첫 구매를 한 사용자 ID를 먼저 추출합니다. 해당 사용자들의 'page_view', 'search', 'view_product', 'add_to_cart', 'begin_checkout', 'purchase' 이벤트를 시간 순서대로 매핑하고 각 단계별 사용자 수를 집계합니다. ROW_NUMBER() 함수를 사용하여 각 사용자별로 각 단계의 첫 발생 시점을 파악합니다. 이전 단계 사용자 수를 기준으로 현재 단계 사용자 수의 비율(전환율)과 1에서 전환율을 뺀 값(이탈율)을 계산합니다. 0으로 나누는 경우를 방지하기 위해 NULLIF 또는 CASE 문을 사용하세요.",
    "date": "2026-01-05",
    "set_index": 1,
    "xp_value": 8,
    "expected_result": [
      {
        "event_sequence": "page_view -> search",
        "conversion_rate": 1.0,
        "churn_rate": 0.0
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_006_set1",
    "difficulty": "hard",
    "topic": "revenue",
    "requester": "경영진",
    "question": "2025년 10월 30일부터 12월 29일까지의 기간 동안, 각 국가(country)별 총 매출(GMV), 첫 구매 사용자 수, 그리고 ARPU(Average Revenue Per User)를 계산해주세요. ARPU는 해당 기간 동안 구매가 발생한 사용자만을 대상으로 합니다.",
    "context": "전반적인 비즈니스 성과를 측정하기 위해 핵심 국가별 매출 기여도와 사용자당 평균 수익을 파악하는 것이 중요합니다. 이는 향후 투자 및 전략 결정에 필수적인 정보입니다.",
    "submission_requirements": "결과는 country, total_gmv, first_time_buyers, arpu 컬럼으로 구성하며, total_gmv 기준으로 내림차순 정렬합니다. total_gmv는 정수, first_time_buyers는 정수, arpu는 소수점 둘째 자리까지 표시합니다.",
    "answer_sql": "WITH UserFirstOrder AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_order_time\n    FROM\n        pa_orders\n    GROUP BY\n        user_id\n),\nRelevantOrders AS (\n    SELECT\n        po.order_id,\n        po.user_id,\n        po.order_time,\n        po.amount,\n        pu.country,\n        CASE WHEN ufo.user_id IS NOT NULL THEN 1 ELSE 0 END AS is_first_order\n    FROM\n        pa_orders po\n    JOIN\n        pa_users pu ON po.user_id = pu.user_id\n    LEFT JOIN\n        UserFirstOrder ufo ON po.user_id = ufo.user_id AND po.order_time > ufo.first_order_time\n    WHERE\n        po.order_time >= '2025-10-30 00:00:00'\n        AND po.order_time < '2025-12-30 00:00:00'\n),\nCountryStats AS (\n    SELECT\n        country,\n        SUM(amount) AS total_gmv,\n        COUNT(DISTINCT CASE WHEN is_first_order = 1 THEN user_id ELSE NULL END) AS first_time_buyers_count,\n        COUNT(DISTINCT user_id) AS total_buying_users\n    FROM\n        RelevantOrders\n    GROUP BY\n        country\n)\nSELECT\n    cs.country,\n    cs.total_gmv,\n    cs.first_time_buyers_count AS first_time_buyers,\n    CASE\n        WHEN cs.total_buying_users = 0 THEN 0\n        ELSE CAST(cs.total_gmv AS DECIMAL) / cs.total_buying_users\n    END AS arpu\nFROM\n    CountryStats cs\nORDER BY\n    cs.total_gmv DESC;",
    "expected_description": "2025년 10월 30일부터 12월 29일까지 각 국가별 총 매출(GMV), 해당 기간 동안 첫 구매를 한 사용자 수(first_time_buyers), 그리고 해당 기간 동안 구매가 발생한 사용자당 평균 수익(ARPU)을 보여줍니다. 결과는 총 매출(GMV)이 높은 순서대로 정렬됩니다.",
    "expected_columns": [
      "country",
      "total_gmv",
      "first_time_buyers",
      "arpu"
    ],
    "sort_keys": [
      "total_gmv"
    ],
    "hint": "먼저 사용자별 첫 구매 시점을 파악합니다. 해당 기간 동안의 모든 주문 데이터를 수집하되, 각 주문이 사용자의 첫 구매인지 여부를 표시합니다. 각 국가별로 주문 총액(GMV), 첫 구매 사용자 수, 구매가 발생한 총 사용자 수를 집계합니다. ARPU는 총 GMV를 구매가 발생한 총 사용자 수로 나누어 계산합니다. 0으로 나누는 경우를 방지하기 위해 CASE 문을 사용하세요.",
    "date": "2026-01-05",
    "set_index": 1,
    "xp_value": 8,
    "expected_result": [
      {
        "country": "JP",
        "total_gmv": 813405,
        "first_time_buyers": 0,
        "arpu": 23923.676470588234
      },
      {
        "country": "CA",
        "total_gmv": 686041,
        "first_time_buyers": 0,
        "arpu": 24501.464285714286
      },
      {
        "country": "FR",
        "total_gmv": 617464,
        "first_time_buyers": 0,
        "arpu": 29403.04761904762
      },
      {
        "country": "IN",
        "total_gmv": 584041,
        "first_time_buyers": 0,
        "arpu": 23361.64
      },
      {
        "country": "DE",
        "total_gmv": 538967,
        "first_time_buyers": 0,
        "arpu": 21558.68
      },
      {
        "country": "KR",
        "total_gmv": 513149,
        "first_time_buyers": 0,
        "arpu": 24435.666666666668
      },
      {
        "country": "US",
        "total_gmv": 490661,
        "first_time_buyers": 0,
        "arpu": 27258.944444444445
      },
      {
        "country": "UK",
        "total_gmv": 448122,
        "first_time_buyers": 0,
        "arpu": 23585.368421052633
      },
      {
        "country": "IT",
        "total_gmv": 415538,
        "first_time_buyers": 0,
        "arpu": 17314.083333333332
      }
    ],
    "expected_row_count": 9
  },
  {
    "problem_id": "2026-01-05_commerce_sql_001_set2",
    "difficulty": "easy",
    "topic": "revenue",
    "requester": "경영진",
    "question": "2025년 11월, 일별 총 매출(GMV)과 평균 주문 금액(AOV)을 알고 싶습니다. 결과를 날짜 기준으로 오름차순 정렬해주세요.",
    "context": "월별 매출 추이를 파악하고, 특정 시점의 성과를 측정하기 위해 필요합니다.",
    "submission_requirements": "결과는 'order_date' (일자) 와 'daily_gmv' (일별 총 매출), 'daily_aov' (일별 평균 주문 금액) 컬럼을 포함해야 하며, 'order_date' 기준으로 오름차순 정렬해야 합니다. 'daily_gmv'와 'daily_aov'는 소수점 둘째 자리까지 표시해주세요.",
    "answer_sql": "SELECT\n    DATE(order_time) AS order_date,\n    SUM(amount) AS daily_gmv,\n    AVG(amount) AS daily_aov\nFROM\n    pa_orders\nWHERE\n    order_time >= '2025-11-01 00:00:00' AND order_time < '2025-12-01 00:00:00'\nGROUP BY\n    order_date\nORDER BY\n    order_date ASC;",
    "expected_description": "각 날짜별로 총 거래액(GMV)과 해당 날짜의 평균 주문 금액(AOV)을 보여주는 테이블입니다.",
    "expected_columns": [
      "order_date",
      "daily_gmv",
      "daily_aov"
    ],
    "sort_keys": [
      "order_date"
    ],
    "hint": "pa_orders 테이블의 order_time을 DATE 함수로 변환하여 날짜별로 그룹화하고, SUM 함수와 AVG 함수를 사용하여 매출과 평균 주문 금액을 계산하세요. 날짜 범위는 '2025-11-01'부터 '2025-11-30'까지입니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 3,
    "expected_result": [
      {
        "order_date": "2025-11-02",
        "daily_gmv": 23895,
        "daily_aov": 11947.5
      },
      {
        "order_date": "2025-11-06",
        "daily_gmv": 29312,
        "daily_aov": 29312.0
      },
      {
        "order_date": "2025-11-07",
        "daily_gmv": 4801,
        "daily_aov": 4801.0
      },
      {
        "order_date": "2025-11-08",
        "daily_gmv": 23180,
        "daily_aov": 23180.0
      },
      {
        "order_date": "2025-11-09",
        "daily_gmv": 46953,
        "daily_aov": 46953.0
      },
      {
        "order_date": "2025-11-10",
        "daily_gmv": 36151,
        "daily_aov": 9037.75
      },
      {
        "order_date": "2025-11-11",
        "daily_gmv": 131380,
        "daily_aov": 32845.0
      },
      {
        "order_date": "2025-11-12",
        "daily_gmv": 38796,
        "daily_aov": 19398.0
      },
      {
        "order_date": "2025-11-14",
        "daily_gmv": 98388,
        "daily_aov": 32796.0
      },
      {
        "order_date": "2025-11-15",
        "daily_gmv": 97416,
        "daily_aov": 24354.0
      },
      {
        "order_date": "2025-11-16",
        "daily_gmv": 112573,
        "daily_aov": 28143.25
      },
      {
        "order_date": "2025-11-17",
        "daily_gmv": 120816,
        "daily_aov": 30204.0
      },
      {
        "order_date": "2025-11-18",
        "daily_gmv": 118209,
        "daily_aov": 29552.25
      },
      {
        "order_date": "2025-11-19",
        "daily_gmv": 123498,
        "daily_aov": 17642.571428571428
      },
      {
        "order_date": "2025-11-20",
        "daily_gmv": 111377,
        "daily_aov": 18562.833333333332
      },
      {
        "order_date": "2025-11-21",
        "daily_gmv": 139618,
        "daily_aov": 34904.5
      },
      {
        "order_date": "2025-11-22",
        "daily_gmv": 29600,
        "daily_aov": 29600.0
      },
      {
        "order_date": "2025-11-23",
        "daily_gmv": 36652,
        "daily_aov": 36652.0
      },
      {
        "order_date": "2025-11-24",
        "daily_gmv": 24801,
        "daily_aov": 24801.0
      },
      {
        "order_date": "2025-11-25",
        "daily_gmv": 84431,
        "daily_aov": 16886.2
      },
      {
        "order_date": "2025-11-26",
        "daily_gmv": 70637,
        "daily_aov": 17659.25
      },
      {
        "order_date": "2025-11-27",
        "daily_gmv": 101513,
        "daily_aov": 25378.25
      },
      {
        "order_date": "2025-11-28",
        "daily_gmv": 165606,
        "daily_aov": 27601.0
      },
      {
        "order_date": "2025-11-29",
        "daily_gmv": 122930,
        "daily_aov": 20488.333333333332
      },
      {
        "order_date": "2025-11-30",
        "daily_gmv": 70829,
        "daily_aov": 23609.666666666668
      }
    ],
    "expected_row_count": 25
  },
  {
    "problem_id": "2026-01-05_commerce_sql_002_set2",
    "difficulty": "easy",
    "topic": "activation",
    "requester": "PM팀",
    "question": "2025년 12월에 가입한 신규 고객 중 첫 구매를 완료한 고객 수를 알려주세요. 결과는 숫자로만 표시해주시면 됩니다.",
    "context": "신규 고객 확보 및 전환율 개선 활동의 성과를 측정하기 위해 필요합니다.",
    "submission_requirements": "결과는 'new_customer_first_purchase_count' 라는 이름의 단일 컬럼으로 반환되어야 합니다. 이 값은 첫 구매를 완료한 신규 고객의 총 수를 나타냅니다.",
    "answer_sql": "WITH new_customers AS (\n    SELECT\n        user_id\n    FROM\n        pa_users\n    WHERE\n        signup_at >= '2025-12-01 00:00:00' AND signup_at < '2026-01-01 00:00:00'\n),\nfirst_purchasers AS (\n    SELECT\n        user_id,\n        MIN(order_time) as first_order_time\n    FROM\n        pa_orders\n    GROUP BY\n        user_id\n)\nSELECT\n    COUNT(DISTINCT nc.user_id)\nFROM\n    new_customers nc\nJOIN\n    first_purchasers fp ON nc.user_id = fp.user_id\nWHERE\n    fp.first_order_time >= nc.signup_at;",
    "expected_description": "2025년 12월에 가입하고 첫 구매를 완료한 신규 고객의 총 수를 보여줍니다.",
    "expected_columns": [
      "new_customer_first_purchase_count"
    ],
    "sort_keys": [],
    "hint": "먼저 12월에 가입한 고객 목록(new_customers)과 모든 고객의 첫 구매 시점(first_purchasers)을 분리하세요. 이후 두 목록을 조인하여 신규 고객이면서 첫 구매 시점이 가입 시점 이후인 고객의 수를 계산합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 3,
    "expected_result": [],
    "expected_row_count": 0
  },
  {
    "problem_id": "2026-01-05_commerce_sql_003_set2",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "PM팀",
    "question": "2025년 11월, 'view_product' 이벤트 이후 'add_to_cart' 이벤트로 전환한 고객의 수와 'add_to_cart' 이후 'purchase' 이벤트로 전환한 고객 수를 각각 알려주세요. 또한, 각 단계별 전환율을 계산해주세요. 결과는 'view_product_to_add_to_cart_rate' 와 'add_to_cart_to_purchase_rate' 컬럼으로 표시하고, 이 값들은 소수점 셋째 자리까지 반올림해주세요.",
    "context": "주요 구매 퍼널 단계에서의 고객 행동을 이해하고, 이탈 지점을 파악하여 개선하기 위해 필요합니다.",
    "submission_requirements": "결과는 'view_product_count', 'add_to_cart_count', 'purchase_count', 'view_product_to_add_to_cart_rate', 'add_to_cart_to_purchase_rate' 컬럼을 포함해야 합니다. 전환율은 각 단계의 이벤트 수를 기준으로 계산하며, 소수점 셋째 자리까지 반올림하여 표시해주세요. 전체 결과는 단일 행으로 반환되어야 합니다.",
    "answer_sql": "WITH event_counts AS (\n    SELECT\n        SUM(CASE WHEN event_name = 'view_product' THEN 1 ELSE 0 END) AS view_product_cnt,\n        SUM(CASE WHEN event_name = 'add_to_cart' THEN 1 ELSE 0 END) AS add_to_cart_cnt,\n        SUM(CASE WHEN event_name = 'purchase' THEN 1 ELSE 0 END) AS purchase_cnt\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n),\n\n-- 'view_product' 이후 'add_to_cart' 전환을 명확히 하기 위해 각 사용자의 마지막 'view_product'와 첫 'add_to_cart' 시점을 파악합니다.\n-- 여기서는 간단하게 각 이벤트 수를 세고 전환율을 계산하는 방식으로 접근합니다. (주의: 더 정확한 퍼널은 사용자별 세션 및 순서 분석 필요)\n\n-- 더 정확한 사용자별 퍼널 분석을 위한 CTE (실제로는 좀 더 복잡한 로직 필요)\n-- 이 문제에서는 편의상 단순 이벤트 수 기반으로 접근합니다.\n\nuser_event_sequence AS (\n    SELECT\n        user_id,\n        event_time,\n        event_name,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY event_time) as rn\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n        AND event_name IN ('view_product', 'add_to_cart', 'purchase')\n),\n\nview_to_cart AS (\n    SELECT\n        COUNT(DISTINCT vp.user_id) AS view_to_cart_user_count\n    FROM\n        user_event_sequence vp\n    JOIN\n        user_event_sequence atc ON vp.user_id = atc.user_id\n    WHERE\n        vp.event_name = 'view_product'\n        AND atc.event_name = 'add_to_cart'\n        AND atc.event_time > vp.event_time\n        AND vp.rn < atc.rn -- view_product가 add_to_cart보다 먼저 발생했음을 보장\n),\n\ncart_to_purchase AS (\n    SELECT\n        COUNT(DISTINCT atc.user_id) AS cart_to_purchase_user_count\n    FROM\n        user_event_sequence atc\n    JOIN\n        user_event_sequence pur ON atc.user_id = pur.user_id\n    WHERE\n        atc.event_name = 'add_to_cart'\n        AND pur.event_name = 'purchase'\n        AND pur.event_time > atc.event_time\n        AND atc.rn < pur.rn -- add_to_cart가 purchase보다 먼저 발생했음을 보장\n)\n\nSELECT\n    ec.view_product_cnt AS view_product_count,\n    ec.add_to_cart_cnt AS add_to_cart_count,\n    ec.purchase_cnt AS purchase_count,\n    ROUND(CASE WHEN ec.view_product_cnt = 0 THEN 0 ELSE CAST(vtc.view_to_cart_user_count AS NUMERIC) / ec.view_product_cnt END, 3) AS view_product_to_add_to_cart_rate,\n    ROUND(CASE WHEN ec.add_to_cart_cnt = 0 THEN 0 ELSE CAST(ctp.cart_to_purchase_user_count AS NUMERIC) / ec.add_to_cart_cnt END, 3) AS add_to_cart_to_purchase_rate\nFROM\n    event_counts ec,\n    view_to_cart vtc,\n    cart_to_purchase ctp;",
    "expected_description": "2025년 11월의 'view_product', 'add_to_cart', 'purchase' 이벤트 수를 보여주고, 'view_product'에서 'add_to_cart'로의 전환율과 'add_to_cart'에서 'purchase'로의 전환율을 계산하여 표시합니다.",
    "expected_columns": [
      "view_product_count",
      "add_to_cart_count",
      "purchase_count",
      "view_product_to_add_to_cart_rate",
      "add_to_cart_to_purchase_rate"
    ],
    "sort_keys": [],
    "hint": "각 이벤트의 총 수를 먼저 집계합니다. 정확한 사용자별 퍼널 전환을 위해, 사용자의 이벤트 순서를 파악하는 CTE를 생성하고, 이후 join을 통해 'view_product' 이후 'add_to_cart'로 전환한 사용자 수와 'add_to_cart' 이후 'purchase'로 전환한 사용자 수를 계산합니다. NULLIF 또는 CASE 문을 사용하여 0으로 나누는 오류를 방지하고, ROUND 함수를 사용하여 소수점 셋째 자리까지 반올림합니다. (주의: 이 문제는 사용자별 이벤트 순서가 복잡한 경우 더 정교한 분석이 필요합니다. 여기서는 제공된 스키마와 이벤트 정보로 최대한 구현합니다.)",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 5,
    "expected_result": [
      {
        "view_product_count": 77860.0,
        "add_to_cart_count": 8181.0,
        "purchase_count": 127.0,
        "view_product_to_add_to_cart_rate": 0.087,
        "add_to_cart_to_purchase_rate": 0.016
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_004_set2",
    "difficulty": "medium",
    "topic": "retention",
    "requester": "그로스팀",
    "question": "2025년 11월에 첫 구매를 한 고객 중, 2025년 12월에 다시 구매(reorder)한 고객의 비율을 계산해주세요. 재구매율은 소수점 셋째 자리까지 표시해주세요.",
    "context": "고객 유지 및 충성도 향상 전략의 효과를 측정하기 위해 필요합니다.",
    "submission_requirements": "결과는 'repeat_purchase_rate'라는 단일 컬럼으로 반환되어야 합니다. 이 값은 첫 구매 후 재구매한 고객의 비율을 나타내며, 소수점 셋째 자리까지 표시됩니다. (예: 0.150)",
    "answer_sql": "WITH first_purchasers AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_order_time\n    FROM\n        pa_orders\n    WHERE\n        order_time >= '2025-11-01 00:00:00' AND order_time < '2025-12-01 00:00:00'\n    GROUP BY\n        user_id\n),\n\nrepeat_purchasers AS (\n    SELECT\n        o.user_id\n    FROM\n        pa_orders o\n    JOIN\n        first_purchasers fp ON o.user_id = fp.user_id\n    WHERE\n        o.order_time >= '2025-12-01 00:00:00' AND o.order_time < '2026-01-01 00:00:00'\n        AND o.order_time > fp.first_order_time -- 재구매 시점이 첫 구매 시점보다 나중이어야 함\n    GROUP BY\n        o.user_id\n)\n\nSELECT\n    ROUND(CAST(COUNT(rp.user_id) AS NUMERIC) / COUNT(fp.user_id), 3) AS repeat_purchase_rate\nFROM\n    first_purchasers fp\nLEFT JOIN\n    repeat_purchasers rp ON fp.user_id = rp.user_id;",
    "expected_description": "2025년 11월에 첫 구매를 한 고객 중, 2025년 12월에 다시 구매한 고객의 비율을 보여줍니다.",
    "expected_columns": [
      "repeat_purchase_rate"
    ],
    "sort_keys": [],
    "hint": "먼저 11월에 첫 구매를 한 고객 목록을 추출합니다. 그 다음, 12월에 발생한 주문 중 11월 첫 구매 고객이면서, 첫 구매 시점보다 나중에 구매한 경우를 찾아 재구매 고객으로 집계합니다. 최종적으로 첫 구매 고객 수 대비 재구매 고객 수의 비율을 계산하고 소수점 셋째 자리까지 반올림합니다. LEFT JOIN을 사용하여 첫 구매 고객 중 재구매 고객이 없는 경우도 포함합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 5,
    "expected_result": [
      {
        "repeat_purchase_rate": 0.0
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_005_set2",
    "difficulty": "hard",
    "topic": "funnel",
    "requester": "CX팀",
    "question": "2025년 11월, 'add_to_cart' 이벤트 이후 7일 이내에 'purchase' 이벤트가 발생하지 않은 고객의 비율(장바구니 이탈률)을 계산해주세요. 이탈 고객의 총 수와 전체 'add_to_cart' 이벤트 수를 함께 제공해주세요. 결과는 각 비율을 소수점 넷째 자리까지 표시해주세요.",
    "context": "장바구니 단계에서의 고객 이탈 원인을 파악하고, 이탈률을 개선하기 위한 전략 수립에 활용하고자 합니다.",
    "submission_requirements": "결과는 'total_add_to_cart_events', 'cart_abandonment_count', 'cart_abandonment_rate' 컬럼을 포함해야 합니다. 'cart_abandonment_rate'는 소수점 넷째 자리까지 표시해주세요. 결과는 단일 행으로 반환되어야 합니다.",
    "answer_sql": "WITH cart_events AS (\n    SELECT\n        user_id,\n        session_id,\n        event_time AS add_to_cart_time\n    FROM\n        pa_events\n    WHERE\n        event_name = 'add_to_cart'\n        AND event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n),\n\npurchase_after_cart AS (\n    SELECT DISTINCT\n        ce.user_id,\n        ce.session_id\n    FROM\n        cart_events ce\n    JOIN\n        pa_events pe ON ce.user_id = pe.user_id AND ce.session_id = pe.session_id\n    WHERE\n        pe.event_name = 'purchase'\n        AND pe.event_time BETWEEN ce.add_to_cart_time AND ce.add_to_cart_time + INTERVAL '7 days'\n)\n\nSELECT\n    COUNT(ce.session_id) AS total_add_to_cart_events,\n    COUNT(ce.session_id) - COUNT(pac.session_id) AS cart_abandonment_count,\n    ROUND(CAST(COUNT(ce.session_id) - COUNT(pac.session_id) AS NUMERIC) / COUNT(ce.session_id), 4) AS cart_abandonment_rate\nFROM\n    cart_events ce\nLEFT JOIN\n    purchase_after_cart pac ON ce.user_id = pac.user_id AND ce.session_id = pac.session_id;",
    "expected_description": "2025년 11월의 총 'add_to_cart' 이벤트 수, 7일 이내 구매가 발생하지 않은 장바구니 이탈 이벤트 수, 그리고 장바구니 이탈률을 보여줍니다.",
    "expected_columns": [
      "total_add_to_cart_events",
      "cart_abandonment_count",
      "cart_abandonment_rate"
    ],
    "sort_keys": [],
    "hint": "먼저 11월에 발생한 'add_to_cart' 이벤트 정보를 추출합니다. 이후, 해당 'add_to_cart' 이벤트가 속한 세션에서 7일 이내에 'purchase' 이벤트가 발생했는지 확인하는 CTE를 생성합니다. 마지막으로 'add_to_cart' 이벤트 총 수에서 7일 이내 구매가 발생한 이벤트 수를 제외하여 이탈 수를 계산하고, 이탈률을 계산합니다. LEFT JOIN을 사용하여 'purchase'가 없는 경우에도 'add_to_cart' 이벤트 수를 모두 포함합니다. INTERVAL 함수를 사용하여 날짜 계산을 합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 8,
    "expected_result": [
      {
        "total_add_to_cart_events": 8181.0,
        "cart_abandonment_count": 8054.0,
        "cart_abandonment_rate": 0.9845
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_006_set2",
    "difficulty": "hard",
    "topic": "engagement",
    "requester": "마케팅팀",
    "question": "2025년 11월, 사용자별 'apply_coupon' 이벤트 수와 해당 사용자가 쿠폰 적용 후 실제로 'purchase'까지 전환한 비율을 계산해주세요. 결과는 사용자 ID, 쿠폰 적용 횟수, 그리고 구매 전환율 순서로 보여주며, 전환율이 높은 순으로 정렬해주세요. 전환율은 소수점 셋째 자리까지 반올림해주세요. 2회 이상 쿠폰을 적용한 사용자만 대상으로 합니다.",
    "context": "쿠폰 프로모션의 실제 효과를 파악하고, 구매 전환에 기여하는 고객 그룹을 식별하여 마케팅 효율을 증대시키고자 합니다.",
    "submission_requirements": "결과는 'user_id', 'coupon_apply_count', 'purchase_conversion_rate' 컬럼을 포함해야 하며, 'purchase_conversion_rate' 기준으로 내림차순 정렬해야 합니다. 'coupon_apply_count'는 2회 이상인 사용자만 포함되며, 'purchase_conversion_rate'는 소수점 셋째 자리까지 반올림하여 표시됩니다.",
    "answer_sql": "WITH coupon_applies AS (\n    SELECT\n        user_id,\n        COUNT(event_id) AS apply_count,\n        MIN(event_time) AS first_apply_time\n    FROM\n        pa_events\n    WHERE\n        event_name = 'apply_coupon'\n        AND event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n    GROUP BY\n        user_id\n    HAVING\n        COUNT(event_id) >= 2\n),\n\npurchases_after_coupon AS (\n    SELECT DISTINCT\n        pe.user_id\n    FROM\n        pa_events pe\n    JOIN\n        coupon_applies ca ON pe.user_id = ca.user_id\n    WHERE\n        pe.event_name = 'purchase'\n        AND pe.event_time >= ca.first_apply_time -- 쿠폰 적용 이후 구매만 고려\n)\n\nSELECT\n    ca.user_id,\n    ca.apply_count AS coupon_apply_count,\n    ROUND(CAST(COUNT(pac.user_id) AS NUMERIC) / ca.apply_count, 3) AS purchase_conversion_rate\nFROM\n    coupon_applies ca\nLEFT JOIN\n    purchases_after_coupon pac ON ca.user_id = pac.user_id\nGROUP BY\n    ca.user_id,\n    ca.apply_count\nORDER BY\n    purchase_conversion_rate DESC;",
    "expected_description": "2025년 11월에 2회 이상 쿠폰을 적용한 사용자를 대상으로, 사용자별 쿠폰 적용 횟수와 쿠폰 적용 후 구매 전환율을 보여주며, 전환율이 높은 순서대로 정렬됩니다.",
    "expected_columns": [
      "user_id",
      "coupon_apply_count",
      "purchase_conversion_rate"
    ],
    "sort_keys": [
      "purchase_conversion_rate DESC"
    ],
    "hint": "먼저 11월에 'apply_coupon' 이벤트를 2회 이상 발생시킨 사용자들을 집계합니다. 이후, 해당 사용자들의 'purchase' 이벤트 중 쿠폰 적용 시점 이후에 발생한 구매를 식별합니다. 최종적으로 각 사용자별 쿠폰 적용 횟수 대비 구매 전환 횟수의 비율을 계산하고, 전환율이 높은 순으로 정렬합니다. LEFT JOIN을 사용하여 쿠폰 적용 후 구매가 없는 경우도 고려합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 8,
    "expected_result": [
      {
        "user_id": "148ee165-1941-4e51-be6d-e81974f3175e",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "2dd5b8e4-e09f-4466-a781-65a8c36ae460",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "3578d56f-8874-41e0-bb13-5ac6fed659ff",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "3a69e669-3e62-4481-90d9-e1c1e83ecae0",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "3c7a92a3-164c-4873-898c-5569034df990",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "4e8be79a-b8e3-4609-ba8b-34d137146731",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "582c8b75-22bb-4b69-9e83-9fb376be31a6",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "619f7e89-05b9-471b-be57-52ffbf166476",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "86e06c4f-0d62-4ef8-b528-8fab626c217a",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "8f2078cd-5b7f-4fbe-b870-c78415056ec7",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "a22554d3-2308-45a4-b7ce-08dcad101149",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "a3a8c1bd-e60a-42ed-9c40-c3ce53ea00e6",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "be12c2fe-501d-43bd-8c35-c28c570a17dc",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "be2f1983-8834-4429-bcfe-04e70759cbdb",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "d7c6b185-7b59-4889-aaa2-cc6b487564ca",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "e0333677-1d0f-4a89-8556-7d75f0de92bb",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "e2dd3ffc-c29f-4b10-9c47-3c6f3829942c",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "e37c6ed9-714f-4169-b041-0311065545bd",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      }
    ],
    "expected_row_count": 18
  }
]