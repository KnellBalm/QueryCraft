[
  {
    "problem_id": "2026-01-02_commerce_sql_001_set0",
    "difficulty": "easy",
    "topic": "revenue",
    "requester": "경영진",
    "question": "안녕하세요, 경영진입니다. 지난 12월 한 달 간의 일별 총 거래액(GMV) 추이가 궁금합니다. 각 날짜별로 총 주문 금액을 확인할 수 있도록 분석 부탁드립니다.",
    "context": "월말을 맞아 지난달의 매출 성과를 파악하고 이를 바탕으로 향후 비즈니스 전략을 수립하고자 합니다. 특히 일별 추이를 통해 변동 요인을 파악하는 것이 중요합니다.",
    "submission_requirements": "결과는 date 컬럼 기준 오름차순 정렬하며, 총 거래액(GMV)은 소수점 둘째 자리까지 표시해주세요.",
    "answer_sql": "SELECT\n    DATE(order_time) AS order_date,\n    SUM(amount) AS total_gmv\nFROM\n    pa_orders\nWHERE\n    order_time >= '2025-12-01 00:00:00'\n    AND order_time < '2026-01-01 00:00:00'\nGROUP BY\n    order_date\nORDER BY\n    order_date ASC;",
    "expected_description": "각 날짜별로 발생한 총 거래액(GMV)을 보여주는 테이블입니다. order_date는 주문이 발생한 날짜를, total_gmv는 해당 날짜의 총 주문 금액을 나타냅니다.",
    "expected_columns": [
      "order_date",
      "total_gmv"
    ],
    "sort_keys": [
      "order_date"
    ],
    "hint": "pa_orders 테이블의 order_time 컬럼에서 날짜만 추출하고, amount 컬럼을 합산하세요. DATE() 함수와 SUM() 함수를 활용하고, GROUP BY와 ORDER BY 절을 사용하여 원하는 형태로 집계 및 정렬하세요.",
    "date": "2026-01-02",
    "set_index": 0,
    "xp_value": 3,
    "expected_result": [
      {
        "order_date": "2025-12-01",
        "total_gmv": 179718
      },
      {
        "order_date": "2025-12-02",
        "total_gmv": 79010
      },
      {
        "order_date": "2025-12-03",
        "total_gmv": 58264
      },
      {
        "order_date": "2025-12-04",
        "total_gmv": 133470
      },
      {
        "order_date": "2025-12-05",
        "total_gmv": 72651
      },
      {
        "order_date": "2025-12-06",
        "total_gmv": 15184
      },
      {
        "order_date": "2025-12-07",
        "total_gmv": 61544
      },
      {
        "order_date": "2025-12-08",
        "total_gmv": 35662
      },
      {
        "order_date": "2025-12-09",
        "total_gmv": 53878
      },
      {
        "order_date": "2025-12-10",
        "total_gmv": 58905
      },
      {
        "order_date": "2025-12-11",
        "total_gmv": 81071
      },
      {
        "order_date": "2025-12-12",
        "total_gmv": 142246
      },
      {
        "order_date": "2025-12-13",
        "total_gmv": 125207
      },
      {
        "order_date": "2025-12-14",
        "total_gmv": 82814
      },
      {
        "order_date": "2025-12-15",
        "total_gmv": 133439
      },
      {
        "order_date": "2025-12-16",
        "total_gmv": 120137
      },
      {
        "order_date": "2025-12-17",
        "total_gmv": 242671
      },
      {
        "order_date": "2025-12-18",
        "total_gmv": 95931
      },
      {
        "order_date": "2025-12-19",
        "total_gmv": 102297
      },
      {
        "order_date": "2025-12-20",
        "total_gmv": 95037
      },
      {
        "order_date": "2025-12-21",
        "total_gmv": 88009
      },
      {
        "order_date": "2025-12-22",
        "total_gmv": 88833
      },
      {
        "order_date": "2025-12-23",
        "total_gmv": 94983
      },
      {
        "order_date": "2025-12-24",
        "total_gmv": 195792
      },
      {
        "order_date": "2025-12-25",
        "total_gmv": 93236
      },
      {
        "order_date": "2025-12-26",
        "total_gmv": 189707
      },
      {
        "order_date": "2025-12-27",
        "total_gmv": 119151
      },
      {
        "order_date": "2025-12-28",
        "total_gmv": 124651
      },
      {
        "order_date": "2025-12-29",
        "total_gmv": 180528
      },
      {
        "order_date": "2025-12-30",
        "total_gmv": 132493
      },
      {
        "order_date": "2025-12-31",
        "total_gmv": 98837
      }
    ],
    "expected_row_count": 31
  },
  {
    "problem_id": "2026-01-02_commerce_sql_002_set0",
    "difficulty": "easy",
    "topic": "activation",
    "requester": "마케팅팀",
    "question": "마케팅팀입니다. 2025년 11월 1일부터 12월 29일 기간 동안 가입한 신규 사용자 중 첫 구매를 완료한 사용자가 몇 명인지 알고 싶습니다. 각 사용자별로 첫 구매 시점을 기준으로 집계해주세요.",
    "context": "신규 유입 사용자의 첫 구매 전환 성과를 파악하여 마케팅 캠페인의 효율성을 측정하고 개선 방안을 모색하고자 합니다.",
    "submission_requirements": "결과는 signup_at 기준 오름차순으로 정렬하며, user_id와 signup_at, 그리고 첫 구매 완료 시점을 포함해주세요.",
    "answer_sql": "WITH FirstPurchase AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_purchase_time\n    FROM\n        pa_orders\n    GROUP BY\n        user_id\n)\nSELECT\n    u.user_id,\n    u.signup_at,\n    fp.first_purchase_time\nFROM\n    pa_users u\nJOIN\n    FirstPurchase fp ON u.user_id = fp.user_id\nWHERE\n    u.signup_at >= '2025-11-01 00:00:00'\n    AND u.signup_at < '2025-12-30 00:00:00'\n    AND fp.first_purchase_time >= u.signup_at\nORDER BY\n    u.signup_at ASC;",
    "expected_description": "2025년 11월 1일부터 12월 29일 사이에 가입한 사용자 중 첫 구매를 완료한 사용자 목록입니다. user_id는 사용자 고유 ID, signup_at은 가입일, first_purchase_time은 첫 구매가 발생한 시점을 나타냅니다.",
    "expected_columns": [
      "user_id",
      "signup_at",
      "first_purchase_time"
    ],
    "sort_keys": [
      "signup_at"
    ],
    "hint": "먼저 pa_orders 테이블에서 각 user_id별 첫 구매 시간을 찾고, 이를 pa_users 테이블과 조인합니다. signup_at과 first_purchase_time이 일치하는 경우를 찾고, 가입 기간 조건을 적용하세요.",
    "date": "2026-01-02",
    "set_index": 0,
    "xp_value": 3,
    "expected_result": [
      {
        "user_id": "e6f2a578-e765-4972-ab85-5e56f09c9af7",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-28T04:47:19.015642"
      },
      {
        "user_id": "8d5d95d5-f534-4942-b8d5-0cf9ae45dc00",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-02T06:03:30.015642"
      },
      {
        "user_id": "873218d9-5eb8-45bb-9bca-8e1d1ecdc5b8",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-10T22:08:51.015642"
      },
      {
        "user_id": "697b7729-5a9e-4c71-9f6d-51ce65f668e2",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-22T12:25:38.015642"
      },
      {
        "user_id": "11f0e38c-3aed-4a88-b0db-cf9596c0efac",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-29T17:12:01.015642"
      },
      {
        "user_id": "079ca55d-7763-4c55-9a7a-828f15f73ee1",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-10T09:58:43.015642"
      },
      {
        "user_id": "31fc37e9-f8a6-4315-ad71-e72d7bb92e23",
        "signup_at": "2025-11-01T09:00:00.015642",
        "first_purchase_time": "2025-11-20T11:01:38.015642"
      },
      {
        "user_id": "7eb8dc84-c403-4d41-b623-048e31f43186",
        "signup_at": "2025-11-02T09:00:00.015642",
        "first_purchase_time": "2025-11-19T01:01:16.015642"
      },
      {
        "user_id": "785dc436-a033-481a-bad2-07685835d6f9",
        "signup_at": "2025-11-02T09:00:00.015642",
        "first_purchase_time": "2025-11-11T14:14:14.015642"
      },
      {
        "user_id": "3d231b66-ab22-45af-b968-587fff608632",
        "signup_at": "2025-11-02T09:00:00.015642",
        "first_purchase_time": "2025-11-07T23:11:16.015642"
      },
      {
        "user_id": "4f52c250-a2d3-4bcb-b22b-ef1079b588fc",
        "signup_at": "2025-11-02T09:00:00.015642",
        "first_purchase_time": "2025-11-19T08:29:17.015642"
      },
      {
        "user_id": "9c644fcd-41b3-46f0-bc34-4d0e6bf06d1f",
        "signup_at": "2025-11-02T09:00:00.015642",
        "first_purchase_time": "2025-11-15T02:16:11.015642"
      },
      {
        "user_id": "32ad89ee-289e-4f1a-84b7-a5f440c5bc0a",
        "signup_at": "2025-11-02T09:00:00.015642",
        "first_purchase_time": "2025-11-19T19:26:32.015642"
      },
      {
        "user_id": "3e10c359-9fe5-4b50-83bb-f07f67c2ea4b",
        "signup_at": "2025-11-03T09:00:00.015642",
        "first_purchase_time": "2025-11-15T20:54:27.015642"
      },
      {
        "user_id": "21854c3d-6995-4de1-b3f7-944a0cb5e756",
        "signup_at": "2025-11-03T09:00:00.015642",
        "first_purchase_time": "2025-11-12T13:03:11.015642"
      },
      {
        "user_id": "0c8fb8fd-0130-420f-bfb1-d1fd34abac71",
        "signup_at": "2025-11-03T09:00:00.015642",
        "first_purchase_time": "2025-11-09T15:36:08.015642"
      },
      {
        "user_id": "c26eca3b-36ae-4dc4-8a27-64f916fb32ce",
        "signup_at": "2025-11-03T09:00:00.015642",
        "first_purchase_time": "2025-11-10T04:09:15.015642"
      },
      {
        "user_id": "a1c58964-16ba-4be2-a9f7-7097fecf8081",
        "signup_at": "2025-11-04T09:00:00.015642",
        "first_purchase_time": "2025-11-21T19:43:23.015642"
      },
      {
        "user_id": "ab6bb970-6d29-4f74-8ac7-727277dbc345",
        "signup_at": "2025-11-04T09:00:00.015642",
        "first_purchase_time": "2025-11-21T22:11:27.015642"
      },
      {
        "user_id": "6ceaca16-1334-40fc-bd74-dce1b89281cc",
        "signup_at": "2025-11-04T09:00:00.015642",
        "first_purchase_time": "2025-11-26T14:32:34.015642"
      },
      {
        "user_id": "9c6ec32d-1f50-4cc2-9854-83d92f877af2",
        "signup_at": "2025-11-05T09:00:00.015642",
        "first_purchase_time": "2025-11-19T09:34:40.015642"
      },
      {
        "user_id": "a7028701-50fa-4bea-89fe-89149981f593",
        "signup_at": "2025-11-05T09:00:00.015642",
        "first_purchase_time": "2025-12-01T12:03:39.015642"
      },
      {
        "user_id": "0271a664-d996-4d76-a96b-f92f1f0a99e9",
        "signup_at": "2025-11-05T09:00:00.015642",
        "first_purchase_time": "2025-11-17T15:44:30.015642"
      },
      {
        "user_id": "44cbfa9f-7d28-450c-8bb2-78d017294a7b",
        "signup_at": "2025-11-06T09:00:00.015642",
        "first_purchase_time": "2025-12-04T09:20:01.015642"
      },
      {
        "user_id": "0e4851d3-23ac-4781-8c68-b3576d492fa4",
        "signup_at": "2025-11-06T09:00:00.015642",
        "first_purchase_time": "2025-11-11T04:59:53.015642"
      },
      {
        "user_id": "315827df-feff-4f10-ba55-628e8ff71302",
        "signup_at": "2025-11-06T09:00:00.015642",
        "first_purchase_time": "2025-11-10T21:30:28.015642"
      },
      {
        "user_id": "1f88e560-8db3-47a2-becc-8073c279dc78",
        "signup_at": "2025-11-06T09:00:00.015642",
        "first_purchase_time": "2025-11-25T07:40:49.015642"
      },
      {
        "user_id": "211f43a1-7f79-40e9-83bc-64b9c4fe913f",
        "signup_at": "2025-11-06T09:00:00.015642",
        "first_purchase_time": "2025-11-06T13:24:07.015642"
      },
      {
        "user_id": "bed3046e-781d-4a35-abba-17d04f9ded85",
        "signup_at": "2025-11-06T09:00:00.015642",
        "first_purchase_time": "2025-11-16T00:31:26.015642"
      },
      {
        "user_id": "e9e532a6-eb5c-465a-a90a-acdc438e9437",
        "signup_at": "2025-11-07T09:00:00.015642",
        "first_purchase_time": "2025-11-30T00:01:30.015642"
      },
      {
        "user_id": "664768b3-3243-410e-9ecf-e3ba285e6ce9",
        "signup_at": "2025-11-07T09:00:00.015642",
        "first_purchase_time": "2025-11-14T08:05:07.015642"
      },
      {
        "user_id": "15373b21-f32a-48ac-85e4-3cd1708a9cd1",
        "signup_at": "2025-11-07T09:00:00.015642",
        "first_purchase_time": "2025-11-08T21:54:56.015642"
      },
      {
        "user_id": "436406b6-e440-40b5-ae40-5e6bf05e6d5a",
        "signup_at": "2025-11-08T09:00:00.015642",
        "first_purchase_time": "2025-11-14T05:48:41.015642"
      },
      {
        "user_id": "d60071dd-fe85-4679-926f-c6c2ebc8ceb7",
        "signup_at": "2025-11-08T09:00:00.015642",
        "first_purchase_time": "2025-11-29T01:56:56.015642"
      },
      {
        "user_id": "1dff71a5-e87e-418c-8981-bdad080c09eb",
        "signup_at": "2025-11-08T09:00:00.015642",
        "first_purchase_time": "2025-11-27T08:04:55.015642"
      },
      {
        "user_id": "523a47d1-a88f-4ec0-b11d-e24c18d52b59",
        "signup_at": "2025-11-09T09:00:00.015642",
        "first_purchase_time": "2025-11-20T04:43:04.015642"
      },
      {
        "user_id": "779945a5-9cc6-46c5-86b1-aaa29387852a",
        "signup_at": "2025-11-09T09:00:00.015642",
        "first_purchase_time": "2025-11-18T11:36:04.015642"
      },
      {
        "user_id": "1bac9aec-b24c-4e1b-a590-d1739d697e7a",
        "signup_at": "2025-11-09T09:00:00.015642",
        "first_purchase_time": "2025-11-11T13:15:51.015642"
      },
      {
        "user_id": "3a202d4e-9474-490d-942a-87c7aa1d648c",
        "signup_at": "2025-11-09T09:00:00.015642",
        "first_purchase_time": "2025-11-28T23:39:32.015642"
      },
      {
        "user_id": "66b0f2e5-806c-4b6e-a28e-245942b5feda",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-11-17T12:14:17.015642"
      },
      {
        "user_id": "30f3ac2d-6b35-4595-8e1d-f1528089be0d",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-12-05T09:28:26.015642"
      },
      {
        "user_id": "41d56966-c036-4a54-9f9d-3b8459a078b2",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-11-15T06:36:35.015642"
      },
      {
        "user_id": "0a116a00-ac00-44e0-9d30-d64e82b36d81",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-11-28T10:14:53.015642"
      },
      {
        "user_id": "9c30e1f7-d7c6-432b-8e48-f7abc6c4d6d2",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-11-16T01:33:31.015642"
      },
      {
        "user_id": "b96989f1-83b8-4331-bac3-62b59dd506b2",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-11-28T14:57:26.015642"
      },
      {
        "user_id": "ad3d48c6-5cf6-49f3-a791-f7c2f21c8102",
        "signup_at": "2025-11-10T09:00:00.015642",
        "first_purchase_time": "2025-11-17T16:17:27.015642"
      },
      {
        "user_id": "670fcb2c-46cf-49fd-a9d6-86f6684d7d92",
        "signup_at": "2025-11-11T09:00:00.015642",
        "first_purchase_time": "2025-12-08T15:03:01.015642"
      },
      {
        "user_id": "83c46f81-c303-4cbe-a696-83d54212c826",
        "signup_at": "2025-11-11T09:00:00.015642",
        "first_purchase_time": "2025-11-16T13:10:25.015642"
      },
      {
        "user_id": "219b0db8-3f9b-42b8-86f7-6af94dd40ff8",
        "signup_at": "2025-11-11T09:00:00.015642",
        "first_purchase_time": "2025-11-29T10:40:43.015642"
      },
      {
        "user_id": "e9cc69c2-a06e-416d-b6af-d7c2f021be74",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-12-01T16:26:16.015642"
      },
      {
        "user_id": "57e63c71-c261-4932-b4a2-c5c3d14c4588",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-11-26T00:05:16.015642"
      },
      {
        "user_id": "351caaf5-6501-418a-a639-2f229c08cb68",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-11-23T06:34:25.015642"
      },
      {
        "user_id": "10806d63-ca15-44f7-9f8c-3804b86e78d4",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-12-08T22:56:29.015642"
      },
      {
        "user_id": "a59d92dc-a624-4f3e-80d8-8090dec846ac",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-11-15T07:34:04.015642"
      },
      {
        "user_id": "6d513ccf-8b49-4cfb-90c9-d46ed5d7573e",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-11-24T13:06:10.015642"
      },
      {
        "user_id": "401985dd-376f-4b22-bf99-26c65ed87be9",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-11-14T01:39:32.015642"
      },
      {
        "user_id": "c0942225-32d3-4a1e-b219-bfe8d0ce4aa0",
        "signup_at": "2025-11-12T09:00:00.015642",
        "first_purchase_time": "2025-11-20T13:25:02.015642"
      },
      {
        "user_id": "15e05199-7962-46c1-94e8-1989e866d703",
        "signup_at": "2025-11-13T09:00:00.015642",
        "first_purchase_time": "2025-11-17T04:46:05.015642"
      },
      {
        "user_id": "6c3a20b0-be66-4a10-887d-eabb962d0494",
        "signup_at": "2025-11-13T09:00:00.015642",
        "first_purchase_time": "2025-11-30T03:40:48.015642"
      },
      {
        "user_id": "c3d184f6-7465-480e-bcd7-e0b49232d9f5",
        "signup_at": "2025-11-13T09:00:00.015642",
        "first_purchase_time": "2025-12-01T13:37:25.015642"
      },
      {
        "user_id": "98679f2b-edf1-4062-81ca-84159a776ce8",
        "signup_at": "2025-11-13T09:00:00.015642",
        "first_purchase_time": "2025-12-06T13:22:00.015642"
      },
      {
        "user_id": "8e5b7891-2d3f-4f89-ab6c-41478a430eba",
        "signup_at": "2025-11-14T09:00:00.015642",
        "first_purchase_time": "2025-11-20T18:44:22.015642"
      },
      {
        "user_id": "b110fd9c-5eea-4e25-bb21-c48b24d3a0cf",
        "signup_at": "2025-11-14T09:00:00.015642",
        "first_purchase_time": "2025-11-20T09:52:19.015642"
      },
      {
        "user_id": "f1b80e3b-511b-4e69-87f5-fca73262aa1b",
        "signup_at": "2025-11-15T09:00:00.015642",
        "first_purchase_time": "2025-11-25T19:59:41.015642"
      },
      {
        "user_id": "f752219b-82e6-45f4-9619-18f48e08c853",
        "signup_at": "2025-11-15T09:00:00.015642",
        "first_purchase_time": "2025-12-14T00:01:10.015642"
      },
      {
        "user_id": "5225b00e-da92-4cbf-8593-b81531d55a15",
        "signup_at": "2025-11-15T09:00:00.015642",
        "first_purchase_time": "2025-12-02T22:15:25.015642"
      },
      {
        "user_id": "3ccd52f8-1772-455d-a512-9dc3f89869a0",
        "signup_at": "2025-11-15T09:00:00.015642",
        "first_purchase_time": "2025-11-18T15:42:48.015642"
      },
      {
        "user_id": "211d6068-8215-4431-8442-71588f6ab383",
        "signup_at": "2025-11-15T09:00:00.015642",
        "first_purchase_time": "2025-11-16T22:35:45.015642"
      },
      {
        "user_id": "1f58f3b8-2f52-411a-bed6-7d6e9baf6dfd",
        "signup_at": "2025-11-15T09:00:00.015642",
        "first_purchase_time": "2025-12-15T13:08:11.015642"
      },
      {
        "user_id": "3dc9e904-4463-4c3c-8aa0-d5738acc3654",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-11T16:51:52.015642"
      },
      {
        "user_id": "28505c33-baf4-420b-881e-db123801e95a",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-02T10:11:08.015642"
      },
      {
        "user_id": "1a2b8348-6acd-438a-b8ef-a1e8584b7f70",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-11-18T21:45:20.015642"
      },
      {
        "user_id": "8678bad3-6aa8-418b-9fbc-796edc336c30",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-05T19:46:38.015642"
      },
      {
        "user_id": "640bac6a-c406-406d-9d41-e89766a9f573",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-03T21:27:06.015642"
      },
      {
        "user_id": "93b48a84-e0db-4fa5-8cbf-b19e1c6d1a95",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-11-21T18:00:27.015642"
      },
      {
        "user_id": "e5c604cb-8429-4753-8dd2-84cf9dae4096",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-06T03:57:29.015642"
      },
      {
        "user_id": "e331cab1-fc74-4618-a924-5c3ad27bece4",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-01T09:46:10.015642"
      },
      {
        "user_id": "96505d67-ad7e-4536-a3e4-5e9055accd38",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-13T21:57:49.015642"
      },
      {
        "user_id": "8286bb5f-4c14-4dc4-aa88-3b2079d36dce",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-16T02:18:21.015642"
      },
      {
        "user_id": "0f8b80d2-5584-49f1-9748-0bea80d49f0d",
        "signup_at": "2025-11-16T09:00:00.015642",
        "first_purchase_time": "2025-12-13T00:27:04.015642"
      },
      {
        "user_id": "1effdfeb-514f-4ed6-bfd8-d6374c6f7bc3",
        "signup_at": "2025-11-17T09:00:00.015642",
        "first_purchase_time": "2025-12-17T13:26:43.015642"
      },
      {
        "user_id": "c34ece9e-f752-4dfd-b51b-f00a955fbbe2",
        "signup_at": "2025-11-17T09:00:00.015642",
        "first_purchase_time": "2025-11-21T07:03:12.015642"
      },
      {
        "user_id": "7519e3b7-d9e9-4964-a700-888aa35180d3",
        "signup_at": "2025-11-17T09:00:00.015642",
        "first_purchase_time": "2025-12-17T17:17:48.015642"
      },
      {
        "user_id": "ed6597e9-fea4-42b1-8fd6-9ec2ceb8308c",
        "signup_at": "2025-11-17T09:00:00.015642",
        "first_purchase_time": "2025-12-17T03:00:30.015642"
      },
      {
        "user_id": "97d888dc-4494-415b-97bb-6513420caf2f",
        "signup_at": "2025-11-17T09:00:00.015642",
        "first_purchase_time": "2025-12-11T04:31:53.015642"
      },
      {
        "user_id": "b4553415-6ea7-4d22-a280-4ae808ba5e6d",
        "signup_at": "2025-11-17T09:00:00.015642",
        "first_purchase_time": "2025-11-19T10:03:40.015642"
      },
      {
        "user_id": "63f95ede-0973-454e-ae00-a5e213a33349",
        "signup_at": "2025-11-18T09:00:00.015642",
        "first_purchase_time": "2025-11-29T01:13:13.015642"
      },
      {
        "user_id": "5d8e52b2-0d91-4502-9356-c6c65cb00c87",
        "signup_at": "2025-11-18T09:00:00.015642",
        "first_purchase_time": "2025-12-06T03:14:52.015642"
      },
      {
        "user_id": "6d7e280e-f3a4-44c5-949a-d14f89bc4fd3",
        "signup_at": "2025-11-18T09:00:00.015642",
        "first_purchase_time": "2025-11-19T14:02:46.015642"
      },
      {
        "user_id": "dfe64c11-6373-4dab-a1f8-d477ccc247f3",
        "signup_at": "2025-11-18T09:00:00.015642",
        "first_purchase_time": "2025-12-14T15:39:14.015642"
      },
      {
        "user_id": "7d30b2b1-4eda-4ca6-9906-64d00ee04517",
        "signup_at": "2025-11-19T09:00:00.015642",
        "first_purchase_time": "2025-12-11T19:47:19.015642"
      },
      {
        "user_id": "05a5b046-816c-4ce5-8883-0dd6fe6cc818",
        "signup_at": "2025-11-19T09:00:00.015642",
        "first_purchase_time": "2025-11-28T15:19:06.015642"
      },
      {
        "user_id": "cb9ee949-0bab-4540-aaa1-8ebb3c7c70cb",
        "signup_at": "2025-11-19T09:00:00.015642",
        "first_purchase_time": "2025-12-19T14:33:07.015642"
      },
      {
        "user_id": "23ef61a9-b8e8-4da0-a79e-2bad43c22bad",
        "signup_at": "2025-11-20T09:00:00.015642",
        "first_purchase_time": "2025-12-20T03:49:19.015642"
      },
      {
        "user_id": "8d22de26-d658-4cc9-b65d-f26078cf29d9",
        "signup_at": "2025-11-20T09:00:00.015642",
        "first_purchase_time": "2025-11-26T06:45:39.015642"
      },
      {
        "user_id": "5ba175b2-9500-46e4-bbee-9c6455ba99ce",
        "signup_at": "2025-11-20T09:00:00.015642",
        "first_purchase_time": "2025-11-25T15:20:48.015642"
      },
      {
        "user_id": "b121699a-8ea3-451d-b635-9c2a5418bf0a",
        "signup_at": "2025-11-20T09:00:00.015642",
        "first_purchase_time": "2025-12-18T10:05:04.015642"
      },
      {
        "user_id": "cadf252d-8454-4983-a270-51d675e83301",
        "signup_at": "2025-11-21T09:00:00.015642",
        "first_purchase_time": "2025-12-21T09:53:20.015642"
      },
      {
        "user_id": "f604aabe-916c-45da-8637-bcf248c06d1b",
        "signup_at": "2025-11-22T09:00:00.015642",
        "first_purchase_time": "2025-12-04T08:04:01.015642"
      },
      {
        "user_id": "6a949bc9-f1b2-40ee-8763-62f9ddc2b316",
        "signup_at": "2025-11-22T09:00:00.015642",
        "first_purchase_time": "2025-12-02T17:10:22.015642"
      },
      {
        "user_id": "d6333714-b5b5-4cae-8a22-1f5fdab5624b",
        "signup_at": "2025-11-22T09:00:00.015642",
        "first_purchase_time": "2025-12-04T06:07:28.015642"
      },
      {
        "user_id": "bfc6b130-78c8-4101-9adf-70a16334baef",
        "signup_at": "2025-11-22T09:00:00.015642",
        "first_purchase_time": "2025-12-04T17:53:43.015642"
      },
      {
        "user_id": "cf599aea-19b6-461a-ba28-6a490db11ffc",
        "signup_at": "2025-11-23T09:00:00.015642",
        "first_purchase_time": "2025-12-22T14:46:34.015642"
      },
      {
        "user_id": "021e1864-ebf7-41d7-8033-3aa0a6558010",
        "signup_at": "2025-11-23T09:00:00.015642",
        "first_purchase_time": "2025-11-25T00:53:45.015642"
      },
      {
        "user_id": "f273008e-71d0-4b01-baa5-20d61e81c866",
        "signup_at": "2025-11-24T09:00:00.015642",
        "first_purchase_time": "2025-12-01T08:18:14.015642"
      },
      {
        "user_id": "ff88d5ed-6cd4-4382-8787-de80f59b1d1c",
        "signup_at": "2025-11-24T09:00:00.015642",
        "first_purchase_time": "2025-12-16T06:01:34.015642"
      },
      {
        "user_id": "52977e1c-525e-4640-851d-ec91e8446ba4",
        "signup_at": "2025-11-24T09:00:00.015642",
        "first_purchase_time": "2025-12-17T22:06:10.015642"
      },
      {
        "user_id": "c28fc184-5a2e-4e75-a2d8-04d2ce74ef92",
        "signup_at": "2025-11-24T09:00:00.015642",
        "first_purchase_time": "2025-11-26T15:38:32.015642"
      },
      {
        "user_id": "93239c71-f558-42b1-8147-cfef5720a2a3",
        "signup_at": "2025-11-25T09:00:00.015642",
        "first_purchase_time": "2025-11-27T08:30:55.015642"
      },
      {
        "user_id": "e0a30cd9-33fa-49bd-b7e4-23841ffc43ff",
        "signup_at": "2025-11-25T09:00:00.015642",
        "first_purchase_time": "2025-12-09T14:56:58.015642"
      },
      {
        "user_id": "07eb1013-663d-48f8-92a8-c110c1b30953",
        "signup_at": "2025-11-25T09:00:00.015642",
        "first_purchase_time": "2025-12-22T23:22:57.015642"
      },
      {
        "user_id": "b0c5dfe9-8f0a-4233-abf2-7a9b4d4be195",
        "signup_at": "2025-11-25T09:00:00.015642",
        "first_purchase_time": "2025-12-26T06:05:35.015642"
      },
      {
        "user_id": "974c8620-aca5-44c6-88d1-d1c0be31980b",
        "signup_at": "2025-11-26T09:00:00.015642",
        "first_purchase_time": "2025-12-19T05:21:37.015642"
      },
      {
        "user_id": "cecc2a22-fc50-4601-9b1c-167f022403d3",
        "signup_at": "2025-11-26T09:00:00.015642",
        "first_purchase_time": "2025-12-18T06:34:03.015642"
      },
      {
        "user_id": "4dc85b60-e519-4828-ac9d-618fa197ec20",
        "signup_at": "2025-11-26T09:00:00.015642",
        "first_purchase_time": "2025-12-25T13:37:09.015642"
      },
      {
        "user_id": "f774aba4-02a5-49db-b3f2-571f600fbf1b",
        "signup_at": "2025-11-26T09:00:00.015642",
        "first_purchase_time": "2025-12-26T21:20:35.015642"
      },
      {
        "user_id": "69de2823-c810-46ea-810a-71109ec00485",
        "signup_at": "2025-11-26T09:00:00.015642",
        "first_purchase_time": "2025-12-21T03:20:10.015642"
      },
      {
        "user_id": "85533456-18aa-4356-bdaf-dd137022133f",
        "signup_at": "2025-11-27T09:00:00.015642",
        "first_purchase_time": "2025-12-05T10:13:06.015642"
      },
      {
        "user_id": "4220a456-103d-4fc0-b715-d39fe0ac865a",
        "signup_at": "2025-11-27T09:00:00.015642",
        "first_purchase_time": "2025-11-30T18:32:48.015642"
      },
      {
        "user_id": "cb16c507-ca6e-42b3-bf82-a17495b51b81",
        "signup_at": "2025-11-27T09:00:00.015642",
        "first_purchase_time": "2025-12-27T13:00:42.015642"
      },
      {
        "user_id": "7cba3d50-c1ee-4bd8-8e83-07bb6199126f",
        "signup_at": "2025-11-27T09:00:00.015642",
        "first_purchase_time": "2025-12-16T10:19:35.015642"
      },
      {
        "user_id": "9bbcca60-478d-4242-bca7-b9959a80d0ef",
        "signup_at": "2025-11-27T09:00:00.015642",
        "first_purchase_time": "2025-12-15T11:16:18.015642"
      },
      {
        "user_id": "e4548879-884c-4a2b-913d-41d78f81d908",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-14T13:14:12.015642"
      },
      {
        "user_id": "068d195a-d9ef-4a30-9a89-ea254a04c4e8",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-04T16:34:31.015642"
      },
      {
        "user_id": "5315aa64-90c4-41ec-a011-d835fc8e1ee2",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-03T00:02:59.015642"
      },
      {
        "user_id": "4606cf74-c609-4b96-b65f-78665626966e",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-29T07:53:52.015642"
      },
      {
        "user_id": "8369be9a-a172-4f77-ab4d-2d5c054330bb",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-04T01:56:25.015642"
      },
      {
        "user_id": "b0a4a0ef-c259-4c06-b56b-fb4eae3ede35",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-16T10:37:27.015642"
      },
      {
        "user_id": "9fec4351-5e16-4019-a183-5beb39bd3be6",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-05T02:58:05.015642"
      },
      {
        "user_id": "79f93a6a-09ff-43c8-a1d9-25b706f97621",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-15T01:55:27.015642"
      },
      {
        "user_id": "f098b609-21de-4144-ad92-d1398a996be9",
        "signup_at": "2025-11-28T09:00:00.015642",
        "first_purchase_time": "2025-12-18T11:50:38.015642"
      },
      {
        "user_id": "273da467-e4b7-46d1-b571-810405dbc161",
        "signup_at": "2025-11-29T09:00:00.015642",
        "first_purchase_time": "2025-12-26T21:21:25.015642"
      },
      {
        "user_id": "a80b28b9-0db1-4ce9-965d-3f6854b959c5",
        "signup_at": "2025-11-29T09:00:00.015642",
        "first_purchase_time": "2025-12-02T14:39:30.015642"
      },
      {
        "user_id": "14bf5bda-09f2-46ad-bb97-65584976c637",
        "signup_at": "2025-11-30T09:00:00.015642",
        "first_purchase_time": "2025-12-04T17:51:40.015642"
      },
      {
        "user_id": "8878b67d-553f-4bfe-95c6-3d45cf4775da",
        "signup_at": "2025-11-30T09:00:00.015642",
        "first_purchase_time": "2025-12-12T00:53:49.015642"
      },
      {
        "user_id": "62c642a2-3718-4ea1-b531-1302d0e3ba77",
        "signup_at": "2025-11-30T09:00:00.015642",
        "first_purchase_time": "2025-12-10T02:07:23.015642"
      },
      {
        "user_id": "0479700b-369c-4b2b-acbe-15a4bd832104",
        "signup_at": "2025-12-01T09:00:00.015642",
        "first_purchase_time": "2025-12-23T18:40:32.015642"
      },
      {
        "user_id": "453052bc-a8f5-41d0-924c-918b580fb751",
        "signup_at": "2025-12-01T09:00:00.015642",
        "first_purchase_time": "2025-12-12T14:42:43.015642"
      },
      {
        "user_id": "54707e14-a18a-472f-a7a1-94496d91587b",
        "signup_at": "2025-12-01T09:00:00.015642",
        "first_purchase_time": "2025-12-12T19:29:54.015642"
      },
      {
        "user_id": "182b35b4-5827-4962-89d7-6d742fdd258f",
        "signup_at": "2025-12-01T09:00:00.015642",
        "first_purchase_time": "2025-12-24T08:43:38.015642"
      },
      {
        "user_id": "b4bb75f4-9cd8-4e74-aadd-f680ee56c994",
        "signup_at": "2025-12-02T09:00:00.015642",
        "first_purchase_time": "2025-12-30T14:28:05.015642"
      },
      {
        "user_id": "ea64e08d-f8a3-4e5f-afa7-670ef60db2ee",
        "signup_at": "2025-12-02T09:00:00.015642",
        "first_purchase_time": "2025-12-21T20:25:39.015642"
      },
      {
        "user_id": "d76a7058-2ed4-4fef-bb33-f38b63f3bfb8",
        "signup_at": "2025-12-02T09:00:00.015642",
        "first_purchase_time": "2025-12-12T07:25:23.015642"
      },
      {
        "user_id": "2ca7466d-df95-4228-bd69-fde423145f79",
        "signup_at": "2025-12-02T09:00:00.015642",
        "first_purchase_time": "2025-12-10T00:15:36.015642"
      },
      {
        "user_id": "438eee6e-5c35-4fd7-a892-9a3ca88ba2c2",
        "signup_at": "2025-12-02T09:00:00.015642",
        "first_purchase_time": "2025-12-07T06:49:00.015642"
      },
      {
        "user_id": "11b1977f-006b-4fb3-a0d8-a54ab67b69c4",
        "signup_at": "2025-12-02T09:00:00.015642",
        "first_purchase_time": "2025-12-03T22:49:09.015642"
      },
      {
        "user_id": "9969f340-9ae4-4c37-a5fd-d52d2c026b1d",
        "signup_at": "2025-12-03T09:00:00.015642",
        "first_purchase_time": "2025-12-25T19:53:33.015642"
      },
      {
        "user_id": "b3112b63-2511-49b7-a16a-3e4c7a026721",
        "signup_at": "2025-12-03T09:00:00.015642",
        "first_purchase_time": "2026-01-03T02:02:39.015642"
      },
      {
        "user_id": "7ad741a6-ab75-4a05-8757-5dac3265fe7e",
        "signup_at": "2025-12-03T09:00:00.015642",
        "first_purchase_time": "2025-12-15T18:59:40.015642"
      },
      {
        "user_id": "0196307e-2d34-4691-a69b-462c06740f42",
        "signup_at": "2025-12-03T09:00:00.015642",
        "first_purchase_time": "2025-12-03T17:39:06.015642"
      },
      {
        "user_id": "78d37c09-c033-4d84-b274-c5aec03c41d7",
        "signup_at": "2025-12-03T09:00:00.015642",
        "first_purchase_time": "2025-12-30T14:37:41.015642"
      },
      {
        "user_id": "9b6da4a4-adfc-4abd-8c7f-5814e8f0ef33",
        "signup_at": "2025-12-03T09:00:00.015642",
        "first_purchase_time": "2025-12-17T18:31:37.015642"
      },
      {
        "user_id": "81e19954-a4f9-40e2-a098-5a792318ff43",
        "signup_at": "2025-12-04T09:00:00.015642",
        "first_purchase_time": "2025-12-24T21:22:47.015642"
      },
      {
        "user_id": "96f2f689-cd15-4554-bffb-6051af71f22a",
        "signup_at": "2025-12-04T09:00:00.015642",
        "first_purchase_time": "2025-12-13T03:18:14.015642"
      },
      {
        "user_id": "90b2ad9a-4ee3-45ed-988d-3de3f4a56fd4",
        "signup_at": "2025-12-04T09:00:00.015642",
        "first_purchase_time": "2025-12-17T01:49:08.015642"
      },
      {
        "user_id": "472c851c-5057-42bb-8048-3ed4b182e614",
        "signup_at": "2025-12-04T09:00:00.015642",
        "first_purchase_time": "2025-12-26T00:35:06.015642"
      },
      {
        "user_id": "3a0b1c7d-bd5e-4ad2-849c-ea0b48349072",
        "signup_at": "2025-12-04T09:00:00.015642",
        "first_purchase_time": "2025-12-18T09:00:20.015642"
      },
      {
        "user_id": "e6611f18-b45a-4a1f-a012-d021dea57177",
        "signup_at": "2025-12-04T09:00:00.015642",
        "first_purchase_time": "2025-12-22T01:31:38.015642"
      },
      {
        "user_id": "93fdb3c3-5774-4a04-8a52-b59163cee25a",
        "signup_at": "2025-12-05T09:00:00.015642",
        "first_purchase_time": "2026-01-04T10:43:36.015642"
      },
      {
        "user_id": "a2940375-0342-485e-9c52-c3aad0e8ec1b",
        "signup_at": "2025-12-05T09:00:00.015642",
        "first_purchase_time": "2025-12-10T01:30:39.015642"
      },
      {
        "user_id": "7b623c0c-3eae-4791-b410-db11d5b21076",
        "signup_at": "2025-12-05T09:00:00.015642",
        "first_purchase_time": "2025-12-07T15:16:49.015642"
      },
      {
        "user_id": "7370fc14-bd96-4991-8c11-32824cd87892",
        "signup_at": "2025-12-05T09:00:00.015642",
        "first_purchase_time": "2025-12-23T14:37:00.015642"
      },
      {
        "user_id": "6f54cdaf-545d-4702-847f-91e5c2aef3a9",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-08T12:33:44.015642"
      },
      {
        "user_id": "832e7ed0-d324-4661-9649-76d41b8db9db",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-12T09:34:17.015642"
      },
      {
        "user_id": "43afa838-8bcd-4cf4-903d-db3c6a6cd56e",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-31T12:21:07.015642"
      },
      {
        "user_id": "37dd91eb-5e39-4868-b8dd-3e4424791320",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-15T03:21:30.015642"
      },
      {
        "user_id": "27a886c3-f68c-4db4-8712-eb29bfb89943",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-09T07:02:28.015642"
      },
      {
        "user_id": "2e815159-7c54-4db3-9dbe-eb5d66a0db22",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-07T23:42:05.015642"
      },
      {
        "user_id": "513f613d-883b-4354-850a-0c79983d1e14",
        "signup_at": "2025-12-06T09:00:00.015642",
        "first_purchase_time": "2025-12-20T21:43:13.015642"
      },
      {
        "user_id": "d0eb3b21-a208-41a3-b5ce-6561358f7326",
        "signup_at": "2025-12-07T09:00:00.015642",
        "first_purchase_time": "2025-12-19T23:00:18.015642"
      },
      {
        "user_id": "471f1ec9-8fd4-49f0-8b9c-37c32375a956",
        "signup_at": "2025-12-07T09:00:00.015642",
        "first_purchase_time": "2025-12-28T23:12:18.015642"
      },
      {
        "user_id": "965b9161-b1ad-444b-8dcd-304042f3ed85",
        "signup_at": "2025-12-07T09:00:00.015642",
        "first_purchase_time": "2025-12-22T10:44:52.015642"
      },
      {
        "user_id": "722b712b-ecf1-4157-bbbc-8148b7937fed",
        "signup_at": "2025-12-07T09:00:00.015642",
        "first_purchase_time": "2025-12-25T08:30:40.015642"
      },
      {
        "user_id": "4c67d60d-0834-4695-9e55-5f613f0c1861",
        "signup_at": "2025-12-07T09:00:00.015642",
        "first_purchase_time": "2025-12-28T07:04:43.015642"
      },
      {
        "user_id": "a24dc7ee-dfc6-4cd0-80a8-771f02d65b40",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2025-12-12T00:31:50.015642"
      },
      {
        "user_id": "9c52a0a3-8911-4819-9e06-512e55ff35d0",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2025-12-27T10:02:57.015642"
      },
      {
        "user_id": "6e2fe3e7-f366-42fe-9c3e-40d341cb90ea",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2026-01-05T07:53:12.015642"
      },
      {
        "user_id": "d5e831b1-13f5-4a77-9f9f-4697e35cccec",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2025-12-25T17:48:20.015642"
      },
      {
        "user_id": "ad6898a4-0411-4dbc-a901-47cbea9e76f0",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2025-12-26T21:02:34.015642"
      },
      {
        "user_id": "1f377ad0-5898-4c4b-add8-79eef9f5bb8c",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2025-12-27T03:25:08.015642"
      },
      {
        "user_id": "d58afdc8-6992-4855-94a8-67ad5356bf90",
        "signup_at": "2025-12-08T09:00:00.015642",
        "first_purchase_time": "2025-12-19T15:12:26.015642"
      },
      {
        "user_id": "f407e8ef-1bf8-4e04-b270-0ad21f9599d6",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2025-12-17T20:16:41.015642"
      },
      {
        "user_id": "fd6aaec6-9f11-4aae-bfcb-601b2893030d",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2025-12-24T03:07:01.015642"
      },
      {
        "user_id": "5267d3fa-d06b-4a1e-b65e-f0949bd0f9f4",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2026-01-07T03:03:19.015642"
      },
      {
        "user_id": "be28e712-f779-46bc-8b9e-92dc421c0edb",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2025-12-13T01:08:10.015642"
      },
      {
        "user_id": "3e14b519-e16c-468d-88c8-d446127e3c7d",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2026-01-09T03:00:27.015642"
      },
      {
        "user_id": "f948b323-e53f-4a9a-9b3a-4a099d24f670",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2025-12-31T18:08:06.015642"
      },
      {
        "user_id": "cd373770-4168-4203-91f6-22324016bc10",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2025-12-31T02:26:34.015642"
      },
      {
        "user_id": "3720aacb-220a-415f-b29d-f636d21fbf45",
        "signup_at": "2025-12-09T09:00:00.015642",
        "first_purchase_time": "2025-12-26T10:21:56.015642"
      },
      {
        "user_id": "e35e4d8a-b6ba-45b6-9de8-dfa93b5e43f3",
        "signup_at": "2025-12-10T09:00:00.015642",
        "first_purchase_time": "2026-01-05T00:03:50.015642"
      },
      {
        "user_id": "bf7ce372-ac79-42c5-8596-6c8b0562ccb4",
        "signup_at": "2025-12-10T09:00:00.015642",
        "first_purchase_time": "2026-01-05T12:08:18.015642"
      },
      {
        "user_id": "354ac3f6-b00e-4408-a51f-016c178716fe",
        "signup_at": "2025-12-10T09:00:00.015642",
        "first_purchase_time": "2025-12-15T20:04:11.015642"
      },
      {
        "user_id": "e291e8a4-786d-4c6a-8427-c4ff4865d69f",
        "signup_at": "2025-12-10T09:00:00.015642",
        "first_purchase_time": "2025-12-23T20:52:13.015642"
      },
      {
        "user_id": "1096807b-b5c3-4237-9e99-d44fa463299b",
        "signup_at": "2025-12-10T09:00:00.015642",
        "first_purchase_time": "2025-12-22T10:02:42.015642"
      },
      {
        "user_id": "3d397169-ab40-4870-8a86-04aaf08589f0",
        "signup_at": "2025-12-11T09:00:00.015642",
        "first_purchase_time": "2025-12-25T00:27:20.015642"
      },
      {
        "user_id": "a3f901ce-e846-4f8f-8b0d-c48211524f51",
        "signup_at": "2025-12-11T09:00:00.015642",
        "first_purchase_time": "2025-12-29T23:09:42.015642"
      },
      {
        "user_id": "d662d9fa-d8d2-4a45-b104-1b5b42716620",
        "signup_at": "2025-12-11T09:00:00.015642",
        "first_purchase_time": "2025-12-13T04:13:37.015642"
      },
      {
        "user_id": "6db57c10-f963-45cd-8592-7ddb290c1ad8",
        "signup_at": "2025-12-11T09:00:00.015642",
        "first_purchase_time": "2025-12-24T11:29:29.015642"
      },
      {
        "user_id": "ef016fa8-d3da-47e0-878f-6ebdee6b5494",
        "signup_at": "2025-12-11T09:00:00.015642",
        "first_purchase_time": "2026-01-06T15:13:49.015642"
      },
      {
        "user_id": "7e18907c-1b40-4f2d-a3c2-77d8eeb9f12f",
        "signup_at": "2025-12-12T09:00:00.015642",
        "first_purchase_time": "2026-01-03T23:33:43.015642"
      },
      {
        "user_id": "00b6a190-c156-4782-b409-c2e309c499a9",
        "signup_at": "2025-12-12T09:00:00.015642",
        "first_purchase_time": "2026-01-03T08:16:11.015642"
      },
      {
        "user_id": "347deffc-0112-4e90-a42a-d793ab95fe7a",
        "signup_at": "2025-12-12T09:00:00.015642",
        "first_purchase_time": "2025-12-29T03:10:10.015642"
      },
      {
        "user_id": "4b72e76b-1c08-4925-886d-e6b4a7f30ee8",
        "signup_at": "2025-12-12T09:00:00.015642",
        "first_purchase_time": "2026-01-05T05:53:40.015642"
      },
      {
        "user_id": "d2ac36af-0fb1-4b46-9a90-1a3381d98f14",
        "signup_at": "2025-12-12T09:00:00.015642",
        "first_purchase_time": "2025-12-20T03:22:21.015642"
      },
      {
        "user_id": "a575da48-9bcf-4704-8c60-68a1e7dfd2e4",
        "signup_at": "2025-12-13T09:00:00.015642",
        "first_purchase_time": "2025-12-24T18:56:57.015642"
      },
      {
        "user_id": "5f898978-8f18-419b-88dd-363f13d287da",
        "signup_at": "2025-12-13T09:00:00.015642",
        "first_purchase_time": "2025-12-16T05:35:56.015642"
      },
      {
        "user_id": "76b74589-00db-4e3a-ac0a-5dd5046154fc",
        "signup_at": "2025-12-13T09:00:00.015642",
        "first_purchase_time": "2026-01-02T20:16:10.015642"
      },
      {
        "user_id": "50d2fedc-a1e4-4305-8f43-393cd45fb51c",
        "signup_at": "2025-12-13T09:00:00.015642",
        "first_purchase_time": "2026-01-12T00:56:41.015642"
      },
      {
        "user_id": "66b0ea12-54b2-4dfb-834d-9a4462aa2e94",
        "signup_at": "2025-12-14T09:00:00.015642",
        "first_purchase_time": "2026-01-05T02:46:32.015642"
      },
      {
        "user_id": "8bf63a8a-1a3c-45ec-a82b-440355eb39c2",
        "signup_at": "2025-12-14T09:00:00.015642",
        "first_purchase_time": "2026-01-10T08:23:32.015642"
      },
      {
        "user_id": "c5878766-d4c5-48e4-8c15-eacb75146f36",
        "signup_at": "2025-12-14T09:00:00.015642",
        "first_purchase_time": "2025-12-28T06:01:52.015642"
      },
      {
        "user_id": "8187ab45-bb05-4c72-8309-3467a6315f46",
        "signup_at": "2025-12-15T09:00:00.015642",
        "first_purchase_time": "2025-12-26T08:38:08.015642"
      },
      {
        "user_id": "a469c229-2543-4a09-ad2f-421985fbea73",
        "signup_at": "2025-12-15T09:00:00.015642",
        "first_purchase_time": "2026-01-12T14:20:43.015642"
      },
      {
        "user_id": "f3a3bb79-96ef-46da-96e9-5649ba7988ea",
        "signup_at": "2025-12-15T09:00:00.015642",
        "first_purchase_time": "2026-01-06T06:47:39.015642"
      },
      {
        "user_id": "453f9df5-7b33-4d0d-8dde-d169f5544d12",
        "signup_at": "2025-12-15T09:00:00.015642",
        "first_purchase_time": "2025-12-26T02:05:30.015642"
      },
      {
        "user_id": "3d489996-a453-4e67-bfec-3569bce6f683",
        "signup_at": "2025-12-16T09:00:00.015642",
        "first_purchase_time": "2025-12-27T04:34:10.015642"
      },
      {
        "user_id": "4e07ad25-3b6b-4fc7-94f4-4348c9b7d1d7",
        "signup_at": "2025-12-16T09:00:00.015642",
        "first_purchase_time": "2025-12-26T21:32:10.015642"
      },
      {
        "user_id": "d32bbfb3-e50b-49df-ab01-5cfef6f3783c",
        "signup_at": "2025-12-16T09:00:00.015642",
        "first_purchase_time": "2025-12-27T14:28:13.015642"
      },
      {
        "user_id": "92e3e25a-4ee7-4043-bde1-813fb8b8022c",
        "signup_at": "2025-12-16T09:00:00.015642",
        "first_purchase_time": "2026-01-16T03:38:46.015642"
      },
      {
        "user_id": "c0b50974-912d-450e-8a72-566d8b68aece",
        "signup_at": "2025-12-17T09:00:00.015642",
        "first_purchase_time": "2026-01-10T18:50:00.015642"
      },
      {
        "user_id": "04e855a3-103a-410a-9110-106ff3358cbc",
        "signup_at": "2025-12-17T09:00:00.015642",
        "first_purchase_time": "2026-01-09T19:13:25.015642"
      },
      {
        "user_id": "b1b8990a-3fcf-4d3c-a782-b4ef0d0aca0c",
        "signup_at": "2025-12-17T09:00:00.015642",
        "first_purchase_time": "2026-01-07T11:21:09.015642"
      },
      {
        "user_id": "a553f9db-912c-402e-a1e8-e84fc3800d16",
        "signup_at": "2025-12-18T09:00:00.015642",
        "first_purchase_time": "2025-12-29T11:22:29.015642"
      },
      {
        "user_id": "77141d7a-359e-412a-a83f-ffceaf7e15c2",
        "signup_at": "2025-12-19T09:00:00.015642",
        "first_purchase_time": "2026-01-03T07:01:10.015642"
      },
      {
        "user_id": "fa6e205b-fa9b-49ff-8f64-2661712d52a9",
        "signup_at": "2025-12-20T09:00:00.015642",
        "first_purchase_time": "2026-01-09T13:48:34.015642"
      },
      {
        "user_id": "c30b50d2-fce3-44f8-bb6b-50b09a9f7e93",
        "signup_at": "2025-12-20T09:00:00.015642",
        "first_purchase_time": "2026-01-15T01:32:11.015642"
      },
      {
        "user_id": "666954fd-a594-44f0-ae5d-184340728d5c",
        "signup_at": "2025-12-20T09:00:00.015642",
        "first_purchase_time": "2025-12-29T20:12:41.015642"
      },
      {
        "user_id": "ee3729f2-b6df-42f4-80a4-2e640a62d186",
        "signup_at": "2025-12-20T09:00:00.015642",
        "first_purchase_time": "2025-12-30T03:00:27.015642"
      },
      {
        "user_id": "082183b3-e9b2-41a5-a3b0-54e7f12a5147",
        "signup_at": "2025-12-20T09:00:00.015642",
        "first_purchase_time": "2026-01-16T14:52:11.015642"
      },
      {
        "user_id": "74dcb2fc-f6e4-4a9d-958d-54e185331be9",
        "signup_at": "2025-12-20T09:00:00.015642",
        "first_purchase_time": "2026-01-15T11:40:43.015642"
      },
      {
        "user_id": "2ae64955-2006-41a9-9c2f-52a7cc384779",
        "signup_at": "2025-12-21T09:00:00.015642",
        "first_purchase_time": "2025-12-24T08:08:41.015642"
      },
      {
        "user_id": "502d7d9e-268f-4262-b455-15015cce6f4d",
        "signup_at": "2025-12-21T09:00:00.015642",
        "first_purchase_time": "2025-12-30T22:43:33.015642"
      },
      {
        "user_id": "89085c2b-18de-47b8-8b64-83066229ba56",
        "signup_at": "2025-12-21T09:00:00.015642",
        "first_purchase_time": "2026-01-21T04:21:57.015642"
      },
      {
        "user_id": "597ea12d-7253-4e90-84d8-7957a92540ac",
        "signup_at": "2025-12-21T09:00:00.015642",
        "first_purchase_time": "2026-01-12T21:07:47.015642"
      },
      {
        "user_id": "2eb02250-adfb-4118-b85f-c6fd7e639b23",
        "signup_at": "2025-12-22T09:00:00.015642",
        "first_purchase_time": "2025-12-24T20:04:34.015642"
      },
      {
        "user_id": "e3009393-8bd9-4ac8-8471-8c98612dbd6f",
        "signup_at": "2025-12-22T09:00:00.015642",
        "first_purchase_time": "2025-12-26T05:44:11.015642"
      },
      {
        "user_id": "06d121cf-eb34-405d-8d9e-611a5cd83abf",
        "signup_at": "2025-12-22T09:00:00.015642",
        "first_purchase_time": "2026-01-03T11:23:55.015642"
      },
      {
        "user_id": "1bf13d50-ccd9-4f05-88cb-ce5a96ac91cc",
        "signup_at": "2025-12-22T09:00:00.015642",
        "first_purchase_time": "2026-01-13T08:45:29.015642"
      },
      {
        "user_id": "2109b2f5-6a5b-4b46-919e-e1fe9cf5493f",
        "signup_at": "2025-12-22T09:00:00.015642",
        "first_purchase_time": "2026-01-06T02:55:51.015642"
      },
      {
        "user_id": "d6fa6af3-d227-420d-ac9e-c2a01129ace8",
        "signup_at": "2025-12-23T09:00:00.015642",
        "first_purchase_time": "2026-01-14T01:03:56.015642"
      },
      {
        "user_id": "1d6aa805-ebc0-4a0a-8e3a-6b9f4b02c274",
        "signup_at": "2025-12-23T09:00:00.015642",
        "first_purchase_time": "2026-01-21T19:22:14.015642"
      },
      {
        "user_id": "13c27766-5657-41b5-9dfb-65f9b425ced0",
        "signup_at": "2025-12-23T09:00:00.015642",
        "first_purchase_time": "2026-01-15T21:13:17.015642"
      },
      {
        "user_id": "47290078-a843-403a-9b13-7a3ff2b1e6ce",
        "signup_at": "2025-12-23T09:00:00.015642",
        "first_purchase_time": "2026-01-11T02:15:12.015642"
      },
      {
        "user_id": "281201f9-f5cc-4969-85bb-03e9daf9061b",
        "signup_at": "2025-12-23T09:00:00.015642",
        "first_purchase_time": "2026-01-10T07:52:34.015642"
      },
      {
        "user_id": "4f374763-6e90-44f7-afd5-e824116f14da",
        "signup_at": "2025-12-23T09:00:00.015642",
        "first_purchase_time": "2026-01-08T10:48:34.015642"
      },
      {
        "user_id": "7f79dba6-6ac2-4f9e-b0c6-2318d14d88b4",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2025-12-30T09:06:35.015642"
      },
      {
        "user_id": "40550c94-1916-480d-a2fb-c233d964dcb6",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-14T18:09:39.015642"
      },
      {
        "user_id": "e2a192ed-aa2f-4ba1-a92d-2ec34a834808",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-06T22:04:41.015642"
      },
      {
        "user_id": "e32d39d5-4b35-4235-9934-4fdb08721e78",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-20T04:09:43.015642"
      },
      {
        "user_id": "1ccd1489-46cf-4c23-8274-77ad8a4ce036",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-20T02:10:51.015642"
      },
      {
        "user_id": "049760b8-3081-48cc-8ec2-3044340ae04a",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-08T05:09:10.015642"
      },
      {
        "user_id": "42e688e4-81f0-4f81-955c-ef1fbc1149b3",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-05T23:09:29.015642"
      },
      {
        "user_id": "fc77deba-af14-4c6d-b22b-7afd728f9fe0",
        "signup_at": "2025-12-24T09:00:00.015642",
        "first_purchase_time": "2026-01-21T07:28:52.015642"
      },
      {
        "user_id": "8739e120-bb9e-45a7-ad3d-949d685ddd02",
        "signup_at": "2025-12-25T09:00:00.015642",
        "first_purchase_time": "2026-01-13T09:12:09.015642"
      },
      {
        "user_id": "ed1b2eae-04ab-4c4c-b10f-d509970e3a6d",
        "signup_at": "2025-12-25T09:00:00.015642",
        "first_purchase_time": "2026-01-17T13:51:44.015642"
      },
      {
        "user_id": "c418ee63-d856-4860-80c7-4c2ea9bd5ae2",
        "signup_at": "2025-12-26T09:00:00.015642",
        "first_purchase_time": "2026-01-03T17:43:44.015642"
      },
      {
        "user_id": "ae917bd9-7c8d-4a71-bdc6-77260b0ca347",
        "signup_at": "2025-12-26T09:00:00.015642",
        "first_purchase_time": "2026-01-24T19:44:29.015642"
      },
      {
        "user_id": "24c5e6cc-7bf1-47f5-bac3-3dde336967aa",
        "signup_at": "2025-12-26T09:00:00.015642",
        "first_purchase_time": "2026-01-10T19:29:58.015642"
      },
      {
        "user_id": "c43175d2-f11c-4362-89af-9ed0e4f72fb7",
        "signup_at": "2025-12-26T09:00:00.015642",
        "first_purchase_time": "2026-01-03T11:36:57.015642"
      },
      {
        "user_id": "354cdf89-df58-439a-a0d6-560512e65007",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-04T13:19:11.015642"
      },
      {
        "user_id": "bd464313-622c-422c-8e89-ecceb0b6dc73",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-05T03:55:05.015642"
      },
      {
        "user_id": "d8e293fb-ac6e-4c66-9024-8fa8aa50e3ad",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-02T11:28:17.015642"
      },
      {
        "user_id": "7ac43477-4a80-43bd-bd18-8b3a9e5bb870",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2025-12-28T22:22:43.015642"
      },
      {
        "user_id": "81b5f3b4-f376-4975-bd9e-fe31def29779",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2025-12-29T13:53:16.015642"
      },
      {
        "user_id": "eaf752a2-55f4-4eeb-b6f5-a75469a8160d",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-18T22:10:23.015642"
      },
      {
        "user_id": "8a3644d9-a575-474b-b79e-4c5817e558aa",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-10T07:12:49.015642"
      },
      {
        "user_id": "b8f0b448-73e8-42f7-9006-63733edb9962",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-26T15:30:29.015642"
      },
      {
        "user_id": "92b5888b-df0a-486f-a293-c45eb29fe894",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-25T22:30:14.015642"
      },
      {
        "user_id": "0e3f3be2-56db-4d14-9498-77ae210c4f5c",
        "signup_at": "2025-12-27T09:00:00.015642",
        "first_purchase_time": "2026-01-07T21:38:02.015642"
      },
      {
        "user_id": "a9a074fc-1333-4fcc-bac4-67089bf391fa",
        "signup_at": "2025-12-28T09:00:00.015642",
        "first_purchase_time": "2026-01-04T21:02:13.015642"
      },
      {
        "user_id": "6603f6c2-b783-44fc-a389-3e27f8cb3ddf",
        "signup_at": "2025-12-28T09:00:00.015642",
        "first_purchase_time": "2026-01-22T00:34:04.015642"
      },
      {
        "user_id": "6b6b6455-4433-4142-8e18-9fe1aee9593f",
        "signup_at": "2025-12-28T09:00:00.015642",
        "first_purchase_time": "2026-01-17T06:48:10.015642"
      },
      {
        "user_id": "872ff0d1-2b9c-43ae-ad02-9dd9fb6c5f86",
        "signup_at": "2025-12-28T09:00:00.015642",
        "first_purchase_time": "2026-01-27T12:27:02.015642"
      },
      {
        "user_id": "e3537a49-a766-4bea-b22b-eecee3d4947b",
        "signup_at": "2025-12-29T09:00:00.015642",
        "first_purchase_time": "2026-01-11T05:31:48.015642"
      },
      {
        "user_id": "9c341cc0-03b0-464f-816c-e7e116fe2bad",
        "signup_at": "2025-12-29T09:00:00.015642",
        "first_purchase_time": "2026-01-22T08:06:18.015642"
      },
      {
        "user_id": "fc822fbe-3eda-463f-a7e0-81e1b265623f",
        "signup_at": "2025-12-29T09:00:00.015642",
        "first_purchase_time": "2026-01-27T15:24:02.015642"
      },
      {
        "user_id": "dd7d8c99-2f1e-406c-8aca-1b86f8c4a5c9",
        "signup_at": "2025-12-29T09:00:00.015642",
        "first_purchase_time": "2026-01-03T06:39:37.015642"
      },
      {
        "user_id": "ca6dbc91-0de8-4790-8d19-a23095c1d5bf",
        "signup_at": "2025-12-29T09:00:00.015642",
        "first_purchase_time": "2026-01-18T02:01:16.015642"
      }
    ],
    "expected_row_count": 278
  },
  {
    "problem_id": "2026-01-02_commerce_sql_003_set0",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "PM팀",
    "question": "PM팀입니다. 사용자가 상품을 탐색하는 과정에서 'view_product' 이벤트 발생 후 'add_to_cart' 이벤트까지 얼마나 많은 사용자가 도달하는지, 즉 상품 조회에서 장바구니 담기까지의 전환율을 알고 싶습니다. 2025년 12월 한 달 동안의 데이터를 분석해주세요.",
    "context": "상품 상세 페이지의 매력도와 장바구니 담기 버튼의 효율성을 파악하여 사용자 경험을 개선하고 구매 전환율을 높이기 위한 기초 데이터를 확보하고자 합니다.",
    "submission_requirements": "결과는 전환율(%) 기준으로 내림차순 정렬하며, 소수점 둘째 자리까지 표시해주세요. 'view_product_count', 'add_to_cart_count', 'conversion_rate' 컬럼을 포함해야 합니다.",
    "answer_sql": "WITH EventCounts AS (\n    SELECT\n        COUNT(DISTINCT CASE WHEN event_name = 'view_product' THEN user_id ELSE NULL END) AS view_product_count,\n        COUNT(DISTINCT CASE WHEN event_name = 'add_to_cart' THEN user_id ELSE NULL END) AS add_to_cart_count\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-12-01 00:00:00'\n        AND event_time < '2026-01-01 00:00:00'\n)\nSELECT\n    view_product_count,\n    add_to_cart_count,\n    ROUND(\n        (CAST(add_to_cart_count AS NUMERIC) / NULLIF(view_product_count, 0)) * 100,\n        2\n    ) AS conversion_rate\nFROM\n    EventCounts;",
    "expected_description": "2025년 12월 동안 상품 조회(view_product) 후 장바구니 담기(add_to_cart)로 전환된 사용자의 비율을 보여줍니다. view_product_count는 상품을 조회한 고유 사용자 수, add_to_cart_count는 장바구니에 상품을 담은 고유 사용자 수, conversion_rate는 이 두 단계 간의 전환율(%)입니다.",
    "expected_columns": [
      "view_product_count",
      "add_to_cart_count",
      "conversion_rate"
    ],
    "sort_keys": [
      "conversion_rate"
    ],
    "hint": "pa_events 테이블에서 'view_product'와 'add_to_cart' 이벤트의 고유 사용자 수를 각각 계산하세요. NULLIF 함수를 사용하여 0으로 나누는 경우를 방지하고, CAST를 통해 NUMERIC 타입으로 변환하여 정확한 비율 계산 후 퍼센트로 변환하세요.",
    "date": "2026-01-02",
    "set_index": 0,
    "xp_value": 5,
    "expected_result": [
      {
        "view_product_count": 32042.0,
        "add_to_cart_count": 12781.0,
        "conversion_rate": 39.89
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-02_commerce_sql_004_set0",
    "difficulty": "medium",
    "topic": "retention",
    "requester": "CX팀",
    "question": "CX팀입니다. 장바구니에 상품을 담았지만 구매하지 않고 이탈한 사용자(cart abandonment)의 비율을 파악하고 싶습니다. 'add_to_cart' 이벤트 이후 'purchase' 이벤트가 발생하지 않은 사용자들의 비율을 2025년 11월 1일부터 12월 29일 기간 동안 계산해주세요. 사용자별로 추적하여 정확한 이탈률을 산출해주세요.",
    "context": "장바구니 이탈은 잠재적 매출 손실로 직결되므로, 이탈 규모를 정확히 파악하고 이탈 요인을 분석하는 것은 매우 중요합니다.",
    "submission_requirements": "결과는 cart_abandonment_rate(%) 기준으로 내림차순 정렬하며, 소수점 둘째 자리까지 표시해주세요. 'users_added_to_cart', 'users_purchased', 'cart_abandonment_rate' 컬럼을 포함해야 합니다.",
    "answer_sql": "WITH CartEvents AS (\n    SELECT\n        user_id,\n        MAX(CASE WHEN event_name = 'add_to_cart' THEN 1 ELSE 0 END) AS added_to_cart,\n        MAX(CASE WHEN event_name = 'purchase' THEN 1 ELSE 0 END) AS purchased\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00'\n        AND event_time < '2025-12-30 00:00:00'\n    GROUP BY\n        user_id\n),\nCartAnalysis AS (\n    SELECT\n        COUNT(DISTINCT CASE WHEN added_to_cart = 1 AND purchased = 0 THEN user_id ELSE NULL END) AS users_abandoned_cart,\n        COUNT(DISTINCT CASE WHEN added_to_cart = 1 THEN user_id ELSE NULL END) AS users_added_to_cart,\n        COUNT(DISTINCT CASE WHEN purchased = 1 THEN user_id ELSE NULL END) AS users_purchased\n    FROM\n        CartEvents\n)\nSELECT\n    users_added_to_cart,\n    users_purchased,\n    ROUND(\n        (CAST(users_added_to_cart - users_purchased AS NUMERIC) / NULLIF(users_added_to_cart, 0)) * 100,\n        2\n    ) AS cart_abandonment_rate\nFROM\n    CartAnalysis;",
    "expected_description": "2025년 11월 1일부터 12월 29일 기간 동안 장바구니에 상품을 담았으나 구매하지 않은 사용자 비율입니다. users_added_to_cart는 장바구니에 상품을 담은 고유 사용자 수, users_purchased는 해당 기간 동안 구매한 고유 사용자 수, cart_abandonment_rate는 장바구니 이탈률(%)입니다.",
    "expected_columns": [
      "users_added_to_cart",
      "users_purchased",
      "cart_abandonment_rate"
    ],
    "sort_keys": [
      "cart_abandonment_rate"
    ],
    "hint": "먼저 pa_events 테이블에서 사용자가 장바구니에 상품을 담았는지('add_to_cart')와 구매했는지('purchase') 여부를 사용자별로 집계하세요. 이 데이터를 바탕으로 장바구니에 담았지만 구매하지 않은 사용자를 계산하고, 전체 장바구니 담은 사용자 대비 이탈률을 구하세요. NULLIF를 사용하여 0으로 나누는 경우를 방지하세요.",
    "date": "2026-01-02",
    "set_index": 0,
    "xp_value": 5,
    "expected_result": [
      {
        "users_added_to_cart": 17720.0,
        "users_purchased": 335.0,
        "cart_abandonment_rate": 98.11
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-02_commerce_sql_005_set0",
    "difficulty": "hard",
    "topic": "retention",
    "requester": "그로스팀",
    "question": "그로스팀입니다. 2025년 11월 1일부터 12월 29일 기간 동안 재구매(reorder)가 발생한 사용자를 파악하고, 이들의 첫 구매 이후 재구매까지 걸린 평균 일수를 분석하고 싶습니다. 이를 통해 재구매 촉진 전략 수립에 필요한 인사이트를 얻고자 합니다.",
    "context": "고객 생애 가치(CLV) 증대를 위해 재구매 활성화는 핵심 과제입니다. 재구매까지 소요되는 시간을 파악하면 각 고객 세그먼트별로 맞춤형 재구매 유도 캠페인을 기획하는 데 도움이 됩니다.",
    "submission_requirements": "결과는 평균 재구매 소요일(average_days_to_reorder) 기준으로 오름차순 정렬하며, 소수점 첫째 자리까지 표시해주세요. 'user_id', 'first_purchase_date', 'reorder_date', 'average_days_to_reorder' 컬럼을 포함해야 합니다.",
    "answer_sql": "WITH UserPurchaseDates AS (\n    SELECT\n        user_id,\n        DATE(order_time) AS order_date\n    FROM\n        pa_orders\n    WHERE\n        order_time >= '2025-11-01 00:00:00'\n        AND order_time < '2025-12-30 00:00:00'\n),\nFirstAndReorder AS (\n    SELECT\n        user_id,\n        MIN(order_date) AS first_purchase_date,\n        MAX(order_date) AS reorder_date -- reorder 이벤트보다는 order 테이블의 order_time을 통해 재구매 시점 판단\n    FROM\n        UserPurchaseDates\n    GROUP BY\n        user_id\n    HAVING\n        COUNT(order_date) > 1 -- 최소 두 번 이상 구매한 사용자만 필터링\n)\nSELECT\n    user_id,\n    first_purchase_date,\n    reorder_date,\n    ROUND(CAST(reorder_date - first_purchase_date AS NUMERIC), 1) AS average_days_to_reorder\nFROM\n    FirstAndReorder\nORDER BY\n    average_days_to_reorder ASC;",
    "expected_description": "2025년 11월 1일부터 12월 29일 기간 동안 재구매한 사용자에 대한 정보입니다. user_id는 사용자 고유 ID, first_purchase_date는 해당 사용자의 첫 구매일, reorder_date는 마지막 구매일(재구매 시점으로 간주), average_days_to_reorder는 첫 구매일로부터 마지막 구매일까지 걸린 평균 일수입니다.",
    "expected_columns": [
      "user_id",
      "first_purchase_date",
      "reorder_date",
      "average_days_to_reorder"
    ],
    "sort_keys": [
      "average_days_to_reorder"
    ],
    "hint": "pa_orders 테이블을 사용하여 각 사용자의 모든 구매 날짜를 가져옵니다. 각 사용자별 첫 구매일과 재구매(마지막 구매) 날짜를 찾고, 재구매가 발생한 사용자만 필터링합니다 (최소 2회 이상 구매). 두 날짜 간의 차이를 계산하여 평균 일수를 구하세요. DATE() 함수와 날짜 차이 연산을 활용하세요.",
    "date": "2026-01-02",
    "set_index": 0,
    "xp_value": 8,
    "expected_result": [],
    "expected_row_count": 0
  },
  {
    "problem_id": "2026-01-02_commerce_sql_006_set0",
    "difficulty": "hard",
    "topic": "segmentation",
    "requester": "마케팅팀",
    "question": "마케팅팀입니다. 2025년 12월 15일부터 12월 29일까지 'compare_product' 이벤트를 사용한 사용자들의 국가별 분포 및 각 국가별 평균 주문 금액(AOV)이 궁금합니다. 이 데이터를 통해 특정 국가 사용자의 상품 비교 행동과 구매력을 파악하고 싶습니다.",
    "context": "상품 비교 행동이 구매 전환에 미치는 영향을 분석하고, 국가별로 차별화된 마케팅 전략을 수립하기 위해 해당 사용자 그룹의 구매 패턴을 심층적으로 이해해야 합니다.",
    "submission_requirements": "결과는 AOV 기준으로 내림차순 정렬하며, 소수점 둘째 자리까지 표시해주세요. 'country', 'users_compared', 'average_order_value' 컬럼을 포함해야 합니다.",
    "answer_sql": "WITH CompareUsers AS (\n    SELECT DISTINCT\n        pe.user_id,\n        pu.country\n    FROM\n        pa_events pe\n    JOIN\n        pa_users pu ON pe.user_id = pu.user_id\n    WHERE\n        pe.event_name = 'compare_product'\n        AND pe.event_time >= '2025-12-15 00:00:00'\n        AND pe.event_time < '2025-12-30 00:00:00'\n),\nUserOrders AS (\n    SELECT\n        cu.country,\n        po.user_id,\n        SUM(po.amount) AS total_amount,\n        COUNT(po.order_id) AS order_count\n    FROM\n        CompareUsers cu\n    LEFT JOIN\n        pa_orders po ON cu.user_id = po.user_id\n    WHERE\n        po.order_time >= '2025-12-15 00:00:00'\n        AND po.order_time < '2025-12-30 00:00:00'\n    GROUP BY\n        cu.country,\n        po.user_id\n)\nSELECT\n    country,\n    COUNT(DISTINCT user_id) AS users_compared,\n    CASE \n        WHEN SUM(order_count) = 0 THEN 0.00 -- 주문이 없는 경우 AOV 0으로 처리\n        ELSE ROUND(CAST(SUM(total_amount) AS NUMERIC) / SUM(order_count), 2)\n    END AS average_order_value\nFROM\n    UserOrders\nGROUP BY\n    country\nORDER BY\n    average_order_value DESC;",
    "expected_description": "2025년 12월 15일부터 12월 29일 기간 동안 상품 비교('compare_product') 이벤트를 사용한 사용자들의 국가별 분포 및 평균 주문 금액(AOV)입니다. country는 사용자 국가, users_compared는 해당 국가에서 상품을 비교한 고유 사용자 수, average_order_value는 해당 국가 사용자의 평균 주문 금액입니다.",
    "expected_columns": [
      "country",
      "users_compared",
      "average_order_value"
    ],
    "sort_keys": [
      "average_order_value"
    ],
    "hint": "먼저 pa_events와 pa_users 테이블을 조인하여 'compare_product' 이벤트를 발생시킨 사용자들의 국가를 식별합니다. 그런 다음, 이 사용자들의 주문 기록(pa_orders)을 가져와 국가별로 총 주문 금액과 주문 수를 집계합니다. 마지막으로, 각 국가별로 상품 비교 사용자 수와 평균 주문 금액(AOV)을 계산하고, 주문이 없는 경우 AOV를 0으로 처리하여 0으로 나누는 오류를 방지하세요.",
    "date": "2026-01-02",
    "set_index": 0,
    "xp_value": 8,
    "expected_result": [
      {
        "country": "US",
        "users_compared": 1,
        "average_order_value": 46092.0
      },
      {
        "country": "JP",
        "users_compared": 4,
        "average_order_value": 32601.5
      },
      {
        "country": "IN",
        "users_compared": 3,
        "average_order_value": 31014.33
      },
      {
        "country": "IT",
        "users_compared": 1,
        "average_order_value": 30652.0
      },
      {
        "country": "CA",
        "users_compared": 7,
        "average_order_value": 26827.0
      },
      {
        "country": "DE",
        "users_compared": 7,
        "average_order_value": 26143.57
      },
      {
        "country": "FR",
        "users_compared": 3,
        "average_order_value": 22707.33
      },
      {
        "country": "UK",
        "users_compared": 2,
        "average_order_value": 13930.5
      }
    ],
    "expected_row_count": 8
  }
]