[
  {
    "problem_id": "2026-01-05_stream_sql_001",
    "difficulty": "easy",
    "topic": "revenue",
    "requester": "재무팀",
    "question": "2025년 10월의 일별 매출액과 구매 건수를 알려주세요. 각 날짜별로 집계된 결과가 필요합니다. 결과를 날짜순으로 정렬하여 회신 부탁드립니다.",
    "context": "2025년 10월의 재무 성과를 분석하기 위해 일별 매출 및 구매 데이터를 확인해야 합니다.",
    "submission_requirements": "결과는 date (DATE), revenue (FLOAT), purchases (INT) 컬럼으로 구성되어야 합니다. date 컬럼 기준으로 오름차순 정렬해야 합니다.",
    "answer_sql": "SELECT date, revenue, purchases FROM stream_daily_metrics WHERE date BETWEEN '2025-10-01' AND '2025-10-31' ORDER BY date ASC;",
    "expected_columns": [
      "date",
      "revenue",
      "purchases"
    ],
    "sort_keys": [
      "date"
    ],
    "date": "2026-01-05",
    "data_type": "stream",
    "xp_value": 3,
    "expected_result": [
      {
        "date": "2025-10-01",
        "revenue": 118091.0,
        "purchases": 1159
      },
      {
        "date": "2025-10-02",
        "revenue": 126171.0,
        "purchases": 1265
      },
      {
        "date": "2025-10-03",
        "revenue": 103289.0,
        "purchases": 1015
      },
      {
        "date": "2025-10-04",
        "revenue": 53296.0,
        "purchases": 533
      },
      {
        "date": "2025-10-05",
        "revenue": 61110.0,
        "purchases": 587
      },
      {
        "date": "2025-10-06",
        "revenue": 85584.0,
        "purchases": 821
      },
      {
        "date": "2025-10-07",
        "revenue": 50307.0,
        "purchases": 510
      },
      {
        "date": "2025-10-08",
        "revenue": 46421.0,
        "purchases": 450
      },
      {
        "date": "2025-10-09",
        "revenue": 111900.0,
        "purchases": 1067
      },
      {
        "date": "2025-10-10",
        "revenue": 132885.0,
        "purchases": 1323
      },
      {
        "date": "2025-10-11",
        "revenue": 41557.0,
        "purchases": 405
      },
      {
        "date": "2025-10-12",
        "revenue": 109433.0,
        "purchases": 1049
      },
      {
        "date": "2025-10-13",
        "revenue": 41400.0,
        "purchases": 410
      },
      {
        "date": "2025-10-14",
        "revenue": 101575.0,
        "purchases": 975
      },
      {
        "date": "2025-10-15",
        "revenue": 68991.0,
        "purchases": 695
      },
      {
        "date": "2025-10-16",
        "revenue": 128729.0,
        "purchases": 1263
      },
      {
        "date": "2025-10-17",
        "revenue": 75262.0,
        "purchases": 749
      },
      {
        "date": "2025-10-18",
        "revenue": 138384.0,
        "purchases": 1384
      },
      {
        "date": "2025-10-19",
        "revenue": 140886.0,
        "purchases": 1369
      },
      {
        "date": "2025-10-20",
        "revenue": 75793.0,
        "purchases": 737
      },
      {
        "date": "2025-10-21",
        "revenue": 108133.0,
        "purchases": 1052
      },
      {
        "date": "2025-10-22",
        "revenue": 138579.0,
        "purchases": 1339
      },
      {
        "date": "2025-10-23",
        "revenue": 51044.0,
        "purchases": 507
      },
      {
        "date": "2025-10-24",
        "revenue": 119781.0,
        "purchases": 1165
      },
      {
        "date": "2025-10-25",
        "revenue": 56713.0,
        "purchases": 551
      },
      {
        "date": "2025-10-26",
        "revenue": 36604.0,
        "purchases": 373
      },
      {
        "date": "2025-10-27",
        "revenue": 136132.0,
        "purchases": 1318
      },
      {
        "date": "2025-10-28",
        "revenue": 139772.0,
        "purchases": 1367
      },
      {
        "date": "2025-10-29",
        "revenue": 91080.0,
        "purchases": 881
      },
      {
        "date": "2025-10-30",
        "revenue": 109545.0,
        "purchases": 1101
      },
      {
        "date": "2025-10-31",
        "revenue": 114150.0,
        "purchases": 1120
      }
    ],
    "expected_row_count": 31
  },
  {
    "problem_id": "2026-01-05_stream_sql_002",
    "difficulty": "easy",
    "topic": "channel",
    "requester": "마케팅팀",
    "question": "각 채널별 총 이벤트 발생 건수를 알려주세요. 어떤 채널에서 가장 많은 이벤트가 발생했는지 파악하고 싶습니다. 결과를 이벤트 건수 기준 내림차순으로 정렬하여 주세요.",
    "context": "마케팅 활동의 효과를 채널별로 파악하기 위해 각 채널에서 발생하는 이벤트 수를 집계해야 합니다.",
    "submission_requirements": "결과는 channel (TEXT), event_count (BIGINT) 컬럼으로 구성되어야 합니다. event_count 컬럼 기준으로 내림차순 정렬해야 합니다.",
    "answer_sql": "SELECT channel, COUNT(*) AS event_count FROM stream_events GROUP BY channel ORDER BY event_count DESC;",
    "expected_columns": [
      "channel",
      "event_count"
    ],
    "sort_keys": [
      "event_count"
    ],
    "date": "2026-01-05",
    "data_type": "stream",
    "xp_value": 3,
    "expected_result": [
      {
        "channel": "organic",
        "event_count": 903775
      },
      {
        "channel": "push",
        "event_count": 896116
      },
      {
        "channel": "email",
        "event_count": 891088
      },
      {
        "channel": "ads",
        "event_count": 887909
      }
    ],
    "expected_row_count": 4
  },
  {
    "problem_id": "2026-01-05_stream_sql_003",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "그로스팀",
    "question": "사용자 여정 퍼널 분석을 위해 'view_product'에서 'add_to_cart'로 전환하는 사용자 비율을 계산해주세요. 각 단계별 사용자 수를 파악하고, 전환율을 백분율로 나타내 주세요. 2025년 11월 한 달간의 데이터를 분석 부탁드립니다.",
    "context": "제품 페이지 조회 후 장바구니에 상품을 담는 전환율을 측정하여 마케팅 캠페인 효과를 분석하고 싶습니다.",
    "submission_requirements": "결과는 view_product_users (BIGINT), add_to_cart_users (BIGINT), conversion_rate (DECIMAL) 컬럼으로 구성되어야 합니다. conversion_rate는 소수점 둘째 자리까지 표시되어야 합니다.",
    "answer_sql": "WITH funnel_steps AS (\n  SELECT\n    COUNT(DISTINCT CASE WHEN event_name = 'view_product' THEN user_id ELSE NULL END) AS view_product_users,\n    COUNT(DISTINCT CASE WHEN event_name = 'add_to_cart' THEN user_id ELSE NULL END) AS add_to_cart_users\n  FROM stream_events\n  WHERE event_time::DATE BETWEEN '2025-11-01' AND '2025-11-30'\n)\nSELECT\n  view_product_users,\n  add_to_cart_users,\n  CASE WHEN view_product_users > 0 THEN ROUND((add_to_cart_users::DECIMAL / view_product_users) * 100, 2) ELSE 0 END AS conversion_rate\nFROM funnel_steps;",
    "expected_columns": [
      "view_product_users",
      "add_to_cart_users",
      "conversion_rate"
    ],
    "sort_keys": [],
    "date": "2026-01-05",
    "data_type": "stream",
    "xp_value": 5,
    "expected_result": [
      {
        "view_product_users": 49462.0,
        "add_to_cart_users": 36803.0,
        "conversion_rate": 74.41
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_stream_sql_004",
    "difficulty": "medium",
    "topic": "device",
    "requester": "기획팀",
    "question": "각 디바이스 유형별로 'checkout' 이벤트 발생률을 계산해주세요. 'checkout' 이벤트 발생 건수를 해당 디바이스에서 발생한 총 이벤트 건수로 나누어 계산합니다. 2025년 9월 1일부터 2025년 10월 31일까지의 데이터를 분석해주세요. 결과를 이벤트 발생률이 높은 순서대로 정렬해주세요.",
    "context": "어떤 디바이스에서 결제 전환이 활발하게 일어나는지 파악하여 디바이스별 최적화 전략을 수립하고자 합니다.",
    "submission_requirements": "결과는 device (TEXT), checkout_rate (DECIMAL) 컬럼으로 구성되어야 합니다. checkout_rate는 소수점 넷째 자리까지 표시되어야 하며, 내림차순으로 정렬해야 합니다.",
    "answer_sql": "WITH device_event_counts AS (\n  SELECT\n    device,\n    COUNT(CASE WHEN event_name = 'checkout' THEN 1 ELSE NULL END) AS checkout_events,\n    COUNT(*) AS total_events\n  FROM stream_events\n  WHERE event_time::DATE BETWEEN '2025-09-01' AND '2025-10-31'\n  GROUP BY device\n)\nSELECT\n  device,\n  CASE WHEN total_events > 0 THEN ROUND((checkout_events::DECIMAL / total_events) * 10000, 2) ELSE 0 END AS checkout_rate\nFROM device_event_counts\nORDER BY checkout_rate DESC;",
    "expected_columns": [
      "device",
      "checkout_rate"
    ],
    "sort_keys": [
      "checkout_rate"
    ],
    "date": "2026-01-05",
    "data_type": "stream",
    "xp_value": 5,
    "expected_result": [
      {
        "device": "android",
        "checkout_rate": 723.24
      },
      {
        "device": "web",
        "checkout_rate": 722.47
      },
      {
        "device": "ios",
        "checkout_rate": 719.2
      }
    ],
    "expected_row_count": 3
  },
  {
    "problem_id": "2026-01-05_stream_sql_005",
    "difficulty": "hard",
    "topic": "dau",
    "requester": "운영팀",
    "question": "2025년 11월 한 달 동안의 일별 활성 사용자(DAU) 수를 계산해주세요. DAU는 해당 일에 이벤트를 발생시킨 고유 사용자 수를 의미합니다. 결과를 날짜순으로 정렬하여 제공해주세요.",
    "context": "서비스의 일일 사용자 활동 추이를 파악하여 서비스 안정성 및 사용자 참여도를 모니터링하고자 합니다.",
    "submission_requirements": "결과는 date (DATE), dau (BIGINT) 컬럼으로 구성되어야 합니다. date 컬럼 기준으로 오름차순 정렬해야 합니다.",
    "answer_sql": "SELECT\n  DATE(event_time) AS date,\n  COUNT(DISTINCT user_id) AS dau\nFROM stream_events\nWHERE DATE(event_time) BETWEEN '2025-11-01' AND '2025-11-30'\nGROUP BY DATE(event_time)\nORDER BY date ASC;",
    "expected_columns": [
      "date",
      "dau"
    ],
    "sort_keys": [
      "date"
    ],
    "date": "2026-01-05",
    "data_type": "stream",
    "xp_value": 8,
    "expected_result": [
      {
        "date": "2025-11-01",
        "dau": 10619
      },
      {
        "date": "2025-11-02",
        "dau": 6207
      },
      {
        "date": "2025-11-03",
        "dau": 3807
      },
      {
        "date": "2025-11-04",
        "dau": 10459
      },
      {
        "date": "2025-11-05",
        "dau": 9021
      },
      {
        "date": "2025-11-06",
        "dau": 11020
      },
      {
        "date": "2025-11-07",
        "dau": 6453
      },
      {
        "date": "2025-11-08",
        "dau": 3175
      },
      {
        "date": "2025-11-09",
        "dau": 10968
      },
      {
        "date": "2025-11-10",
        "dau": 3755
      },
      {
        "date": "2025-11-11",
        "dau": 3745
      },
      {
        "date": "2025-11-12",
        "dau": 10873
      },
      {
        "date": "2025-11-13",
        "dau": 4792
      },
      {
        "date": "2025-11-14",
        "dau": 10550
      },
      {
        "date": "2025-11-15",
        "dau": 5608
      },
      {
        "date": "2025-11-16",
        "dau": 7525
      },
      {
        "date": "2025-11-17",
        "dau": 3802
      },
      {
        "date": "2025-11-18",
        "dau": 9332
      },
      {
        "date": "2025-11-19",
        "dau": 5794
      },
      {
        "date": "2025-11-20",
        "dau": 9269
      },
      {
        "date": "2025-11-21",
        "dau": 4878
      },
      {
        "date": "2025-11-22",
        "dau": 5189
      },
      {
        "date": "2025-11-23",
        "dau": 9090
      },
      {
        "date": "2025-11-24",
        "dau": 3492
      },
      {
        "date": "2025-11-25",
        "dau": 7515
      },
      {
        "date": "2025-11-26",
        "dau": 6491
      },
      {
        "date": "2025-11-27",
        "dau": 7922
      },
      {
        "date": "2025-11-28",
        "dau": 4855
      },
      {
        "date": "2025-11-29",
        "dau": 11468
      },
      {
        "date": "2025-11-30",
        "dau": 9368
      }
    ],
    "expected_row_count": 30
  },
  {
    "problem_id": "2026-01-05_stream_sql_006",
    "difficulty": "hard",
    "topic": "funnel",
    "requester": "마케팅팀",
    "question": "최종 구매(purchase)에 도달한 사용자의 이전 행동 패턴을 분석해주세요. 'view_product' -> 'add_to_cart' -> 'checkout' -> 'purchase' 단계를 거친 사용자 수를 각 단계별로 집계하고, 각 단계별 전환율을 계산해주세요. 2025년 7월 1일부터 2025년 7월 31일까지의 데이터를 분석합니다. 각 단계별 전환율은 이전 단계 대비 얼마나 감소했는지 보여주는 값입니다.",
    "context": "사용자가 구매를 완료하기까지의 각 단계별 이탈 지점을 파악하여 퍼널 최적화를 위한 인사이트를 얻고 싶습니다.",
    "submission_requirements": "결과는 view_product_count (BIGINT), add_to_cart_count (BIGINT), checkout_count (BIGINT), purchase_count (BIGINT), view_to_add_rate (DECIMAL), add_to_checkout_rate (DECIMAL), checkout_to_purchase_rate (DECIMAL) 컬럼으로 구성되어야 합니다. 전환율은 소수점 둘째 자리까지 표시되어야 합니다. 별도의 정렬 기준은 없습니다.",
    "answer_sql": "WITH funnel_counts AS (\n    SELECT\n        COUNT(DISTINCT CASE WHEN event_name = 'view_product' THEN user_id ELSE NULL END) AS view_product_count,\n        COUNT(DISTINCT CASE WHEN event_name = 'add_to_cart' THEN user_id ELSE NULL END) AS add_to_cart_count,\n        COUNT(DISTINCT CASE WHEN event_name = 'checkout' THEN user_id ELSE NULL END) AS checkout_count,\n        COUNT(DISTINCT CASE WHEN event_name = 'purchase' THEN user_id ELSE NULL END) AS purchase_count\n    FROM stream_events\n    WHERE event_time::DATE BETWEEN '2025-07-01' AND '2025-07-31'\n)\nSELECT\n    view_product_count,\n    add_to_cart_count,\n    checkout_count,\n    purchase_count,\n    CASE WHEN view_product_count > 0 THEN ROUND((add_to_cart_count::DECIMAL / view_product_count) * 100, 2) ELSE 0 END AS view_to_add_rate,\n    CASE WHEN add_to_cart_count > 0 THEN ROUND((checkout_count::DECIMAL / add_to_cart_count) * 100, 2) ELSE 0 END AS add_to_checkout_rate,\n    CASE WHEN checkout_count > 0 THEN ROUND((purchase_count::DECIMAL / checkout_count) * 100, 2) ELSE 0 END AS checkout_to_purchase_rate\nFROM funnel_counts;",
    "expected_columns": [
      "view_product_count",
      "add_to_cart_count",
      "checkout_count",
      "purchase_count",
      "view_to_add_rate",
      "add_to_checkout_rate",
      "checkout_to_purchase_rate"
    ],
    "sort_keys": [],
    "date": "2026-01-05",
    "data_type": "stream",
    "xp_value": 8,
    "expected_result": [
      {
        "view_product_count": 49310.0,
        "add_to_cart_count": 36194.0,
        "checkout_count": 26476.0,
        "purchase_count": 24312.0,
        "view_to_add_rate": 73.4,
        "add_to_checkout_rate": 73.15,
        "checkout_to_purchase_rate": 91.83
      }
    ],
    "expected_row_count": 1
  }
]