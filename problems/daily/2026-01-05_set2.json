[
  {
    "problem_id": "2026-01-05_commerce_sql_001_set2",
    "difficulty": "easy",
    "topic": "revenue",
    "requester": "경영진",
    "question": "2025년 11월, 일별 총 매출(GMV)과 평균 주문 금액(AOV)을 알고 싶습니다. 결과를 날짜 기준으로 오름차순 정렬해주세요.",
    "context": "월별 매출 추이를 파악하고, 특정 시점의 성과를 측정하기 위해 필요합니다.",
    "submission_requirements": "결과는 'order_date' (일자) 와 'daily_gmv' (일별 총 매출), 'daily_aov' (일별 평균 주문 금액) 컬럼을 포함해야 하며, 'order_date' 기준으로 오름차순 정렬해야 합니다. 'daily_gmv'와 'daily_aov'는 소수점 둘째 자리까지 표시해주세요.",
    "answer_sql": "SELECT\n    DATE(order_time) AS order_date,\n    SUM(amount) AS daily_gmv,\n    AVG(amount) AS daily_aov\nFROM\n    pa_orders\nWHERE\n    order_time >= '2025-11-01 00:00:00' AND order_time < '2025-12-01 00:00:00'\nGROUP BY\n    order_date\nORDER BY\n    order_date ASC;",
    "expected_description": "각 날짜별로 총 거래액(GMV)과 해당 날짜의 평균 주문 금액(AOV)을 보여주는 테이블입니다.",
    "expected_columns": [
      "order_date",
      "daily_gmv",
      "daily_aov"
    ],
    "sort_keys": [
      "order_date"
    ],
    "hint": "pa_orders 테이블의 order_time을 DATE 함수로 변환하여 날짜별로 그룹화하고, SUM 함수와 AVG 함수를 사용하여 매출과 평균 주문 금액을 계산하세요. 날짜 범위는 '2025-11-01'부터 '2025-11-30'까지입니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 3,
    "expected_result": [
      {
        "order_date": "2025-11-02",
        "daily_gmv": 23895,
        "daily_aov": 11947.5
      },
      {
        "order_date": "2025-11-06",
        "daily_gmv": 29312,
        "daily_aov": 29312.0
      },
      {
        "order_date": "2025-11-07",
        "daily_gmv": 4801,
        "daily_aov": 4801.0
      },
      {
        "order_date": "2025-11-08",
        "daily_gmv": 23180,
        "daily_aov": 23180.0
      },
      {
        "order_date": "2025-11-09",
        "daily_gmv": 46953,
        "daily_aov": 46953.0
      },
      {
        "order_date": "2025-11-10",
        "daily_gmv": 36151,
        "daily_aov": 9037.75
      },
      {
        "order_date": "2025-11-11",
        "daily_gmv": 131380,
        "daily_aov": 32845.0
      },
      {
        "order_date": "2025-11-12",
        "daily_gmv": 38796,
        "daily_aov": 19398.0
      },
      {
        "order_date": "2025-11-14",
        "daily_gmv": 98388,
        "daily_aov": 32796.0
      },
      {
        "order_date": "2025-11-15",
        "daily_gmv": 97416,
        "daily_aov": 24354.0
      },
      {
        "order_date": "2025-11-16",
        "daily_gmv": 112573,
        "daily_aov": 28143.25
      },
      {
        "order_date": "2025-11-17",
        "daily_gmv": 120816,
        "daily_aov": 30204.0
      },
      {
        "order_date": "2025-11-18",
        "daily_gmv": 118209,
        "daily_aov": 29552.25
      },
      {
        "order_date": "2025-11-19",
        "daily_gmv": 123498,
        "daily_aov": 17642.571428571428
      },
      {
        "order_date": "2025-11-20",
        "daily_gmv": 111377,
        "daily_aov": 18562.833333333332
      },
      {
        "order_date": "2025-11-21",
        "daily_gmv": 139618,
        "daily_aov": 34904.5
      },
      {
        "order_date": "2025-11-22",
        "daily_gmv": 29600,
        "daily_aov": 29600.0
      },
      {
        "order_date": "2025-11-23",
        "daily_gmv": 36652,
        "daily_aov": 36652.0
      },
      {
        "order_date": "2025-11-24",
        "daily_gmv": 24801,
        "daily_aov": 24801.0
      },
      {
        "order_date": "2025-11-25",
        "daily_gmv": 84431,
        "daily_aov": 16886.2
      },
      {
        "order_date": "2025-11-26",
        "daily_gmv": 70637,
        "daily_aov": 17659.25
      },
      {
        "order_date": "2025-11-27",
        "daily_gmv": 101513,
        "daily_aov": 25378.25
      },
      {
        "order_date": "2025-11-28",
        "daily_gmv": 165606,
        "daily_aov": 27601.0
      },
      {
        "order_date": "2025-11-29",
        "daily_gmv": 122930,
        "daily_aov": 20488.333333333332
      },
      {
        "order_date": "2025-11-30",
        "daily_gmv": 70829,
        "daily_aov": 23609.666666666668
      }
    ],
    "expected_row_count": 25
  },
  {
    "problem_id": "2026-01-05_commerce_sql_002_set2",
    "difficulty": "easy",
    "topic": "activation",
    "requester": "PM팀",
    "question": "2025년 12월에 가입한 신규 고객 중 첫 구매를 완료한 고객 수를 알려주세요. 결과는 숫자로만 표시해주시면 됩니다.",
    "context": "신규 고객 확보 및 전환율 개선 활동의 성과를 측정하기 위해 필요합니다.",
    "submission_requirements": "결과는 'new_customer_first_purchase_count' 라는 이름의 단일 컬럼으로 반환되어야 합니다. 이 값은 첫 구매를 완료한 신규 고객의 총 수를 나타냅니다.",
    "answer_sql": "WITH new_customers AS (\n    SELECT\n        user_id\n    FROM\n        pa_users\n    WHERE\n        signup_at >= '2025-12-01 00:00:00' AND signup_at < '2026-01-01 00:00:00'\n),\nfirst_purchasers AS (\n    SELECT\n        user_id,\n        MIN(order_time) as first_order_time\n    FROM\n        pa_orders\n    GROUP BY\n        user_id\n)\nSELECT\n    COUNT(DISTINCT nc.user_id)\nFROM\n    new_customers nc\nJOIN\n    first_purchasers fp ON nc.user_id = fp.user_id\nWHERE\n    fp.first_order_time >= nc.signup_at;",
    "expected_description": "2025년 12월에 가입하고 첫 구매를 완료한 신규 고객의 총 수를 보여줍니다.",
    "expected_columns": [
      "new_customer_first_purchase_count"
    ],
    "sort_keys": [],
    "hint": "먼저 12월에 가입한 고객 목록(new_customers)과 모든 고객의 첫 구매 시점(first_purchasers)을 분리하세요. 이후 두 목록을 조인하여 신규 고객이면서 첫 구매 시점이 가입 시점 이후인 고객의 수를 계산합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 3,
    "expected_result": [],
    "expected_row_count": 0
  },
  {
    "problem_id": "2026-01-05_commerce_sql_003_set2",
    "difficulty": "medium",
    "topic": "funnel",
    "requester": "PM팀",
    "question": "2025년 11월, 'view_product' 이벤트 이후 'add_to_cart' 이벤트로 전환한 고객의 수와 'add_to_cart' 이후 'purchase' 이벤트로 전환한 고객 수를 각각 알려주세요. 또한, 각 단계별 전환율을 계산해주세요. 결과는 'view_product_to_add_to_cart_rate' 와 'add_to_cart_to_purchase_rate' 컬럼으로 표시하고, 이 값들은 소수점 셋째 자리까지 반올림해주세요.",
    "context": "주요 구매 퍼널 단계에서의 고객 행동을 이해하고, 이탈 지점을 파악하여 개선하기 위해 필요합니다.",
    "submission_requirements": "결과는 'view_product_count', 'add_to_cart_count', 'purchase_count', 'view_product_to_add_to_cart_rate', 'add_to_cart_to_purchase_rate' 컬럼을 포함해야 합니다. 전환율은 각 단계의 이벤트 수를 기준으로 계산하며, 소수점 셋째 자리까지 반올림하여 표시해주세요. 전체 결과는 단일 행으로 반환되어야 합니다.",
    "answer_sql": "WITH event_counts AS (\n    SELECT\n        SUM(CASE WHEN event_name = 'view_product' THEN 1 ELSE 0 END) AS view_product_cnt,\n        SUM(CASE WHEN event_name = 'add_to_cart' THEN 1 ELSE 0 END) AS add_to_cart_cnt,\n        SUM(CASE WHEN event_name = 'purchase' THEN 1 ELSE 0 END) AS purchase_cnt\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n),\n\n-- 'view_product' 이후 'add_to_cart' 전환을 명확히 하기 위해 각 사용자의 마지막 'view_product'와 첫 'add_to_cart' 시점을 파악합니다.\n-- 여기서는 간단하게 각 이벤트 수를 세고 전환율을 계산하는 방식으로 접근합니다. (주의: 더 정확한 퍼널은 사용자별 세션 및 순서 분석 필요)\n\n-- 더 정확한 사용자별 퍼널 분석을 위한 CTE (실제로는 좀 더 복잡한 로직 필요)\n-- 이 문제에서는 편의상 단순 이벤트 수 기반으로 접근합니다.\n\nuser_event_sequence AS (\n    SELECT\n        user_id,\n        event_time,\n        event_name,\n        ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY event_time) as rn\n    FROM\n        pa_events\n    WHERE\n        event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n        AND event_name IN ('view_product', 'add_to_cart', 'purchase')\n),\n\nview_to_cart AS (\n    SELECT\n        COUNT(DISTINCT vp.user_id) AS view_to_cart_user_count\n    FROM\n        user_event_sequence vp\n    JOIN\n        user_event_sequence atc ON vp.user_id = atc.user_id\n    WHERE\n        vp.event_name = 'view_product'\n        AND atc.event_name = 'add_to_cart'\n        AND atc.event_time > vp.event_time\n        AND vp.rn < atc.rn -- view_product가 add_to_cart보다 먼저 발생했음을 보장\n),\n\ncart_to_purchase AS (\n    SELECT\n        COUNT(DISTINCT atc.user_id) AS cart_to_purchase_user_count\n    FROM\n        user_event_sequence atc\n    JOIN\n        user_event_sequence pur ON atc.user_id = pur.user_id\n    WHERE\n        atc.event_name = 'add_to_cart'\n        AND pur.event_name = 'purchase'\n        AND pur.event_time > atc.event_time\n        AND atc.rn < pur.rn -- add_to_cart가 purchase보다 먼저 발생했음을 보장\n)\n\nSELECT\n    ec.view_product_cnt AS view_product_count,\n    ec.add_to_cart_cnt AS add_to_cart_count,\n    ec.purchase_cnt AS purchase_count,\n    ROUND(CASE WHEN ec.view_product_cnt = 0 THEN 0 ELSE CAST(vtc.view_to_cart_user_count AS NUMERIC) / ec.view_product_cnt END, 3) AS view_product_to_add_to_cart_rate,\n    ROUND(CASE WHEN ec.add_to_cart_cnt = 0 THEN 0 ELSE CAST(ctp.cart_to_purchase_user_count AS NUMERIC) / ec.add_to_cart_cnt END, 3) AS add_to_cart_to_purchase_rate\nFROM\n    event_counts ec,\n    view_to_cart vtc,\n    cart_to_purchase ctp;",
    "expected_description": "2025년 11월의 'view_product', 'add_to_cart', 'purchase' 이벤트 수를 보여주고, 'view_product'에서 'add_to_cart'로의 전환율과 'add_to_cart'에서 'purchase'로의 전환율을 계산하여 표시합니다.",
    "expected_columns": [
      "view_product_count",
      "add_to_cart_count",
      "purchase_count",
      "view_product_to_add_to_cart_rate",
      "add_to_cart_to_purchase_rate"
    ],
    "sort_keys": [],
    "hint": "각 이벤트의 총 수를 먼저 집계합니다. 정확한 사용자별 퍼널 전환을 위해, 사용자의 이벤트 순서를 파악하는 CTE를 생성하고, 이후 join을 통해 'view_product' 이후 'add_to_cart'로 전환한 사용자 수와 'add_to_cart' 이후 'purchase'로 전환한 사용자 수를 계산합니다. NULLIF 또는 CASE 문을 사용하여 0으로 나누는 오류를 방지하고, ROUND 함수를 사용하여 소수점 셋째 자리까지 반올림합니다. (주의: 이 문제는 사용자별 이벤트 순서가 복잡한 경우 더 정교한 분석이 필요합니다. 여기서는 제공된 스키마와 이벤트 정보로 최대한 구현합니다.)",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 5,
    "expected_result": [
      {
        "view_product_count": 77860.0,
        "add_to_cart_count": 8181.0,
        "purchase_count": 127.0,
        "view_product_to_add_to_cart_rate": 0.087,
        "add_to_cart_to_purchase_rate": 0.016
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_004_set2",
    "difficulty": "medium",
    "topic": "retention",
    "requester": "그로스팀",
    "question": "2025년 11월에 첫 구매를 한 고객 중, 2025년 12월에 다시 구매(reorder)한 고객의 비율을 계산해주세요. 재구매율은 소수점 셋째 자리까지 표시해주세요.",
    "context": "고객 유지 및 충성도 향상 전략의 효과를 측정하기 위해 필요합니다.",
    "submission_requirements": "결과는 'repeat_purchase_rate'라는 단일 컬럼으로 반환되어야 합니다. 이 값은 첫 구매 후 재구매한 고객의 비율을 나타내며, 소수점 셋째 자리까지 표시됩니다. (예: 0.150)",
    "answer_sql": "WITH first_purchasers AS (\n    SELECT\n        user_id,\n        MIN(order_time) AS first_order_time\n    FROM\n        pa_orders\n    WHERE\n        order_time >= '2025-11-01 00:00:00' AND order_time < '2025-12-01 00:00:00'\n    GROUP BY\n        user_id\n),\n\nrepeat_purchasers AS (\n    SELECT\n        o.user_id\n    FROM\n        pa_orders o\n    JOIN\n        first_purchasers fp ON o.user_id = fp.user_id\n    WHERE\n        o.order_time >= '2025-12-01 00:00:00' AND o.order_time < '2026-01-01 00:00:00'\n        AND o.order_time > fp.first_order_time -- 재구매 시점이 첫 구매 시점보다 나중이어야 함\n    GROUP BY\n        o.user_id\n)\n\nSELECT\n    ROUND(CAST(COUNT(rp.user_id) AS NUMERIC) / COUNT(fp.user_id), 3) AS repeat_purchase_rate\nFROM\n    first_purchasers fp\nLEFT JOIN\n    repeat_purchasers rp ON fp.user_id = rp.user_id;",
    "expected_description": "2025년 11월에 첫 구매를 한 고객 중, 2025년 12월에 다시 구매한 고객의 비율을 보여줍니다.",
    "expected_columns": [
      "repeat_purchase_rate"
    ],
    "sort_keys": [],
    "hint": "먼저 11월에 첫 구매를 한 고객 목록을 추출합니다. 그 다음, 12월에 발생한 주문 중 11월 첫 구매 고객이면서, 첫 구매 시점보다 나중에 구매한 경우를 찾아 재구매 고객으로 집계합니다. 최종적으로 첫 구매 고객 수 대비 재구매 고객 수의 비율을 계산하고 소수점 셋째 자리까지 반올림합니다. LEFT JOIN을 사용하여 첫 구매 고객 중 재구매 고객이 없는 경우도 포함합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 5,
    "expected_result": [
      {
        "repeat_purchase_rate": 0.0
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_005_set2",
    "difficulty": "hard",
    "topic": "funnel",
    "requester": "CX팀",
    "question": "2025년 11월, 'add_to_cart' 이벤트 이후 7일 이내에 'purchase' 이벤트가 발생하지 않은 고객의 비율(장바구니 이탈률)을 계산해주세요. 이탈 고객의 총 수와 전체 'add_to_cart' 이벤트 수를 함께 제공해주세요. 결과는 각 비율을 소수점 넷째 자리까지 표시해주세요.",
    "context": "장바구니 단계에서의 고객 이탈 원인을 파악하고, 이탈률을 개선하기 위한 전략 수립에 활용하고자 합니다.",
    "submission_requirements": "결과는 'total_add_to_cart_events', 'cart_abandonment_count', 'cart_abandonment_rate' 컬럼을 포함해야 합니다. 'cart_abandonment_rate'는 소수점 넷째 자리까지 표시해주세요. 결과는 단일 행으로 반환되어야 합니다.",
    "answer_sql": "WITH cart_events AS (\n    SELECT\n        user_id,\n        session_id,\n        event_time AS add_to_cart_time\n    FROM\n        pa_events\n    WHERE\n        event_name = 'add_to_cart'\n        AND event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n),\n\npurchase_after_cart AS (\n    SELECT DISTINCT\n        ce.user_id,\n        ce.session_id\n    FROM\n        cart_events ce\n    JOIN\n        pa_events pe ON ce.user_id = pe.user_id AND ce.session_id = pe.session_id\n    WHERE\n        pe.event_name = 'purchase'\n        AND pe.event_time BETWEEN ce.add_to_cart_time AND ce.add_to_cart_time + INTERVAL '7 days'\n)\n\nSELECT\n    COUNT(ce.session_id) AS total_add_to_cart_events,\n    COUNT(ce.session_id) - COUNT(pac.session_id) AS cart_abandonment_count,\n    ROUND(CAST(COUNT(ce.session_id) - COUNT(pac.session_id) AS NUMERIC) / COUNT(ce.session_id), 4) AS cart_abandonment_rate\nFROM\n    cart_events ce\nLEFT JOIN\n    purchase_after_cart pac ON ce.user_id = pac.user_id AND ce.session_id = pac.session_id;",
    "expected_description": "2025년 11월의 총 'add_to_cart' 이벤트 수, 7일 이내 구매가 발생하지 않은 장바구니 이탈 이벤트 수, 그리고 장바구니 이탈률을 보여줍니다.",
    "expected_columns": [
      "total_add_to_cart_events",
      "cart_abandonment_count",
      "cart_abandonment_rate"
    ],
    "sort_keys": [],
    "hint": "먼저 11월에 발생한 'add_to_cart' 이벤트 정보를 추출합니다. 이후, 해당 'add_to_cart' 이벤트가 속한 세션에서 7일 이내에 'purchase' 이벤트가 발생했는지 확인하는 CTE를 생성합니다. 마지막으로 'add_to_cart' 이벤트 총 수에서 7일 이내 구매가 발생한 이벤트 수를 제외하여 이탈 수를 계산하고, 이탈률을 계산합니다. LEFT JOIN을 사용하여 'purchase'가 없는 경우에도 'add_to_cart' 이벤트 수를 모두 포함합니다. INTERVAL 함수를 사용하여 날짜 계산을 합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 8,
    "expected_result": [
      {
        "total_add_to_cart_events": 8181.0,
        "cart_abandonment_count": 8054.0,
        "cart_abandonment_rate": 0.9845
      }
    ],
    "expected_row_count": 1
  },
  {
    "problem_id": "2026-01-05_commerce_sql_006_set2",
    "difficulty": "hard",
    "topic": "engagement",
    "requester": "마케팅팀",
    "question": "2025년 11월, 사용자별 'apply_coupon' 이벤트 수와 해당 사용자가 쿠폰 적용 후 실제로 'purchase'까지 전환한 비율을 계산해주세요. 결과는 사용자 ID, 쿠폰 적용 횟수, 그리고 구매 전환율 순서로 보여주며, 전환율이 높은 순으로 정렬해주세요. 전환율은 소수점 셋째 자리까지 반올림해주세요. 2회 이상 쿠폰을 적용한 사용자만 대상으로 합니다.",
    "context": "쿠폰 프로모션의 실제 효과를 파악하고, 구매 전환에 기여하는 고객 그룹을 식별하여 마케팅 효율을 증대시키고자 합니다.",
    "submission_requirements": "결과는 'user_id', 'coupon_apply_count', 'purchase_conversion_rate' 컬럼을 포함해야 하며, 'purchase_conversion_rate' 기준으로 내림차순 정렬해야 합니다. 'coupon_apply_count'는 2회 이상인 사용자만 포함되며, 'purchase_conversion_rate'는 소수점 셋째 자리까지 반올림하여 표시됩니다.",
    "answer_sql": "WITH coupon_applies AS (\n    SELECT\n        user_id,\n        COUNT(event_id) AS apply_count,\n        MIN(event_time) AS first_apply_time\n    FROM\n        pa_events\n    WHERE\n        event_name = 'apply_coupon'\n        AND event_time >= '2025-11-01 00:00:00' AND event_time < '2025-12-01 00:00:00'\n    GROUP BY\n        user_id\n    HAVING\n        COUNT(event_id) >= 2\n),\n\npurchases_after_coupon AS (\n    SELECT DISTINCT\n        pe.user_id\n    FROM\n        pa_events pe\n    JOIN\n        coupon_applies ca ON pe.user_id = ca.user_id\n    WHERE\n        pe.event_name = 'purchase'\n        AND pe.event_time >= ca.first_apply_time -- 쿠폰 적용 이후 구매만 고려\n)\n\nSELECT\n    ca.user_id,\n    ca.apply_count AS coupon_apply_count,\n    ROUND(CAST(COUNT(pac.user_id) AS NUMERIC) / ca.apply_count, 3) AS purchase_conversion_rate\nFROM\n    coupon_applies ca\nLEFT JOIN\n    purchases_after_coupon pac ON ca.user_id = pac.user_id\nGROUP BY\n    ca.user_id,\n    ca.apply_count\nORDER BY\n    purchase_conversion_rate DESC;",
    "expected_description": "2025년 11월에 2회 이상 쿠폰을 적용한 사용자를 대상으로, 사용자별 쿠폰 적용 횟수와 쿠폰 적용 후 구매 전환율을 보여주며, 전환율이 높은 순서대로 정렬됩니다.",
    "expected_columns": [
      "user_id",
      "coupon_apply_count",
      "purchase_conversion_rate"
    ],
    "sort_keys": [
      "purchase_conversion_rate DESC"
    ],
    "hint": "먼저 11월에 'apply_coupon' 이벤트를 2회 이상 발생시킨 사용자들을 집계합니다. 이후, 해당 사용자들의 'purchase' 이벤트 중 쿠폰 적용 시점 이후에 발생한 구매를 식별합니다. 최종적으로 각 사용자별 쿠폰 적용 횟수 대비 구매 전환 횟수의 비율을 계산하고, 전환율이 높은 순으로 정렬합니다. LEFT JOIN을 사용하여 쿠폰 적용 후 구매가 없는 경우도 고려합니다.",
    "date": "2026-01-05",
    "set_index": 2,
    "xp_value": 8,
    "expected_result": [
      {
        "user_id": "148ee165-1941-4e51-be6d-e81974f3175e",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "2dd5b8e4-e09f-4466-a781-65a8c36ae460",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "3578d56f-8874-41e0-bb13-5ac6fed659ff",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "3a69e669-3e62-4481-90d9-e1c1e83ecae0",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "3c7a92a3-164c-4873-898c-5569034df990",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "4e8be79a-b8e3-4609-ba8b-34d137146731",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "582c8b75-22bb-4b69-9e83-9fb376be31a6",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "619f7e89-05b9-471b-be57-52ffbf166476",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "86e06c4f-0d62-4ef8-b528-8fab626c217a",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "8f2078cd-5b7f-4fbe-b870-c78415056ec7",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "a22554d3-2308-45a4-b7ce-08dcad101149",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "a3a8c1bd-e60a-42ed-9c40-c3ce53ea00e6",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "be12c2fe-501d-43bd-8c35-c28c570a17dc",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "be2f1983-8834-4429-bcfe-04e70759cbdb",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "d7c6b185-7b59-4889-aaa2-cc6b487564ca",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "e0333677-1d0f-4a89-8556-7d75f0de92bb",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "e2dd3ffc-c29f-4b10-9c47-3c6f3829942c",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      },
      {
        "user_id": "e37c6ed9-714f-4169-b041-0311065545bd",
        "coupon_apply_count": 2,
        "purchase_conversion_rate": 0.0
      }
    ],
    "expected_row_count": 18
  }
]