# Google Tag Manager (GTM) ë° GA4 ì„¤ì • ê°€ì´ë“œ

> â±ï¸ ì˜ˆìƒ ì†Œìš” ì‹œê°„: ì•½ 20-30ë¶„

ì´ ê°€ì´ë“œì—ì„œëŠ” QueryCraftì— Google Tag Managerë¥¼ í†µí•œ GA4 ë¶„ì„ì„ ì„¤ì •í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ“‹ ëª©ì°¨
1. [GTM ê³„ì • ë° ì»¨í…Œì´ë„ˆ ìƒì„±](#1-gtm-ê³„ì •-ë°-ì»¨í…Œì´ë„ˆ-ìƒì„±)
2. [GA4 ì†ì„± ìƒì„±](#2-ga4-ì†ì„±-ìƒì„±)
3. [GTMì—ì„œ GA4 íƒœê·¸ ì„¤ì •](#3-gtmì—ì„œ-ga4-íƒœê·¸-ì„¤ì •)
4. [ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹ ì„¤ì •](#4-ì»¤ìŠ¤í…€-ì´ë²¤íŠ¸-íŠ¸ë˜í‚¹-ì„¤ì •)
5. [ì½”ë“œì—ì„œ GTM ID ì—…ë°ì´íŠ¸](#5-ì½”ë“œì—ì„œ-gtm-id-ì—…ë°ì´íŠ¸)
6. [í…ŒìŠ¤íŠ¸ ë° ë°°í¬](#6-í…ŒìŠ¤íŠ¸-ë°-ë°°í¬)

---

## 1. GTM ê³„ì • ë° ì»¨í…Œì´ë„ˆ ìƒì„±

### Step 1.1: GTM ì ‘ì†
1. [tagmanager.google.com](https://tagmanager.google.com) ì ‘ì†
2. Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

### Step 1.2: ê³„ì • ìƒì„±
1. **"ê³„ì • ë§Œë“¤ê¸°"** í´ë¦­
2. ì •ë³´ ì…ë ¥:
   - ê³„ì • ì´ë¦„: `QueryCraft`
   - êµ­ê°€: `ëŒ€í•œë¯¼êµ­`
3. **"ê³„ì†"** í´ë¦­

### Step 1.3: ì»¨í…Œì´ë„ˆ ìƒì„±
| ì„¤ì • | ê°’ |
|------|-----|
| ì»¨í…Œì´ë„ˆ ì´ë¦„ | `querycraft-web` |
| íƒ€ê²Ÿ í”Œë«í¼ | **ì›¹** |

4. **"ë§Œë“¤ê¸°"** í´ë¦­
5. ì´ìš©ì•½ê´€ ë™ì˜

### Step 1.4: GTM ID í™•ì¸
- ìƒì„± í›„ í‘œì‹œë˜ëŠ” ID: `GTM-XXXXXXX`
- ğŸ“ ì´ IDë¥¼ ë©”ëª¨í•´ë‘ì„¸ìš”

---

## 2. GA4 ì†ì„± ìƒì„±

### Step 2.1: GA4 ì ‘ì†
1. [analytics.google.com](https://analytics.google.com) ì ‘ì†
2. **"ê´€ë¦¬"** (âš™ï¸ ì•„ì´ì½˜) í´ë¦­

### Step 2.2: ì†ì„± ë§Œë“¤ê¸°
1. **"ì†ì„± ë§Œë“¤ê¸°"** í´ë¦­
2. ì •ë³´ ì…ë ¥:
   - ì†ì„± ì´ë¦„: `QueryCraft`
   - ì‹œê°„ëŒ€: `ëŒ€í•œë¯¼êµ­`
   - í†µí™”: `ì› (KRW)`
3. **"ë‹¤ìŒ"** í´ë¦­

### Step 2.3: ë¹„ì¦ˆë‹ˆìŠ¤ ì •ë³´
- ì—…ì¢…: `êµìœ¡` ë˜ëŠ” ì ì ˆí•œ ì¹´í…Œê³ ë¦¬
- ë¹„ì¦ˆë‹ˆìŠ¤ ê·œëª¨ ì„ íƒ
- **"ë§Œë“¤ê¸°"** í´ë¦­

### Step 2.4: ë°ì´í„° ìŠ¤íŠ¸ë¦¼ ìƒì„±
1. **"ì›¹"** ì„ íƒ
2. ì •ë³´ ì…ë ¥:
   - ì›¹ì‚¬ì´íŠ¸ URL: `https://your-domain.com`
   - ìŠ¤íŠ¸ë¦¼ ì´ë¦„: `QueryCraft Web`
3. **"ìŠ¤íŠ¸ë¦¼ ë§Œë“¤ê¸°"** í´ë¦­

### Step 2.5: ì¸¡ì • ID í™•ì¸
- ìƒì„± í›„ í‘œì‹œë˜ëŠ” ID: `G-XXXXXXXXXX`
- ğŸ“ ì´ IDë¥¼ ë©”ëª¨í•´ë‘ì„¸ìš”

---

## 3. GTMì—ì„œ GA4 íƒœê·¸ ì„¤ì •

### Step 3.1: GTMìœ¼ë¡œ ëŒì•„ê°€ê¸°
1. [tagmanager.google.com](https://tagmanager.google.com) ì ‘ì†
2. ìƒì„±í•œ ì»¨í…Œì´ë„ˆ ì„ íƒ

### Step 3.2: GA4 êµ¬ì„± íƒœê·¸ ìƒì„±
1. **"íƒœê·¸"** â†’ **"ìƒˆë¡œ ë§Œë“¤ê¸°"** í´ë¦­
2. íƒœê·¸ ì´ë¦„: `GA4 - Configuration`
3. íƒœê·¸ ìœ í˜•: **Google íƒœê·¸** ì„ íƒ
4. íƒœê·¸ ID: `G-XXXXXXXXXX` (GA4 ì¸¡ì • ID)
5. íŠ¸ë¦¬ê±°: **All Pages** ì„ íƒ
6. **"ì €ì¥"** í´ë¦­

---

## 4. ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ íŠ¸ë˜í‚¹ ì„¤ì •

QueryCraftëŠ” `dataLayer.push()`ë¥¼ í†µí•´ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.

### Step 4.1: ë³€ìˆ˜ ìƒì„±

**dataLayer ë³€ìˆ˜ ìƒì„±** (ê°ê° ë§Œë“¤ê¸°):

| ë³€ìˆ˜ ì´ë¦„ | ë°ì´í„° ì˜ì—­ ë³€ìˆ˜ ì´ë¦„ |
|----------|---------------------|
| `DL - problem_id` | `problem_id` |
| `DL - difficulty_level` | `difficulty_level` |
| `DL - attempt_count` | `attempt_count` |
| `DL - data_type` | `data_type` |
| `DL - user_id` | `user_id` |
| `DL - auth_provider` | `auth_provider` |

### Step 4.2: íŠ¸ë¦¬ê±° ìƒì„±

**ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°** (ê°ê° ë§Œë“¤ê¸°):

| íŠ¸ë¦¬ê±° ì´ë¦„ | ì´ë²¤íŠ¸ ì´ë¦„ |
|------------|------------|
| `CE - Problem Solved` | `problem_solved` |
| `CE - Problem Viewed` | `problem_viewed` |
| `CE - Login Success` | `login_success` |
| `CE - Sign Up Completed` | `sign_up_completed` |

### Step 4.3: GA4 ì´ë²¤íŠ¸ íƒœê·¸ ìƒì„±

**ì˜ˆì‹œ: Problem Solved íƒœê·¸**

1. **"íƒœê·¸"** â†’ **"ìƒˆë¡œ ë§Œë“¤ê¸°"**
2. íƒœê·¸ ì´ë¦„: `GA4 - Problem Solved`
3. íƒœê·¸ ìœ í˜•: **Google ì• ë„ë¦¬í‹±ìŠ¤: GA4 ì´ë²¤íŠ¸**
4. êµ¬ì„± íƒœê·¸: `GA4 - Configuration` ì„ íƒ
5. ì´ë²¤íŠ¸ ì´ë¦„: `problem_solved`
6. ì´ë²¤íŠ¸ ë§¤ê°œë³€ìˆ˜:

| ë§¤ê°œë³€ìˆ˜ ì´ë¦„ | ê°’ |
|--------------|-----|
| `problem_id` | `{{DL - problem_id}}` |
| `difficulty_level` | `{{DL - difficulty_level}}` |
| `attempt_count` | `{{DL - attempt_count}}` |
| `data_type` | `{{DL - data_type}}` |

7. íŠ¸ë¦¬ê±°: `CE - Problem Solved` ì„ íƒ
8. **"ì €ì¥"** í´ë¦­

> ğŸ’¡ ë‹¤ë¥¸ ì´ë²¤íŠ¸ë“¤ë„ ë™ì¼í•œ ë°©ì‹ìœ¼ë¡œ ìƒì„±í•˜ì„¸ìš”.

---

## 5. ì½”ë“œì—ì„œ GTM ID ì—…ë°ì´íŠ¸

### Step 5.1: index.html ìˆ˜ì •

`frontend/index.html` íŒŒì¼ì—ì„œ `GTM-XXXXXXX`ë¥¼ ì‹¤ì œ GTM IDë¡œ êµì²´:

```html
<!-- Google Tag Manager (HEAD) -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-XXXXXXX');</script>  <!-- â† ì—¬ê¸° ë³€ê²½ -->
```

```html
<!-- Google Tag Manager (BODY) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-XXXXXXX"  <!-- â† ì—¬ê¸°ë„ ë³€ê²½ -->
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
```

### Step 5.2: í™˜ê²½ë³€ìˆ˜ ì‚¬ìš© (ê¶Œì¥)

í”„ë¡œë•ì…˜ì—ì„œëŠ” í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”:

1. `.env` íŒŒì¼ì— ì¶”ê°€:
```
VITE_GTM_ID=GTM-XXXXXXX
```

2. `index.html`ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ê±°ë‚˜ ë¹Œë“œ ì‹œ êµì²´

---

## 6. í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### Step 6.1: GTM ë¯¸ë¦¬ë³´ê¸° ëª¨ë“œ
1. GTMì—ì„œ **"ë¯¸ë¦¬ë³´ê¸°"** í´ë¦­
2. ì‚¬ì´íŠ¸ URL ì…ë ¥
3. **"ì—°ê²°"** í´ë¦­

### Step 6.2: ì´ë²¤íŠ¸ í…ŒìŠ¤íŠ¸
1. ì‚¬ì´íŠ¸ì—ì„œ ë¬¸ì œ í’€ê¸°, ë¡œê·¸ì¸ ë“± ë™ì‘ ìˆ˜í–‰
2. GTM ë¯¸ë¦¬ë³´ê¸°ì—ì„œ ì´ë²¤íŠ¸ ë°œìƒ í™•ì¸

### Step 6.3: GA4 DebugView
1. GA4 â†’ **"ê´€ë¦¬"** â†’ **"DebugView"**
2. ì‹¤ì‹œê°„ìœ¼ë¡œ ì´ë²¤íŠ¸ í™•ì¸

### Step 6.4: GTM ê²Œì‹œ
1. í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ GTMì—ì„œ **"ì œì¶œ"** í´ë¦­
2. ë²„ì „ ì´ë¦„ ì…ë ¥ (ì˜ˆ: `v1.0 - Initial GA4 Setup`)
3. **"ê²Œì‹œ"** í´ë¦­

---

## ğŸ“Š ì£¼ìš” ì´ë²¤íŠ¸ ë§¤í•‘ (Mixpanel â†’ GA4)

| Mixpanel ì´ë²¤íŠ¸ | GA4 ì´ë²¤íŠ¸ (snake_case) |
|----------------|------------------------|
| `Problem Solved` | `problem_solved` |
| `Problem Viewed` | `problem_viewed` |
| `Problem Submitted` | `problem_submitted` |
| `Login Success` | `login_success` |
| `Sign Up Completed` | `sign_up_completed` |
| `SQL Executed` | `sql_executed` |

---

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **GTM ID í”Œë ˆì´ìŠ¤í™€ë”**: í˜„ì¬ ì½”ë“œì— `GTM-XXXXXXX` í”Œë ˆì´ìŠ¤í™€ë”ê°€ ìˆìœ¼ë¯€ë¡œ ë°˜ë“œì‹œ ì‹¤ì œ IDë¡œ êµì²´í•˜ì„¸ìš”.
2. **í…ŒìŠ¤íŠ¸ í•„ìˆ˜**: í”„ë¡œë•ì…˜ ë°°í¬ ì „ ë°˜ë“œì‹œ ë¯¸ë¦¬ë³´ê¸° ëª¨ë“œì—ì„œ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.
3. **Consent Mode**: GDPR/ê°œì¸ì •ë³´ ê·œì • ì¤€ìˆ˜ê°€ í•„ìš”í•œ ê²½ìš° Google Consent Modeë¥¼ ì¶”ê°€ë¡œ ì„¤ì •í•˜ì„¸ìš”.
