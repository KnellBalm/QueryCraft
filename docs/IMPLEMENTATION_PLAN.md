
# QueryCraft 기능 개선 및 최적화 계획 (2026-01-13)

## 개요
배포 안정성 확보, UI/UX 고도화, 그리고 채점 및 데이터 생성 로직의 최적화를 목표로 함.

## 주요 변경 사항

### 1. 배포 및 안정성 (Stability)
- **임포트 오류 수정**: `problems.py`에서 `TableSchema`, `get_table_schema` 누락 해결.
- **스키마 보완**: `backend/schemas/stats.py`를 신규 생성하여 `UserStats`, `LevelInfo` 모델 정의.
- **Docker 빌드 검증**: 로컬 환경에서 Docker 빌드 및 앱 로드 여부 자동 테스트 프로세스 적용.

### 2. UI/UX 개선
- **경험치 바(XP Bar) 고도화**: 헤더에 현재 경험치/다음 레벨 임계치(예: 45/100)를 텍스트로 표시하고, 게이지 바의 너비를 확장하여 가독성 개선.
- **툴팁 기반 안내**: "라이트 모드", "스트림 분석" 등 미구현 기능 클릭 시 팝업(alert) 대신 툴팁 안내로 변경하고 클릭 이벤트 비활성화.
- **브랜딩 리프레시**: 로고 및 GNB 메뉴 아이콘을 현대적인 이모지로 교체.
  - 로고: 🔧 -> 🚀
  - PA 연습 -> 📈 PA 분석
  - 스트림 연습 -> 📡 스트림 분석
  - 무한 연습 -> ♾️ 무한 연습

### 3. 채점 및 데이터 최적화 (Optimization)
- **날짜 비교 관대화**: 채점 시 `yyyy-mm-dd`와 `yyyy-mm-dd hh:mm:ss` 형식을 모두 `date` 레벨에서 비교하도록 수정하여 불필요한 오답 방지.
- **스키마 최적화**: `pa_users.signup_at` 및 `pa_orders.order_time` 컬럼 타입을 `TIMESTAMP`에서 `DATE`로 변경하여 데이터 일관성 확보.
- **문제 생성 프롬프트 수정**: Gemini에게 제공되는 데이터 요약 정보에서 변경된 DATE 타입을 명시하도록 업데이트.

### 4. 관리자 및 스케줄러 기능
- **PA 전용 스케줄러**: KST 01:00 실행 시 PA 데이터/문제만 생성하도록 조정 (준비 중인 스트림 제외).
- **데이터셋 버전 관리**: `dataset_versions` 테이블을 확장하여 생성 일자, 문제 수, 사용자 수, 실행 소요 시간, 상태 등을 상세 기록.
- **관리자 이력 뷰**: 관리자 페이지에서 최근 30개의 데이터셋/문제 생성 이력을 확인할 수 있는 테이블 추가.

## 검증 결과
- **백엔드**: Docker 빌드 및 `main.py` 로드 확인 완료.
- **프론트엔드**: XP 바 레이아웃 및 툴팁 동작 확인.
- **데이터**: 수동 트리거 스크립트를 통해 신규 DATE 형식 기반 데이터 및 문제 생성 성공.

## 향후 과제
- 채점 시 `expected_result` 완전 캐싱 또는 DB 수준 비교 도입 검토.
- 스트림 분석 모드 정식 구현.
