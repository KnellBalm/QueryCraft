# Phase 2: ì„œë¹„ìŠ¤ ì˜¤í”ˆ ì•ˆì •í™” ë° ê¸°ëŠ¥ ê³ ë„í™” ê³„íš

> ğŸ“… ì‹œì‘ì¼: 2026-01-17

## í˜„ì¬ ìƒí™© ë¶„ì„

### âœ… í•´ê²°ëœ ê¸´ê¸‰ ì´ìŠˆ (2026-01-17)

| ì´ìŠˆ | ì›ì¸ | ì¡°ì¹˜ ì‚¬í•­ |
|-----|-----|---------|
| ìŠ¤ì¼€ì¤„ëŸ¬ ë¯¸ë™ì‘ | ë°±ì—”ë“œ ë‚´ `gcloud` ë¶€ì¬ ë° DSN ê°œí–‰ ì˜¤ì—¼ | Cloud Schedulerê°€ Cloud Run Jobì„ ì§ì ‘ í˜¸ì¶œí•˜ë„ë¡ ê°œì„  |
| 15/16/17ì¼ ë°ì´í„° ëˆ„ë½ | ìŠ¤ì¼€ì¤„ëŸ¬ ë¯¸ë™ì‘ | ìˆ˜ë™ ë°±í•„(--date) ì‘ì—… ì™„ë£Œ ë° ë°ì´í„° ë³µêµ¬ |
| ë°±ì—”ë“œ êµ¬ë¬¸ ì—ëŸ¬ | `ai_service.py` SyntaxError | ì½”ë“œ ìˆ˜ì • ë° ìƒìš© ë°°í¬ ì™„ë£Œ |
| API 400/404/500 | ë¼ì´ë¸ŒëŸ¬ë¦¬ ëˆ„ë½ ë° ë¼ìš°íŒ… ì˜¤ë¥˜ | `bcrypt` ì¶”ê°€ ë° ì—”ë“œí¬ì¸íŠ¸ ìˆ˜ì • ì™„ë£Œ |

---

## Proposed Changes

### 1. ê¸´ê¸‰ ì´ìŠˆ í•´ê²°

#### [MODIFY] [LoginModal.tsx](file:///mnt/z/GitHub/QueryCraft/frontend/src/components/LoginModal.tsx)
- ì˜¤ë²„ë ˆì´ í´ë¦­ìœ¼ë¡œ ëª¨ë‹¬ ë‹«ê¸° ì œê±°
- X ë²„íŠ¼ ë˜ëŠ” ESC í‚¤ë¡œë§Œ ë‹«ë„ë¡ ìˆ˜ì •

#### [VERIFY] ë¡œê·¸ì¸ 401 ì—ëŸ¬
1. Supabase DBì—ì„œ í…ŒìŠ¤íŠ¸ ì‚¬ìš©ì í™•ì¸
2. ë°±ì—”ë“œ ë¡œê·¸ ë¶„ì„
3. í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„±

#### [VERIFY] Cloud Scheduler ìƒíƒœ
1. GCP Consoleì—ì„œ Cloud Scheduler ì‘ì—… í™•ì¸
2. `/admin/schedule/run` í˜¸ì¶œ ì´ë ¥ í™•ì¸
3. ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„/ì•Œë¦¼ ì„¤ì •

---

### 2. ë¬¸ì œ ìƒì„± ì•ˆì •í™” (P1)

#### [MODIFY] SQL ê²€ì¦ ë£¨í”„ ê°•í™”
- Gemini ìƒì„± SQLì„ DuckDB `EXPLAIN`ìœ¼ë¡œ ê²€ì¦
- ì‹¤íŒ¨ ì‹œ ìµœëŒ€ 3íšŒ ì¬ì‹œë„ (ì§€ìˆ˜ ë°±ì˜¤í”„)
- `dataset_versions` í…Œì´ë¸”ì— ì‹¤íŒ¨ ê¸°ë¡

#### [ADD] ë°ì´í„° ë¡¤ë°± ê¸°ëŠ¥
- `POST /admin/rollback/{date}` ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€
- íŠ¹ì • ë‚ ì§œ ë°ì´í„° ì¦‰ì‹œ ë¡¤ë°± ê°€ëŠ¥

---

### 3. ë°ì´í„° ìƒì„± ì—”ì§„ ê³ ë„í™” (P1)

#### [ADD] ì‹ ê·œ ë¶„ì„ ì‹œë‚˜ë¦¬ì˜¤
- í¼ë„ ë¶„ì„: íšŒì›ê°€ì… â†’ ì²« êµ¬ë§¤ â†’ ì¬êµ¬ë§¤
- ì”ì¡´ìœ¨: D1, D7, D30 Retention
- LTV ì˜ˆì¸¡: ì‚¬ìš©ìë³„ ëˆ„ì  ê²°ì œ ì‹œê³„ì—´

#### [ADD] RCAìš© ì´ìƒì¹˜ ë°ì´í„°
- ê´‘ê³  ì±„ë„ íš¨ìœ¨ ê¸‰ë½ (CTR 50% í•˜ë½)
- ê²°ì œ ëŒ€ê¸° ì‹œê°„ ì¦ê°€ (íŠ¹ì • ì§€ì—­ 3ë°°)
- ë¦¬í…ì…˜ ê¸‰ë½ (íŠ¹ì • ì½”í˜¸íŠ¸)

---

### 4. ì¶”ê°€ ê¸°ëŠ¥ ì„¤ê³„ (P2)

#### [DESIGN] ë§ì¶¤í˜• ë¡œë“œë§µ
- ì‚¬ìš©ì í’€ì´ ì´ë ¥ ë¶„ì„ (ì •ë‹µë¥ , ì·¨ì•½ í† í”½)
- ì¶”ì²œ ì•Œê³ ë¦¬ì¦˜ ì„¤ê³„
- API: `GET /api/recommend/roadmap`

#### [DESIGN] ì†Œì…œ í”¼ë“œë°± ì‹œìŠ¤í…œ
- ì¿¼ë¦¬ ê²°ê³¼ ê³µìœ : `POST /api/share`
- í”¼ë“œë°± ìˆ˜ì§‘: `POST /api/feedback`

---

## Jules ìœ„ì„ ì—…ë¬´

### Jules-1: Worker Job ë¡œì»¬ í…ŒìŠ¤íŠ¸ ë° ìˆ˜ì • (ìµœìš°ì„ )
```bash
jules new "Cloud Run Worker Jobì´ Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œë¥¼ ë¡œì»¬ì—ì„œ ì¬í˜„í•˜ê³  í•´ê²°í•˜ì„¸ìš”. 
ìƒì„¸ ì§€ì¹¨ì€ /home/zokr/.gemini/antigravity/brain/d13247d3-bf9d-4b3b-b504-29daacb4e994/jules_delegation.mdë¥¼ ì°¸ì¡°í•˜ì„¸ìš”."
```

### Jules-2: ë°±ì—”ë“œ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ 80%
```bash
jules new "backend/ ë””ë ‰í† ë¦¬ì˜ í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ë¥¼ 80%ê¹Œì§€ ë†’ì´ì„¸ìš”..."
```

### Jules-3: í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ í’ˆì§ˆ ê°œì„ 
```bash
jules new "frontend/src/ì˜ TypeScript íƒ€ì… ì•ˆì •ì„±ì„ ê°•í™”í•˜ì„¸ìš”..."
```

---

## MSA ì•„í‚¤í…ì²˜ ì „í™˜ ê³„íš (Phase 3)

### ë°°ê²½ ë° ëª©í‘œ
í˜„ì¬ Worker Jobì´ ì „ì²´ backend ì½”ë“œë² ì´ìŠ¤ì— ì˜ì¡´í•˜ì—¬ ë³µì¡ë„ê°€ ë†’ê³ , ë…ë¦½ì ì¸ ìŠ¤ì¼€ì¼ë§ì´ ì–´ë µìŠµë‹ˆë‹¤. 
ë¬¸ì œ ìƒì„± ì—”ì§„ì„ ë³„ë„ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬í•˜ì—¬ ê° ì„œë¹„ìŠ¤ì˜ ë…ë¦½ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒì‹œí‚µë‹ˆë‹¤.

### ì œì•ˆ êµ¬ì¡°
```
querycraft-backend (FastAPI)
  â””â”€ API ì—”ë“œí¬ì¸íŠ¸, ì„¸ì…˜ ê´€ë¦¬

querycraft-problem-engine (ë…ë¦½ ì„œë¹„ìŠ¤)
  â””â”€ ë°ì´í„° ìƒì„±, ë¬¸ì œ ìƒì„±, Cloud Run Job

querycraft-grading-service (ë¯¸ë˜ í™•ì¥)
  â””â”€ SQL ì‹¤í–‰, ì±„ì , ë…ë¦½ ìŠ¤ì¼€ì¼ë§
```

### ë§ˆì´ê·¸ë ˆì´ì…˜ ë¡œë“œë§µ
1. **Week 1**: Problem Engine ì €ì¥ì†Œ ìƒì„± ë° ì½”ë“œ ë¶„ë¦¬
2. **Week 2**: ë…ë¦½ ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶• ë° í…ŒìŠ¤íŠ¸
3. **Week 3**: Backend ê²½ëŸ‰í™” ë° í†µí•© í…ŒìŠ¤íŠ¸
4. **Week 4**: í”„ë¡œë•ì…˜ ë§ˆì´ê·¸ë ˆì´ì…˜

> ğŸ“ ìƒì„¸ ê³„íš: `/home/zokr/.gemini/antigravity/brain/d13247d3-bf9d-4b3b-b504-29daacb4e994/msa_architecture_plan.md`

---

## Verification Plan

### Automated Tests
```bash
pytest tests/ -v --cov=backend
cd frontend && npm run build
```

### Manual Verification
1. ë¡œê·¸ì¸ ëª¨ë‹¬ UX í™•ì¸ (ì˜¤ë²„ë ˆì´ í´ë¦­ ë¬´ì‹œ)
2. í…ŒìŠ¤íŠ¸ ê³„ì • ë¡œê·¸ì¸ ì„±ê³µ í™•ì¸
3. `/admin/schedule/run` ìˆ˜ë™ í˜¸ì¶œ â†’ ì˜¤ëŠ˜ ë‚ ì§œ ë¬¸ì œ ìƒì„± í™•ì¸
4. SQL ê²€ì¦ ì¬ì‹œë„ ë¡œì§ ë¡œê·¸ í™•ì¸
